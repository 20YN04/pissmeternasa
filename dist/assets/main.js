var qi=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Bi(a){if(a.__esModule)return a;var h=a.default;if(typeof h=="function"){var p=function u(){return this instanceof u?Reflect.construct(h,arguments,this.constructor):h.apply(this,arguments)};p.prototype=h.prototype}else p={};return Object.defineProperty(p,"__esModule",{value:!0}),Object.keys(a).forEach(function(u){var T=Object.getOwnPropertyDescriptor(a,u);Object.defineProperty(p,u,T.get?T:{enumerable:!0,get:function(){return a[u]}})}),p}const Wi=a=>(h,p)=>(a.set(h,p),p),ni=Number.MAX_SAFE_INTEGER===void 0?9007199254740991:Number.MAX_SAFE_INTEGER,hi=536870912,ri=hi*2,Ui=(a,h)=>p=>{const u=h.get(p);let T=u===void 0?p.size:u<ri?u+1:0;if(!p.has(T))return a(p,T);if(p.size<hi){for(;p.has(T);)T=Math.floor(Math.random()*ri);return a(p,T)}if(p.size>ni)throw new Error("Congratulations, you created a collection of unique numbers which uses all available integers!");for(;p.has(T);)T=Math.floor(Math.random()*ni);return a(p,T)},li=new WeakMap,Hi=Wi(li),Ns=Ui(Hi,li),Ki=a=>a.method!==void 0&&a.method==="call",Vi=a=>a.error===null&&typeof a.id=="number",Gi=a=>{const h=new Map([[0,()=>{}]]),p=new Map([[0,()=>{}]]),u=new Map,T=new Worker(a);return T.addEventListener("message",({data:W})=>{if(Ki(W)){const{params:{timerId:c,timerType:K}}=W;if(K==="interval"){const b=h.get(c);if(typeof b=="number"){const _=u.get(b);if(_===void 0||_.timerId!==c||_.timerType!==K)throw new Error("The timer is in an undefined state.")}else if(typeof b<"u")b();else throw new Error("The timer is in an undefined state.")}else if(K==="timeout"){const b=p.get(c);if(typeof b=="number"){const _=u.get(b);if(_===void 0||_.timerId!==c||_.timerType!==K)throw new Error("The timer is in an undefined state.")}else if(typeof b<"u")b(),p.delete(c);else throw new Error("The timer is in an undefined state.")}}else if(Vi(W)){const{id:c}=W,K=u.get(c);if(K===void 0)throw new Error("The timer is in an undefined state.");const{timerId:b,timerType:_}=K;u.delete(c),_==="interval"?h.delete(b):p.delete(b)}else{const{error:{message:c}}=W;throw new Error(c)}}),{clearInterval:W=>{const c=Ns(u);u.set(c,{timerId:W,timerType:"interval"}),h.set(W,c),T.postMessage({id:c,method:"clear",params:{timerId:W,timerType:"interval"}})},clearTimeout:W=>{const c=Ns(u);u.set(c,{timerId:W,timerType:"timeout"}),p.set(W,c),T.postMessage({id:c,method:"clear",params:{timerId:W,timerType:"timeout"}})},setInterval:(W,c=0)=>{const K=Ns(h);return h.set(K,()=>{W(),typeof h.get(K)=="function"&&T.postMessage({id:null,method:"set",params:{delay:c,now:performance.now(),timerId:K,timerType:"interval"}})}),T.postMessage({id:null,method:"set",params:{delay:c,now:performance.now(),timerId:K,timerType:"interval"}}),K},setTimeout:(W,c=0)=>{const K=Ns(p);return p.set(K,W),T.postMessage({id:null,method:"set",params:{delay:c,now:performance.now(),timerId:K,timerType:"timeout"}}),K}}},zi=(a,h)=>{let p=null;return()=>{if(p!==null)return p;const u=new Blob([h],{type:"application/javascript; charset=utf-8"}),T=URL.createObjectURL(u);return p=a(T),setTimeout(()=>URL.revokeObjectURL(T)),p}},Yi=`(()=>{"use strict";const e=new Map,t=new Map,r=(e,t)=>{let r,o;const i=performance.now();r=i,o=e-Math.max(0,i-t);return{expected:r+o,remainingDelay:o}},o=(e,t,r,i)=>{const s=performance.now();s>r?postMessage({id:null,method:"call",params:{timerId:t,timerType:i}}):e.set(t,setTimeout(o,r-s,e,t,r,i))};addEventListener("message",(i=>{let{data:s}=i;try{if("clear"===s.method){const{id:r,params:{timerId:o,timerType:i}}=s;if("interval"===i)(t=>{const r=e.get(t);if(void 0===r)throw new Error('There is no interval scheduled with the given id "'.concat(t,'".'));clearTimeout(r),e.delete(t)})(o),postMessage({error:null,id:r});else{if("timeout"!==i)throw new Error('The given type "'.concat(i,'" is not supported'));(e=>{const r=t.get(e);if(void 0===r)throw new Error('There is no timeout scheduled with the given id "'.concat(e,'".'));clearTimeout(r),t.delete(e)})(o),postMessage({error:null,id:r})}}else{if("set"!==s.method)throw new Error('The given method "'.concat(s.method,'" is not supported'));{const{params:{delay:i,now:n,timerId:a,timerType:d}}=s;if("interval"===d)((t,i,s)=>{const{expected:n,remainingDelay:a}=r(t,s);e.set(i,setTimeout(o,a,e,i,n,"interval"))})(i,a,n);else{if("timeout"!==d)throw new Error('The given type "'.concat(d,'" is not supported'));((e,i,s)=>{const{expected:n,remainingDelay:a}=r(e,s);t.set(i,setTimeout(o,a,t,i,n,"timeout"))})(i,a,n)}}}}catch(e){postMessage({error:{message:e.message},id:s.id,result:null})}}))})();`,Os=zi(Gi,Yi),ji=a=>Os().clearInterval(a),Qi=a=>Os().clearTimeout(a),Ji=(...a)=>Os().setInterval(...a),$i=(...a)=>Os().setTimeout(...a);var Zi=Object.freeze({__proto__:null,clearInterval:ji,clearTimeout:Qi,setInterval:Ji,setTimeout:$i}),Xi=Bi(Zi),Gs={exports:{}};var ai;function tn(){return ai||(ai=1,(function(a,h){(function(p,u){u(a.exports)})(qi,function(p){var u,T,at,L;L=Array.isArray||function(_){return Object.prototype.toString.call(_)=="[object Array]"},p.apply_patch=function(_,S){return new u(S).apply(_)};function et(_){Error.call(this,_),this.message=_}p.InvalidPatch=et,et.prototype=new Error;function P(_){Error.call(this,_),this.message=_}p.PatchApplyError=P,P.prototype=new Error,p.JSONPointer=T=function(S){var E,O,g=[];if(O=S.split("/"),O[0]!=="")throw new et("JSONPointer must start with a slash (or be an empty string)!");for(E=1;E<O.length;E++)g[E-1]=O[E].replace(/~1/g,"/").replace(/~0/g,"~");this.path=g,this.length=g.length},T.prototype._get_segment=function(_,S){var E=this.path[_];if(L(S))if(E==="-")E=S.length;else{if(!E.match(/^0$|^[1-9][0-9]*$/))throw new P("Expected a number to segment an array");E=parseInt(E,10)}return E};function W(_){var S,E;if(L(_))return _.slice();if(_===null)return _;if(typeof _=="object"){S={};for(E in _)Object.hasOwnProperty.call(_,E)&&(S[E]=_[E]);return S}else return _}T.prototype._action=function(_,S,E){var O=this;function g(y,z){var Y,Et;if(E||(y=W(y)),Y=O._get_segment(z,y),z==O.path.length-1)y=S(y,Y);else{if(L(y)){if(y.length<=Y)throw new P("Path not found in document")}else if(typeof y=="object"){if(!Object.hasOwnProperty.call(y,Y))throw new P("Path not found in document")}else throw new P("Path not found in document");Et=g(y[Y],z+1),E||(y[Y]=Et)}return y}return g(_,0)},T.prototype.add=function(_,S,E){return this.length===0?S:this._action(_,function(O,g){if(L(O)){if(g>O.length)throw new P("Add operation must not attempt to create a sparse array!");O.splice(g,0,S)}else O[g]=S;return O},E)},T.prototype.remove=function(_,S){if(this.length!==0)return this._action(_,function(E,O){if(!Object.hasOwnProperty.call(E,O))throw new P("Remove operation must point to an existing value!");return L(E)?E.splice(O,1):delete E[O],E},S)},T.prototype.replace=function(_,S,E){return this.length===0?S:this._action(_,function(O,g){if(!Object.hasOwnProperty.call(O,g))throw new P("Replace operation must point to an existing value!");return L(O)?O.splice(g,1,S):O[g]=S,O},E)},T.prototype.get=function(_){var S;return this.length===0?_:(this._action(_,function(E,O){if(!Object.hasOwnProperty.call(E,O))throw new P("Path not found in document");return S=E[O],E},!0),S)},T.prototype.subsetOf=function(_){if(this.length<=_.length)return!1;for(var S=0;S<_.length;S++)if(_.path[S]!==this.path[S])return!1;return!0},at={add:["value"],replace:["value"],test:["value"],remove:[],move:["from"],copy:["from"]};function c(_,S){var E;if(_===S)return!0;if(typeof _!=typeof S)return!1;if(typeof _=="object"){var O=L(_),g=L(S);if(O!==g)return!1;if(O){if(_.length!=S.length)return!1;for(var y=0;y<_.length;y++)if(!c(_[y],S[y]))return!1;return!0}else{for(E in _)if(Object.hasOwnProperty(_,E)&&!(Object.hasOwnProperty(S,E)&&c(_[E],S[E])))return!1;for(E in S)if(Object.hasOwnProperty(S,E)&&!Object.hasOwnProperty(_,E))return!1;return!0}}else return!1}function K(_){var S,E;if(!_.op)throw new et("Operation missing!");if(!at.hasOwnProperty(_.op))throw new et("Invalid operation!");if(!("path"in _))throw new et("Path missing!");for(E=at[_.op],S=0;S<E.length;S++)if(!(E[S]in _))throw new et(_.op+" must have key "+E[S])}function b(_,S){K(_);var E=_.op,O=new T(_.path),g=_.value,y=_.from?new T(_.from):null;switch(E){case"add":return function(z){return O.add(z,g,S)};case"remove":return function(z){return O.remove(z,S)};case"replace":return function(z){return O.replace(z,g,S)};case"move":if(O.subsetOf(y))throw new et("destination must not be a child of source");return function(z){var Y=y.get(z),Et=y.remove(z,S);return O.add(Et,Y,S)};case"copy":return function(z){var Y=y.get(z);return O.add(z,Y,S)};case"test":return function(z){if(!c(O.get(z),g))throw new P("Test operation failed. Value did not match.");return z}}}p.JSONPatch=u=function(S,E){this._compile(S,E)},u.prototype._compile=function(_,S){var E,O=this;if(this.compiledOps=[],typeof _=="string"&&(_=JSON.parse(_)),!L(_))throw new et("Patch must be an array of operations");for(E=0;E<_.length;E++){var g=b(_[E],S);O.compiledOps.push(g)}},p.JSONPatch.prototype.apply=function(_){var S;for(S=0;S<this.compiledOps.length;S++)_=this.compiledOps[S](_);return _}})})(Gs)),Gs.exports}var ui=function(){};ui.prototype={fatal:function(a,h){},isFatalEnabled:function(){},error:function(a,h){},isErrorEnabled:function(){},warn:function(a,h){},isWarnEnabled:function(){},info:function(a,h){},isInfoEnabled:function(){},debug:function(a,h){},isDebugEnabled:function(){},trace:function(a,h){},isTraceEnabled:function(){}};var ci=function(){};ci.prototype={getLogger:function(a){}};var _i=function(){};_i.prototype={getItemName:function(){},getItemPos:function(){},getValue:function(a){},getValueAsJSONPatchIfAvailable:function(a){return null},isValueChanged:function(a){},isSnapshot:function(){},forEachChangedField:function(a){},forEachField:function(a){}};var fi=function(){};fi.prototype={onItemUpdate:function(a){},onItemLostUpdates:function(a,h,p){},onCommandSecondLevelItemLostUpdates:function(a,h){},onEndOfSnapshot:function(a,h){},onClearSnapshot:function(a,h){},onSubscription:function(){},onUnsubscription:function(){},onSubscriptionError:function(a,h){},onCommandSecondLevelSubscriptionError:function(a,h,p){},onListenStart:function(){},onListenEnd:function(){},onRealMaxFrequency:function(a){}};var Gt={};(function(a){var h=function(){return B.__string_rec(this,"")},p=p||{},u;function T(t,e){var s=Object.create(t);for(var i in e)s[i]=e[i];return e.toString!==Object.prototype.toString&&(s.toString=e.toString),s}var at=function(t,e){this.r=new RegExp(t,e.split("u").join(""))};at.__name__=!0,at.prototype={match:function(t){return this.r.global&&(this.r.lastIndex=0),this.r.m=this.r.exec(t),this.r.s=t,this.r.m!=null},__class__:at};var L=function(){};L.__name__=!0,L.dateStr=function(t){var e=t.getMonth()+1,s=t.getDate(),i=t.getHours(),n=t.getMinutes(),r=t.getSeconds();return t.getFullYear()+"-"+(e<10?"0"+e:""+e)+"-"+(s<10?"0"+s:""+s)+" "+(i<10?"0"+i:""+i)+":"+(n<10?"0"+n:""+n)+":"+(r<10?"0"+r:""+r)},L.cca=function(t,e){var s=t.charCodeAt(e);if(s==s)return s},L.substr=function(t,e,s){if(s==null)s=t.length;else if(s<0)if(e==0)s=t.length+s;else return"";return t.substr(e,s)},L.remove=function(t,e){var s=t.indexOf(e);return s==-1?!1:(t.splice(s,1),!0)},L.now=function(){return Date.now()};var et=function(t,e){this.min=t,this.max=e};et.__name__=!0,et.prototype={hasNext:function(){return this.min<this.max},next:function(){return this.min++},__class__:et};var P=function(){};P.__name__=!0,P.has=function(t,e){for(var s=xe(t);s.hasNext();)if(s.next()==e)return!0;return!1},P.exists=function(t,e){for(var s=xe(t);s.hasNext();)if(e(s.next()))return!0;return!1},P.count=function(t,e){var s=0;if(e==null)for(var i=xe(t);i.hasNext();)i.next(),++s;else for(var n=xe(t);n.hasNext();)e(n.next())&&++s;return s},P.empty=function(t){return!xe(t).hasNext()},P.find=function(t,e){for(var s=xe(t);s.hasNext();){var i=s.next();if(e(i))return i}return null},Math.__name__=!0;var W=function(){};W.__name__=!0,W.field=function(t,e){try{return t[e]}catch{return null}},W.fields=function(t){var e=[];if(t!=null){var s=Object.prototype.hasOwnProperty;for(var i in t)i!="__id__"&&i!="hx__closures__"&&s.call(t,i)&&e.push(i)}return e},W.copy=function(t){if(t==null)return null;for(var e={},s=0,i=W.fields(t);s<i.length;){var n=i[s];++s,e[n]=W.field(t,n)}return e};var c=function(){};c.__name__=!0,c.string=function(t){return B.__string_rec(t,"")},c.parseInt=function(t){var e=parseInt(t);return isNaN(e)?null:e},c.random=function(t){return t<=0?0:Math.floor(Math.random()*t)};var K=function(){this.b=""};K.__name__=!0,K.prototype={__class__:K};var b=function(){};b.__name__=!0,b.startsWith=function(t,e){return t.length>=e.length?t.lastIndexOf(e,0)==0:!1},b.endsWith=function(t,e){var s=e.length,i=t.length;return i>=s?t.indexOf(e,i-s)==i-s:!1},b.isSpace=function(t,e){var s=L.cca(t,e);return s>8&&s<14?!0:s==32},b.ltrim=function(t){for(var e=t.length,s=0;s<e&&b.isSpace(t,s);)++s;return s>0?L.substr(t,s,e-s):t},b.rtrim=function(t){for(var e=t.length,s=0;s<e&&b.isSpace(t,e-s-1);)++s;return s>0?L.substr(t,0,e-s):t},b.trim=function(t){return b.ltrim(b.rtrim(t))},b.replace=function(t,e,s){return t.split(e).join(s)};var _=function(){};_.__name__=!0,_.enumEq=function(t,e){if(t==e)return!0;try{var s=t.__enum__;if(s==null||s!=e.__enum__||t._hx_index!=e._hx_index)return!1;for(var i=p[s],n=i.__constructs__[t._hx_index].__params__,r=0;r<n.length;){var o=n[r];if(++r,!_.enumEq(t[o],e[o]))return!1}}catch{return!1}return!0};var S=Gt.LSConnectionDetails=function(t){this.serverAddress=Ni,this.client=t,this.lock=t.lock};S.__name__=!0,S.prototype={getServerAddress:function(){return this.serverAddress},setServerAddress:function(t){var e=O.fromString(t);if(e!=this.serverAddress){w.isInfoEnabled()&&w.info("serverAddress changed: "+e);var s=this.serverAddress;this.serverAddress=e,this.client.eventDispatcher.onPropertyChange("serverAddress"),s!=e&&this.client.machine.evtServerAddressChanged()}},getAdapterSet:function(){return this.adapterSet},setAdapterSet:function(t){t!=this.adapterSet&&(w.isInfoEnabled()&&w.info("adapterSet changed: "+t),this.adapterSet=t,this.client.eventDispatcher.onPropertyChange("adapterSet"))},getUser:function(){return this.user},setUser:function(t){t!=this.user&&(w.isInfoEnabled()&&w.info("user changed: "+t),this.user=t,this.client.eventDispatcher.onPropertyChange("user"))},setPassword:function(t){t!=this.password&&(w.isInfoEnabled()&&w.info("password changed"),this.password=t,this.client.eventDispatcher.onPropertyChange("password"))},getSessionId:function(){return this.sessionId},setSessionId:function(t){t!=this.sessionId&&(this.sessionId=t,this.client.eventDispatcher.onPropertyChange("sessionId"))},getServerInstanceAddress:function(){return this.serverInstanceAddress},setServerInstanceAddress:function(t){t!=this.serverInstanceAddress&&(this.serverInstanceAddress=t,this.client.eventDispatcher.onPropertyChange("serverInstanceAddress"))},getServerSocketName:function(){return this.serverSocketName},setServerSocketName:function(t){t!=this.serverSocketName&&(this.serverSocketName=t,this.client.eventDispatcher.onPropertyChange("serverSocketName"))},getClientIp:function(){return this.clientIp},setClientIp:function(t){t!=this.clientIp&&(this.clientIp=t,this.client.eventDispatcher.onPropertyChange("clientIp"))},toString:function(){var t=I._new();return I.set(t,"serverAddress",this.serverAddress),I.set(t,"adapterSet",this.adapterSet),I.set(t,"user",this.user),I.set(t,"sessionId",this.sessionId),I.set(t,"serverInstanceAddress",this.serverInstanceAddress),I.set(t,"serverSocketName",this.serverSocketName),I.set(t,"clientIp",this.clientIp),I.set(t,"libVersion",zt.LIB_NAME+" "+zt.LIB_VERSION),J.stringify(t.h)},__class__:S};var E=function(){};E.__name__=!0,E.get_supported=function(){return typeof window<"u"&&typeof window.location<"u"?typeof window.location.protocol=="string":!1};var O={};O._new=function(t){return t},O.fromString=function(t){if(t==null)return null;if(b.startsWith(t,"http://")||b.startsWith(t,"https://"))return t;throw new y("address is malformed")};var g=function(t,e,s){Error.call(this,t),this.message=t,this.__previousException=e,this.__nativeException=s??this,this.__skipStack=0;var i=Error.prepareStackTrace;if(Error.prepareStackTrace=function(r){return r.stack},s instanceof Error)this.stack=s.stack;else{var n=null;if(Error.captureStackTrace)Error.captureStackTrace(this,g),n=this;else if(n=new Error,typeof n.stack>"u"){try{throw n}catch{}this.__skipStack++}this.stack=n.stack}Error.prepareStackTrace=i};g.__name__=!0,g.caught=function(t){return t instanceof g?t:t instanceof Error?new g(t.message,null,t):new Ee(t,null,t)},g.thrown=function(t){if(t instanceof g)return t.get_native();if(t instanceof Error)return t;var e=new Ee(t);return e.__skipStack++,e},g.__super__=Error,g.prototype=T(Error.prototype,{toString:function(){return this.get_message()},details:function(){if(this.get_previous()==null){var t="Exception: "+this.toString(),e=this.get_stack();return t+(e==null?"null":pt.toString(e))}else{for(var s="",i=this,n=null;i!=null;){if(n==null){var r="Exception: "+i.get_message(),t=i.get_stack();s=r+(t==null?"null":pt.toString(t))+s}else{var o=pt.subtract(i.get_stack(),n.get_stack());s="Exception: "+i.get_message()+(o==null?"null":pt.toString(o))+`

Next `+s}n=i,i=i.get_previous()}return s}},__shiftStack:function(){this.__skipStack++},get_message:function(){return this.message},get_previous:function(){return this.__previousException},get_native:function(){return this.__nativeException},get_stack:function(){var t=this.__exceptionStack;if(t==null){var e=ne.toHaxe(ne.normalize(this.stack),this.__skipStack);return this.setProperty("__exceptionStack",e),e}else return t},setProperty:function(t,e){try{Object.defineProperty(this,t,{value:e})}catch{this[t]=e}},__class__:g});var y=function(t,e,s){g.call(this,t,e,s),this.__skipStack++};y.__name__=!0,y.__super__=g,y.prototype=T(g.prototype,{__class__:y});var z=Gt.LSConnectionOptions=function(t){this.cookieHandlingRequired=!1,this.slowingEnabled=!1,this.serverInstanceAddressIgnored=!1,this.httpExtraHeadersOnSessionCreationOnly=!1,this.stalledTimeout=2e3,this.sessionRecoveryTimeout=15e3,this.reverseHeartbeatInterval=0,this.retryDelay=4e3,this.reconnectTimeout=3e3,this.pollingInterval=0,this.realMaxBandwidth=null,this.requestedMaxBandwidth=ge.BWUnlimited,this.keepaliveInterval=0,this.idleTimeout=19e3,this.httpExtraHeaders=null,this.forcedTransport=null,this.firstRetryMaxDelay=100,this.contentLength=5e7,this.client=t,this.lock=t.lock};z.__name__=!0,z.prototype={getContentLength:function(){return this.contentLength},setContentLength:function(t){var e=Bs.fromIntGt0(t);e!=this.contentLength&&(w.isInfoEnabled()&&w.info("contentLength changed: "+e),this.contentLength=e,this.client.eventDispatcher.onPropertyChange("contentLength"))},getFirstRetryMaxDelay:function(){return this.firstRetryMaxDelay},setFirstRetryMaxDelay:function(t){var e=U.fromIntGt0(t);e!=this.firstRetryMaxDelay&&(w.isInfoEnabled()&&w.info("firstRetryMaxDelay changed: "+e),this.firstRetryMaxDelay=e,this.client.eventDispatcher.onPropertyChange("firstRetryMaxDelay"))},getForcedTransport:function(){return this.forcedTransport},setForcedTransport:function(t){var e=$t.fromString(t);e!=this.forcedTransport&&(w.isInfoEnabled()&&w.info("forcedTransport changed: "+e),this.forcedTransport=e,this.client.eventDispatcher.onPropertyChange("forcedTransport"),this.client.machine.evtExtSetForcedTransport())},getHttpExtraHeaders:function(){return this.httpExtraHeaders==null?null:Bt.fromMapToDynamicAccess(this.httpExtraHeaders)},setHttpExtraHeaders:function(t){var e=t!=null?Bt.toHaxe(t):null;this.mapEq(e,this.httpExtraHeaders)||(w.isInfoEnabled()&&w.info("httpExtraHeaders changed: "+(e==null?"null":J.stringify(e.h))),this.httpExtraHeaders=e,this.client.eventDispatcher.onPropertyChange("httpExtraHeaders"))},mapEq:function(t,e){if(t==e)return!0;if(t==null||e==null||P.count(t)!=P.count(e))return!1;for(var s=t.h,i=Object.keys(s),n=i.length,r=0;r<n;){var o=i[r++];if(s[o]!=e.h[o])return!1}return!0},getIdleTimeout:function(){return this.idleTimeout},setIdleTimeout:function(t){var e=U.fromIntGtEq0(t);e!=this.idleTimeout&&(w.isInfoEnabled()&&w.info("idleTimeout changed: "+e),this.idleTimeout=e,this.client.eventDispatcher.onPropertyChange("idleTimeout"))},getKeepaliveInterval:function(){return this.keepaliveInterval},setKeepaliveInterval:function(t){var e=U.fromIntGtEq0(t);e!=this.keepaliveInterval&&(w.isInfoEnabled()&&w.info("keepaliveInterval changed: "+e),this.keepaliveInterval=e,this.client.eventDispatcher.onPropertyChange("keepaliveInterval"))},getRequestedMaxBandwidth:function(){return Se.toString(this.requestedMaxBandwidth)},setRequestedMaxBandwidth:function(t){t!=null&&(t=t==null?"null":""+t);var e=Se.fromString(t);_.enumEq(e,this.requestedMaxBandwidth)||(w.isInfoEnabled()&&w.info("requestedMaxBandwidth changed: "+Se.toString(e)),this.requestedMaxBandwidth=e,this.client.eventDispatcher.onPropertyChange("requestedMaxBandwidth"),this.client.machine.evtExtSetRequestedMaxBandwidth())},getRealMaxBandwidth:function(){return hs.toString(this.realMaxBandwidth)},setRealMaxBandwidth:function(t){hs.eq(t,this.realMaxBandwidth)||(this.realMaxBandwidth=t,this.client.eventDispatcher.onPropertyChange("realMaxBandwidth"))},getPollingInterval:function(){return this.pollingInterval},setPollingInterval:function(t){var e=U.fromIntGtEq0(t);e!=this.pollingInterval&&(w.isInfoEnabled()&&w.info("pollingInterval changed: "+e),this.pollingInterval=e,this.client.eventDispatcher.onPropertyChange("pollingInterval"))},getReconnectTimeout:function(){return this.reconnectTimeout},setReconnectTimeout:function(t){var e=U.fromIntGt0(t);e!=this.reconnectTimeout&&(w.isInfoEnabled()&&w.info("reconnectTimeout changed: "+e),this.reconnectTimeout=e,this.client.eventDispatcher.onPropertyChange("reconnectTimeout"))},getRetryDelay:function(){return this.retryDelay},setRetryDelay:function(t){var e=U.fromIntGt0(t);e!=this.retryDelay&&(w.isInfoEnabled()&&w.info("retryDelay changed: "+e),this.retryDelay=e,this.client.eventDispatcher.onPropertyChange("retryDelay"))},getReverseHeartbeatInterval:function(){return this.reverseHeartbeatInterval},setReverseHeartbeatInterval:function(t){var e=U.fromIntGtEq0(t);e!=this.reverseHeartbeatInterval&&(w.isInfoEnabled()&&w.info("reverseHeartbeatInterval changed: "+e),this.reverseHeartbeatInterval=e,this.client.eventDispatcher.onPropertyChange("reverseHeartbeatInterval"),this.client.machine.evtExtSetReverseHeartbeatInterval())},getSessionRecoveryTimeout:function(){return this.sessionRecoveryTimeout},setSessionRecoveryTimeout:function(t){var e=U.fromIntGtEq0(t);e!=this.sessionRecoveryTimeout&&(w.isInfoEnabled()&&w.info("sessionRecoveryTimeout changed: "+e),this.sessionRecoveryTimeout=e,this.client.eventDispatcher.onPropertyChange("sessionRecoveryTimeout"))},getStalledTimeout:function(){return this.stalledTimeout},setStalledTimeout:function(t){var e=U.fromIntGt0(t);e!=this.stalledTimeout&&(w.isInfoEnabled()&&w.info("stalledTimeout changed: "+e),this.stalledTimeout=e,this.client.eventDispatcher.onPropertyChange("stalledTimeout"))},isHttpExtraHeadersOnSessionCreationOnly:function(){return this.httpExtraHeadersOnSessionCreationOnly},setHttpExtraHeadersOnSessionCreationOnly:function(t){t!=this.httpExtraHeadersOnSessionCreationOnly&&(w.isInfoEnabled()&&w.info("httpExtraHeadersOnSessionCreationOnly changed: "+(t==null?"null":""+t)),this.httpExtraHeadersOnSessionCreationOnly=t,this.client.eventDispatcher.onPropertyChange("httpExtraHeadersOnSessionCreationOnly"))},isServerInstanceAddressIgnored:function(){return this.serverInstanceAddressIgnored},setServerInstanceAddressIgnored:function(t){t!=this.serverInstanceAddressIgnored&&(w.isInfoEnabled()&&w.info("serverInstanceAddressIgnored changed: "+(t==null?"null":""+t)),this.serverInstanceAddressIgnored=t,this.client.eventDispatcher.onPropertyChange("serverInstanceAddressIgnored"))},setCookieHandlingRequired:function(t){t!=this.cookieHandlingRequired&&(w.isInfoEnabled()&&w.info("cookieHandlingRequired changed: "+(t==null?"null":""+t)),this.cookieHandlingRequired=t,this.client.eventDispatcher.onPropertyChange("cookieHandlingRequired"))},isCookieHandlingRequired:function(){return this.cookieHandlingRequired},isSlowingEnabled:function(){return this.slowingEnabled},setSlowingEnabled:function(t){t!=this.slowingEnabled&&(w.isInfoEnabled()&&w.info("slowingEnabled changed: "+(t==null?"null":""+t)),this.slowingEnabled=t,this.client.eventDispatcher.onPropertyChange("slowingEnabled"))},toString:function(){var t=I._new();return I.set(t,"forcedTransport",this.forcedTransport),I.set(t,"requestedMaxBandwidth",this.requestedMaxBandwidth),I.set(t,"realMaxBandwidth",this.realMaxBandwidth),I.set(t,"retryDelay",this.retryDelay),I.set(t,"firstRetryMaxDelay",this.firstRetryMaxDelay),I.set(t,"sessionRecoveryTimeout",this.sessionRecoveryTimeout),I.set(t,"reverseHeartbeatInterval",this.reverseHeartbeatInterval),I.set(t,"stalledTimeout",this.stalledTimeout),I.set(t,"reconnectTimeout",this.reconnectTimeout),I.set(t,"keepaliveInterval",this.keepaliveInterval),I.set(t,"pollingInterval",this.pollingInterval),I.set(t,"idleTimeout",this.idleTimeout),I.set(t,"contentLength",this.contentLength),I.set(t,"slowingEnabled",this.slowingEnabled),I.set(t,"serverInstanceAddressIgnored",this.serverInstanceAddressIgnored),I.set(t,"HTTPExtraHeadersOnSessionCreationOnly",this.httpExtraHeadersOnSessionCreationOnly),I.set(t,"HTTPExtraHeaders",this.httpExtraHeaders),I.set(t,"cookieHandlingRequired",this.cookieHandlingRequired),J.stringify(t.h)},__class__:z};var Y=function(){this.listeners=[]};Y.__name__=!0,Y.prototype={addListener:function(t){return this.listeners.indexOf(t)==-1?(this.listeners.push(t),!0):!1},removeListener:function(t){return L.remove(this.listeners,t)},getListeners:function(){return this.listeners},dispatchToAll:function(t){for(var e=0,s=this.listeners;e<s.length;)this.dispatchToOne(s[e++],t)},dispatchToOne:function(t,e){Ot(function(){try{e(t)}catch(i){var s=g.caught(i);w.isErrorEnabled()&&w.error(`Uncaught exception
`+s.details())}})},__class__:Y};var Et=function(){Y.call(this)};Et.__name__=!0,Et.__super__=Y,Et.prototype=T(Y.prototype,{removeListenerAndFireOnListenEnd:function(t,e){this.removeListener(t)&&this.dispatchToOne(t,function(s){s.onListenEnd!=null&&s.onListenEnd(e)})},addListenerAndFireOnListenStart:function(t,e){this.addListener(t)&&this.dispatchToOne(t,function(s){s.onListenStart!=null&&s.onListenStart(e)})},onServerError:function(t,e){this.dispatchToAll(function(s){s.onServerError!=null&&s.onServerError(t,e)})},onStatusChange:function(t){this.dispatchToAll(function(e){e.onStatusChange!=null&&e.onStatusChange(t)})},onPropertyChange:function(t){this.dispatchToAll(function(e){e.onPropertyChange!=null&&e.onPropertyChange(t)})},onServerKeepalive:function(){this.dispatchToAll(function(t){t.onServerKeepalive!=null&&t.onServerKeepalive()})},__class__:Et});var zt=Gt.LSLightstreamerClient=function(t,e){this.lock=new ae,this.eventDispatcher=new Et,this.connectionDetails=new S(this),this.connectionOptions=new z(this),this.machine=new oe(this,new is(this)),t!=null&&this.connectionDetails.setServerAddress(t),e!=null&&this.connectionDetails.setAdapterSet(e)};zt.__name__=!0,zt.setLoggerProvider=function(t){A.setLoggerProvider(t)},zt.prototype={addListener:function(t){this.eventDispatcher.addListenerAndFireOnListenStart(t,this)},removeListener:function(t){this.eventDispatcher.removeListenerAndFireOnListenEnd(t,this)},getListeners:function(){return this.eventDispatcher.getListeners().slice()},connect:function(){this.machine.connect()},disconnect:function(){this.machine.disconnect()},getStatus:function(){return this.machine.getStatus()},sendMessage:function(t,e,s,i,n){n==null&&(n=!1),s==null&&(s=-1),this.machine.sendMessage(t,e,s??-1,i,n!=null&&n)},subscribe:function(t){this.machine.subscribeExt(t)},unsubscribe:function(t){this.machine.unsubscribe(t)},getSubscriptions:function(){return this.machine.getSubscriptions().slice()},getSubscriptionWrappers:function(){for(var t=[],e=0,s=this.machine.getSubscriptions();e<s.length;){var i=s[e];++e,i.wrapper!=null&&t.push(i.wrapper)}return t.slice()},__class__:zt};var St=p["com.lightstreamer.client._Subscription.SubscriptionState"]={__ename__:!0,__constructs__:null,Inactive:{_hx_name:"Inactive",_hx_index:0,__enum__:"com.lightstreamer.client._Subscription.SubscriptionState",toString:h},Active:{_hx_name:"Active",_hx_index:1,__enum__:"com.lightstreamer.client._Subscription.SubscriptionState",toString:h},Subscribed:{_hx_name:"Subscribed",_hx_index:2,__enum__:"com.lightstreamer.client._Subscription.SubscriptionState",toString:h}};St.__constructs__=[St.Inactive,St.Active,St.Subscribed];var Le=function(){Y.call(this)};Le.__name__=!0,Le.__super__=Y,Le.prototype=T(Y.prototype,{onClearSnapshot:function(t,e){this.dispatchToAll(function(s){s.onClearSnapshot!=null&&s.onClearSnapshot(t,e)})},onCommandSecondLevelItemLostUpdates:function(t,e){this.dispatchToAll(function(s){s.onCommandSecondLevelItemLostUpdates!=null&&s.onCommandSecondLevelItemLostUpdates(t,e)})},onCommandSecondLevelSubscriptionError:function(t,e,s){this.dispatchToAll(function(i){i.onCommandSecondLevelSubscriptionError!=null&&i.onCommandSecondLevelSubscriptionError(t,e,s)})},onEndOfSnapshot:function(t,e){this.dispatchToAll(function(s){s.onEndOfSnapshot!=null&&s.onEndOfSnapshot(t,e)})},onItemLostUpdates:function(t,e,s){this.dispatchToAll(function(i){i.onItemLostUpdates!=null&&i.onItemLostUpdates(t,e,s)})},onItemUpdate:function(t){this.dispatchToAll(function(e){e.onItemUpdate!=null&&e.onItemUpdate(t)})},removeListenerAndFireOnListenEnd:function(t,e){this.removeListener(t)&&this.dispatchToOne(t,function(s){s.onListenEnd!=null&&s.onListenEnd(e)})},addListenerAndFireOnListenStart:function(t,e){this.addListener(t)&&this.dispatchToOne(t,function(s){s.onListenStart!=null&&s.onListenStart(e)})},onSubscription:function(){this.dispatchToAll(function(t){t.onSubscription!=null&&t.onSubscription()})},onSubscriptionError:function(t,e){this.dispatchToAll(function(s){s.onSubscriptionError!=null&&s.onSubscriptionError(t,e)})},onUnsubscription:function(){this.dispatchToAll(function(t){t.onUnsubscription!=null&&t.onUnsubscription()})},onRealMaxFrequency:function(t){this.dispatchToAll(function(e){e.onRealMaxFrequency!=null&&e.onRealMaxFrequency(t)})},__class__:Le});var ds=Gt.LSSubscription=function(t,e,s,i){this.lock=new ae,this.m_internal=!1,this.state=St.Inactive,this.eventDispatcher=new Le,this.wrapper=i,this.mode=be.fromString(t),this.initSnapshot(),this.initItemsAndFields(typeof e=="string"?[e].slice():e,s)};ds.__name__=!0,ds.prototype={initSnapshot:function(){this.snapshot=this.mode=="RAW"?null:Ct.SnpYes},initItemsAndFields:function(t,e){if(t!=null){if(e==null)throw new y("Please specify a valid field list");if(this.items=Ut.fromArray(mt.copy(t,t)),this.fields=Ht.fromArray(mt.copy(e,e)),this.mode=="COMMAND"&&this.fields.indexOf("key")==-1)throw new y("Field 'key' is missing");if(this.mode=="COMMAND"&&this.fields.indexOf("command")==-1)throw new y("Field 'command' is missing")}else if(e!=null)throw new y("Please specify a valid item or item list")},addListener:function(t){this.eventDispatcher.addListenerAndFireOnListenStart(t,this)},removeListener:function(t){this.eventDispatcher.removeListenerAndFireOnListenEnd(t,this)},getListeners:function(){return this.eventDispatcher.getListeners().slice()},isActive:function(){return this.state!=St.Inactive},isSubscribed:function(){return this.state==St.Subscribed},getDataAdapter:function(){return this.dataAdapter},setDataAdapter:function(t){this.checkActive(),this.dataAdapter=Xt.fromString(t)},getMode:function(){return this.mode},getItems:function(){return this.items==null?null:this.items.slice()},fetchItems:function(){return this.items},setItems:function(t){this.checkActive(),this.items=Ut.fromArray(t==null?null:mt.copy(t,t)),this.group=null},getItemGroup:function(){return this.group},setItemGroup:function(t){this.checkActive(),this.group=Xt.fromString(t),this.items=null},getFields:function(){return this.fields==null?null:this.fields.slice()},fetchFields:function(){return this.fields},setFields:function(t){this.checkActive();var e=Ht.fromArray(t==null?null:mt.copy(t,t));if(this.mode=="COMMAND"&&e!=null){if(e.indexOf("command")==-1)throw new y("Field 'command' is missing");if(e.indexOf("key")==-1)throw new y("Field 'key' is missing")}this.fields=e,this.schema=null},getFieldSchema:function(){return this.schema},setFieldSchema:function(t){this.checkActive(),this.schema=Xt.fromString(t),this.fields=null},getRequestedBufferSize:function(){return ye.toString(this.bufferSize)},setRequestedBufferSize:function(t){t!=null&&(t=t==null?"null":""+t),this.checkActive(),this.bufferSize=ye.fromString(t)},getRequestedSnapshot:function(){return we.toString(this.snapshot)},setRequestedSnapshot:function(t){t!=null&&(t=t==null?"null":""+t),this.checkActive();var e=we.fromString(t);switch(this.mode){case"COMMAND":case"MERGE":if(e!=null&&(e!=null&&e._hx_index==2))throw new y("Snapshot length is not permitted if MERGE or COMMAND was specified as mode");break;case"RAW":if(e!=null)throw new y("Snapshot is not permitted if RAW was specified as mode");break}this.snapshot=e},getRequestedMaxFrequency:function(){return Lt.toString(this.requestedMaxFrequency)},setRequestedMaxFrequency:function(t){var e=this;t!=null&&(t=t==null?"null":""+t);var s;this.lock.synchronized(function(){var i=Lt.fromString(t);switch(e.mode){case"COMMAND":case"DISTINCT":case"MERGE":break;default:throw new y("The operation in only available on MERGE, DISTINCT and COMMAND Subscripitons")}if(e.isActive()&&(i==null||i==Wt.FreqUnfiltered||e.requestedMaxFrequency==Wt.FreqUnfiltered))throw new y("Cannot change the frequency from/to 'unfiltered' or to null while the Subscription is active");return e.subId!=null&&G.isInfoEnabled()&&G.info("Subscription "+e.subId+" requested max frequency changed: "+t),e.requestedMaxFrequency=i,s=e.manager,s}),s?.evtExtConfigure()},getSelector:function(){return this.selector},setSelector:function(t){this.checkActive(),this.selector=Xt.fromString(t)},getCommandPosition:function(){if(this.checkCommand(),this.cmdIdx==null)throw new R("The position of the command field is currently unknown");return this.cmdIdx},getKeyPosition:function(){if(this.checkCommand(),this.keyIdx==null)throw new R("The position of the key field is currently unknown");return this.keyIdx},getCommandSecondLevelDataAdapter:function(){return this.dataAdapter2},setCommandSecondLevelDataAdapter:function(t){this.checkActive(),this.checkCommand(),this.dataAdapter2=Xt.fromString(t)},getCommandSecondLevelFields:function(){return this.fields2==null?null:this.fields2.slice()},setCommandSecondLevelFields:function(t){this.checkActive(),this.checkCommand(),this.fields2=Ht.fromArray(t==null?null:mt.copy(t,t)),this.schema2=null},getCommandSecondLevelFieldSchema:function(){return this.schema2},setCommandSecondLevelFieldSchema:function(t){this.checkActive(),this.checkCommand(),this.schema2=Xt.fromString(t),this.fields2=null},getValue:function(t,e){var s=typeof t=="number"&&(t|0)===t,i=typeof t=="string",n=typeof e=="number"&&(e|0)===e,r=typeof e=="string";if(s&&n)return this.getValuePosPos(t,e);if(s&&r)return this.getValuePosName(t,e);if(i&&n)return this.getValueNamePos(t,e);if(i&&r)return this.getValueNameName(t,e);throw new y("Invalid argument type")},getCommandValue:function(t,e,s){var i=typeof t=="number"&&(t|0)===t,n=typeof t=="string",r=typeof s=="number"&&(s|0)===s,o=typeof s=="string";if(i&&r)return this.getCommandValuePosPos(t,e,s);if(i&&o)return this.getCommandValuePosName(t,e,s);if(n&&r)return this.getCommandValueNamePos(t,e,s);if(n&&o)return this.getCommandValueNameName(t,e,s);throw new y("Invalid argument type")},getValuePosPos:function(t,e){var s=this;if(t<1||e<1)throw new y("The specified position is out of bounds");var i;return this.lock.synchronized(function(){return i=s.manager,i}),i!=null?i.getValue(t,e):null},getValuePosName:function(t,e){var s=this;return this.getValuePosPos(t,this.lock.synchronized(function(){return s.getFieldPos(e)}))},getValueNamePos:function(t,e){var s=this;return this.getValuePosPos(this.lock.synchronized(function(){return s.getItemPos(t)}),e)},getValueNameName:function(t,e){var s=this;return this.getValuePosPos(this.lock.synchronized(function(){return s.getItemPos(t)}),this.lock.synchronized(function(){return s.getFieldPos(e)}))},getCommandValuePosPos:function(t,e,s){var i=this;if(this.checkCommand(),t<1||s<1)throw new y("The specified position is out of bounds");var n;return this.lock.synchronized(function(){return n=i.manager,n}),n!=null?n.getCommandValue(t,e,s):null},getCommandValuePosName:function(t,e,s){var i=this;return this.getCommandValuePosPos(t,e,this.lock.synchronized(function(){return i.getFieldPos(s)}))},getCommandValueNamePos:function(t,e,s){var i=this;return this.getCommandValuePosPos(this.lock.synchronized(function(){return i.getItemPos(t)}),e,s)},getCommandValueNameName:function(t,e,s){var i=this;return this.getCommandValuePosPos(this.lock.synchronized(function(){return i.getItemPos(t)}),e,this.lock.synchronized(function(){return i.getFieldPos(s)}))},getItemPos:function(t){var e,s;if(this.items!=null?(e=Ut.getPos(this.items,t),s=e==-1):s=!0,s)throw new y("Unknown item name");return e},getFieldPos:function(t){var e,s;if(this.fields!=null?(e=Ht.getPos(this.fields,t),s=e==-1):s=!0,s)throw new y("Unknown field name");return e},checkActive:function(){if(this.isActive())throw new R("Cannot modify an active Subscription. Please unsubscribe before applying any change")},checkCommand:function(){if(this.mode!="COMMAND")throw new R("This method can only be used on COMMAND subscriptions")},fetch_items:function(){return this.items},fetch_fields:function(){return this.fields},fetch_fields2:function(){return this.fields2},fetch_mode:function(){return this.mode},fetch_requestedBufferSize:function(){return this.bufferSize},fetch_requestedSnapshot:function(){return this.snapshot},fetch_requestedMaxFrequency:function(){return this.requestedMaxFrequency},fetch_nItems:function(){return this.nItems},fetch_subManager:function(){return this.manager},setActive:function(){this.state=St.Active},setInactive:function(){this.state=St.Inactive,this.subId=null,this.cmdIdx=null,this.keyIdx=null,this.nItems=null,this.nFields=null},setSubscribed:function(t,e,s){this.state=St.Subscribed,this.subId=t,this.nItems=e,this.nFields=s},setSubscribedCMD:function(t,e,s,i,n){this.state=St.Subscribed,this.subId=t,this.cmdIdx=i,this.keyIdx=n,this.nItems=e,this.nFields=s},fetch_nFields:function(){return this.nFields},isInternal:function(){return this.m_internal},setInternal:function(){this.m_internal=!0},getItemName:function(t){return this.items!=null?this.items[t-1]:null},relate:function(t){this.manager=t},unrelate:function(t){this.manager==t&&(this.manager=null)},hasSnapshot:function(){return!(this.snapshot==null||this.snapshot==Ct.SnpNo)},getItemNameOrPos:function(t){return this.items!=null?this.items[t-1]:""+t},fireOnSubscription:function(t){G.isInfoEnabled()&&G.info("Subscription "+t+" added"),this.eventDispatcher.onSubscription()},fireOnUnsubscription:function(t){G.isInfoEnabled()&&G.info("Subscription "+t+" deleted"),this.eventDispatcher.onUnsubscription()},fireOnSubscriptionError:function(t,e,s){G.isWarnEnabled()&&G.warn("Subscription "+t+" failed: "+e+" - "+s),this.eventDispatcher.onSubscriptionError(e,s)},fireOnEndOfSnapshot:function(t,e){G.isDebugEnabled()&&G.debug("Subscription "+e+":"+this.getItemNameOrPos(t)+": snapshot ended"),this.eventDispatcher.onEndOfSnapshot(this.getItemName(t),t)},fireOnClearSnapshot:function(t,e){G.isDebugEnabled()&&G.debug("Subscription "+e+":"+this.getItemNameOrPos(t)+": snapshot cleared"),this.eventDispatcher.onClearSnapshot(this.getItemName(t),t)},fireOnLostUpdates:function(t,e,s){G.isDebugEnabled()&&G.debug("Subscription "+s+":"+this.getItemNameOrPos(t)+": lost "+e+" updates"),this.eventDispatcher.onItemLostUpdates(this.getItemName(t),t,e)},fireOnItemUpdate:function(t,e){G.isDebugEnabled()&&G.debug("Subscription "+e+":"+this.getItemNameOrPos(t.getItemPos())+" update: "+c.string(t)),this.eventDispatcher.onItemUpdate(t)},fireOnRealMaxFrequency:function(t,e){G.isDebugEnabled()&&G.debug("Subscription "+e+" real max frequency changed: "+c.string(t)),this.eventDispatcher.onRealMaxFrequency(Ei(t))},fireOnSubscriptionError2Level:function(t,e,s,i,n){G.isWarnEnabled()&&G.warn("Subscription "+i+":"+this.getItemNameOrPos(n)+":"+t+" failed: "+e+" - "+s),this.eventDispatcher.onCommandSecondLevelSubscriptionError(e,s,t)},fireOnLostUpdates2Level:function(t,e,s,i){G.isDebugEnabled()&&G.debug("Subscription "+s+":"+this.getItemNameOrPos(i)+":"+t+": lost "+e+" updates"),this.eventDispatcher.onCommandSecondLevelItemLostUpdates(e,t)},toString:function(){var t=I._new();return I.set(t,"mode",this.mode),I.set(t,"items",this.items!=null?c.string(this.items):this.group),I.set(t,"fields",this.fields!=null?c.string(this.fields):this.schema),I.set(t,"dataAdapter",this.dataAdapter),I.set(t,"requestedBufferSize",this.bufferSize),I.set(t,"requestedSnapshot",this.snapshot),I.set(t,"requestedMaxFrequency",this.requestedMaxFrequency),I.set(t,"selector",this.selector),I.set(t,"secondLevelFields",this.fields2!=null?c.string(this.fields2):this.schema2),I.set(t,"secondLevelDataAdapter",this.dataAdapter2),J.stringify(t.h)},__class__:ds};var De=function(){};De.__name__=!0,De.__isInterface__=!0,De.prototype={__class__:De};var Yt=function(t){this.frozen=!1,this.onEvent=t};Yt.__name__=!0,Yt.__interfaces__=[De],Yt.newLoggingInstance=function(){var t=new Yt(function(e){Ds.isWarnEnabled()&&Ds.warn(""+c.string(e)+" event detected")});return t.startListening(),t},Yt.prototype={handleFrozen:function(){this.frozen=!0,this.onEvent(es.Frozen)},handleResumed:function(){this.frozen=!1,this.onEvent(es.Resumed)},startListening:function(){E.get_supported()&&(window.addEventListener("freeze",$(this,this.handleFrozen),{capture:!0}),window.addEventListener("resume",$(this,this.handleResumed),{capture:!0}))},stopListening:function(){E.get_supported()&&(window.removeEventListener("freeze",$(this,this.handleFrozen),{capture:!0}),window.removeEventListener("resume",$(this,this.handleResumed),{capture:!0}))},__class__:Yt};var Tt=function(){};Tt.__name__=!0,Tt.__interfaces__=[ui],Tt.prototype={__class__:Tt};var Ne=function(){};Ne.__name__=!0,Ne.__super__=Tt,Ne.prototype=T(Tt.prototype,{fatal:function(t,e){},error:function(t,e){},warn:function(t,e){},info:function(t,e){},debug:function(t,e){},trace:function(t,e){},isFatalEnabled:function(){return!1},isErrorEnabled:function(){return!1},isWarnEnabled:function(){return!1},isInfoEnabled:function(){return!1},isDebugEnabled:function(){return!1},isTraceEnabled:function(){return!1},__class__:Ne});var ae=function(){};ae.__name__=!0,ae.prototype={acquire:function(){},release:function(){},synchronized:function(t){var e=null,s=null;try{s=t()}catch(i){e=g.caught(i)}if(e!=null)throw g.thrown(e);return s},__class__:ae};var A=function(){};A.__name__=!0,A.getLogger=function(t){return A.lock.synchronized(function(){var e=A.logInstances.h[t];if(e==null){var s=new Oe(A.currentLoggerProvider==null?A.emptyLogger:A.currentLoggerProvider.getLogger(t));A.logInstances.h[t]=s,e=s}return e})},A.setLoggerProvider=function(t){A.lock.synchronized(function(){A.currentLoggerProvider=t;for(var e=A.logInstances.h,s=Object.keys(e),i=s.length,n=0;n<i;){var r=s[n++];e[r].wrappedLogger=A.currentLoggerProvider==null?A.emptyLogger:A.currentLoggerProvider.getLogger(r)}})},A.newLogger=function(t){return A.currentLoggerProvider==null?A.emptyLogger:A.currentLoggerProvider.getLogger(t)};var Oe=function(t){this.wrappedLogger=t};Oe.__name__=!0,Oe.__super__=Tt,Oe.prototype=T(Tt.prototype,{fatal:function(t,e){this.wrappedLogger.fatal(t,e)},error:function(t,e){this.wrappedLogger.error(t,e)},warn:function(t,e){this.wrappedLogger.warn(t,e)},info:function(t,e){this.wrappedLogger.info(t,e)},debug:function(t,e){this.wrappedLogger.debug(t,e)},trace:function(t,e){this.wrappedLogger.trace(t,e)},isFatalEnabled:function(){return this.wrappedLogger.isFatalEnabled()},isErrorEnabled:function(){return this.wrappedLogger.isErrorEnabled()},isWarnEnabled:function(){return this.wrappedLogger.isWarnEnabled()},isInfoEnabled:function(){return this.wrappedLogger.isInfoEnabled()},isDebugEnabled:function(){return this.wrappedLogger.isDebugEnabled()},isTraceEnabled:function(){return this.wrappedLogger.isTraceEnabled()},__class__:Oe});var B=function(){};B.__name__=!0,B.getClass=function(t){if(t==null)return null;if(t instanceof Array)return Array;var e=t.__class__;if(e!=null)return e;var s=B.__nativeClassName(t);return s!=null?B.__resolveNativeClass(s):null},B.__string_rec=function(t,e){if(t==null)return"null";if(e.length>=5)return"<...>";var s=typeof t;switch(s=="function"&&(t.__name__||t.__ename__)&&(s="object"),s){case"function":return"<function>";case"object":if(t.__enum__){var i=p[t.__enum__],n=i.__constructs__[t._hx_index],r=n._hx_name;return n.__params__?(e=e+"	",r+"("+(function(gt){for(var Vt,bt=[],ct=0,Ie=n.__params__;ct<Ie.length;){var cs=Ie[ct];ct=ct+1,bt.push(B.__string_rec(t[cs],e))}return Vt=bt,Vt})().join(",")+")"):r}if(t instanceof Array){var F="[";e+="	";for(var o=0,l=t.length;o<l;){var v=o++;F+=(v>0?",":"")+B.__string_rec(t[v],e)}return F+="]",F}var D;try{D=t.toString}catch{return"???"}if(D!=null&&D!=Object.toString&&typeof D=="function"){var N=t.toString();if(N!="[object Object]")return N}var F=`{
`;e+="	";var rt=t.hasOwnProperty!=null,V=null;for(V in t)rt&&!t.hasOwnProperty(V)||V=="prototype"||V=="__class__"||V=="__super__"||V=="__interfaces__"||V=="__properties__"||(F.length!=2&&(F+=`, 
`),F+=e+V+" : "+B.__string_rec(t[V],e));return e=e.substring(1),F+=`
`+e+"}",F;case"string":return t;default:return String(t)}},B.__interfLoop=function(t,e){for(;;){if(t==null)return!1;if(t==e)return!0;var s=t.__interfaces__;if(s!=null)for(var i=0,n=s.length;i<n;){var r=s[i++];if(r==e||B.__interfLoop(r,e))return!0}t=t.__super__}},B.__instanceof=function(t,e){if(e==null)return!1;switch(e){case Array:return t instanceof Array;case Ci:return typeof t=="boolean";case xi:return t!=null;case Ii:return typeof t=="number";case Ri:return typeof t=="number"?(t|0)===t:!1;case String:return typeof t=="string";default:if(t!=null){if(typeof e=="function"){if(B.__downcastCheck(t,e))return!0}else if(typeof e=="object"&&B.__isNativeObj(e)&&t instanceof e)return!0}else return!1;return e==Li&&t.__name__!=null||e==Di&&t.__ename__!=null?!0:t.__enum__!=null?p[t.__enum__]==e:!1}},B.__downcastCheck=function(t,e){return t instanceof e?!0:e.__isInterface__?B.__interfLoop(B.getClass(t),e):!1},B.__cast=function(t,e){if(t==null||B.__instanceof(t,e))return t;throw g.thrown("Cannot cast "+c.string(t)+" to "+c.string(e))},B.__nativeClassName=function(t){var e=B.__toStr.call(t).slice(8,-1);return e=="Object"||e=="Function"||e=="Math"||e=="JSON"?null:e},B.__isNativeObj=function(t){return B.__nativeClassName(t)!=null},B.__resolveNativeClass=function(t){return a[t]};var oe=function(t,e){this.slw_m=.5,this.slw_hugeDelayMs=2e4,this.slw_maxAvgDelayMs=7e3,this.slw_avgDelayMs=0,this.slw_refTime=0,this.rec_clientProg=0,this.rec_serverProg=0,this.subscriptionManagers=new pe,this.messageManagers=new At,this.sequenceMap=new J,this.disabledTransports=new Q,this.suspendedTransports=new Q,this.ctrl_connectTs=0,this.recoverTs=0,this.connectTs=0,this.m_nextSubId=0,this.m_nextReqId=0,this.m_status="DISCONNECTED",this.delayCounter=new gs,this.state=new vs,this.client=t,this.lock=t.lock,this.details=t.connectionDetails,this.options=t.connectionOptions,this.wsFactory=$(e,e.createWsClient),this.httpFactory=$(e,e.createHttpClient),this.ctrlFactory=$(e,e.createCtrlClient),this.timerFactory=$(e,e.createTimer),this.randomGenerator=$(e,e.randomMillis),this.reachabilityFactory=$(e,e.createReachabilityManager),this.frz_pageLifecycleFactory=$(e,e.createPageLifecycleFactory),this.clientEventDispatcher=t.eventDispatcher,this.switchRequest=new Pe(this),this.constrainRequest=new ke(this),this.delayCounter.reset(this.options.retryDelay)};oe.__name__=!0,oe.prototype={disposeSession:function(){this.disposeWS(),this.disposeHTTP(),this.disposeCtrl(),this.details.setServerInstanceAddress(null),this.details.setSessionId(null),this.details.setServerSocketName(null),this.details.setClientIp(null),this.options.setRealMaxBandwidth(null),this.lastKnownClientIp=null,this.resetSequenceMap(),this.rec_serverProg=0,this.rec_clientProg=0,this.bw_lastReqId=null,this.bw_requestedMaxBandwidth=null,this.swt_lastReqId=null},disposeClient:function(){this.sessionId=null,this.enableAllTransports(),this.resetCurrentRetryDelay(),this.resetSequenceMap(),this.cause=null},evtExtConnect:function(){this.traceEvent("connect");var t=!0;if(this.state.s_m==100)if(oe.frz_globalPageLifecycle.frozen){Ds.isWarnEnabled()&&Ds.warn("connection requested while page is frozen"),this.cause="page.frozen",this.resetCurrentRetryDelay(),this.doInstallPageLifecycle(),this.state.s_m=117,this.state.traceState(),t=this.evtExtConnect_NextRegion();var e=this.frz_pageLifecycle;e?.startListening(),this.evtRetry(d.page_frozen)}else{this.cause="api",this.resetCurrentRetryDelay(),this.doInstallPageLifecycle(),this.state.s_m=101,this.state.traceState(),t=this.evtExtConnect_NextRegion();var e=this.frz_pageLifecycle;e?.startListening(),this.evtSelectCreate()}t&&this.evtExtConnect_NextRegion()},evtExtConnect_NextRegion:function(){return this.evtExtConnect_NetworkReachabilityRegion()},evtExtConnect_NetworkReachabilityRegion:function(){var t=this;if(this.state.s_nr==1400){var e=new st(this.getServerAddress()).get_hostname();this.nr_reachabilityManager=this.reachabilityFactory(e),this.state.s_nr=1410,this.state.traceState(),this.nr_reachabilityManager.startListening(function(s){switch(s._hx_index){case 0:t.evtNetworkReachable(e);break;case 1:t.evtNetworkNotReachable(e);break}})}return!1},doInstallPageLifecycle:function(){var t=this;this.frz_pageLifecycle=this.frz_pageLifecycleFactory(function(e){switch(e._hx_index){case 0:t.evtPageFrozen();break;case 1:t.evtPageResumed();break}})},doUnistallPageLifecycle:function(){var t=this.frz_pageLifecycle;t?.stopListening(),this.frz_pageLifecycle=null},evtPageFrozen:function(){switch(this.traceEvent("page.frozen"),this.state.s_m){case 110:case 111:case 112:case 113:case 114:case 115:case 116:this.notifyStatus("DISCONNECTED:WILL-RETRY"),this.cause="page.frozen",this.state.s_m=117,this.state.traceState(),this.cancel_evtRetryTimeout();break;case 120:case 121:case 122:this.disposeWS(),this.notifyStatus("DISCONNECTED:WILL-RETRY"),this.cause="page.frozen",this.state.s_m=117,this.state.traceState(),this.cancel_evtTransportTimeout(),this.evtRetry(d.page_frozen);break;case 130:this.disposeHTTP(),this.notifyStatus("DISCONNECTED:WILL-RETRY"),this.cause="page.frozen",this.state.s_m=117,this.state.traceState(),this.cancel_evtTransportTimeout(),this.evtRetry(d.page_frozen);break;case 140:this.disposeHTTP(),this.notifyStatus("DISCONNECTED:WILL-RETRY"),this.cause="page.frozen",this.state.s_m=117,this.state.traceState(),this.cancel_evtTransportTimeout(),this.evtRetry(d.page_frozen);break;case 150:var t=this.state.s_tr;if(t!=null)switch(t){case 210:this.sendDestroyWS("page.frozen"),this.closeWS(),this.notifyStatus("DISCONNECTED:WILL-RETRY"),this.cause="page.frozen",this.state.clear_w(),this.state.goto_m_from_session(117),this.exit_w(),this.evtEndSession(),this.evtRetry(d.page_frozen);break;case 220:this.disposeHTTP(),this.notifyStatus("DISCONNECTED:WILL-RETRY"),this.cause="page.frozen",this.state.goto_m_from_session(117),this.cancel_evtTransportTimeout(),this.evtEndSession(),this.evtRetry(d.page_frozen);break;case 230:this.disposeHTTP(),this.notifyStatus("DISCONNECTED:WILL-RETRY"),this.cause="page.frozen",this.state.goto_m_from_session(117),this.cancel_evtTransportTimeout(),this.evtEndSession(),this.evtRetry(d.page_frozen);break;case 240:var s=this.state.s_ws;if((s!=null?s.m:null)==500)this.disposeWS(),this.notifyStatus("DISCONNECTED:WILL-RETRY"),this.cause="page.frozen",this.state.goto_m_from_ws(117),this.exit_ws_to_m(),this.evtRetry(d.page_frozen);else{var s,i,e=this.state.s_ws;if((e!=null?e.m:null)!=501){var e=this.state.s_ws;i=(e!=null?e.m:null)==502}else i=!0;if(i)s=!0;else{var i=this.state.s_ws;s=(i!=null?i.m:null)==503}s&&(this.sendDestroyWS("page.frozen"),this.closeWS(),this.notifyStatus("DISCONNECTED:WILL-RETRY"),this.cause="page.frozen",this.state.goto_m_from_ws(117),this.exit_ws_to_m(),this.evtRetry(d.page_frozen))}break;case 250:var s,i=this.state.s_wp;if((i!=null?i.m:null)!=600){var i=this.state.s_wp;s=(i!=null?i.m:null)==601}else s=!0;if(s)this.disposeWS(),this.notifyStatus("DISCONNECTED:WILL-RETRY"),this.cause="page.frozen",this.state.goto_m_from_wp(117),this.exit_ws_to_m(),this.evtRetry(d.page_frozen);else{var s=this.state.s_wp;(s!=null?s.m:null)==602&&(this.sendDestroyWS("page.frozen"),this.closeWS(),this.notifyStatus("DISCONNECTED:WILL-RETRY"),this.cause="page.frozen",this.state.goto_m_from_wp(117),this.exit_wp_to_m(),this.evtRetry(d.page_frozen))}break;case 260:this.disposeHTTP(),this.notifyStatus("DISCONNECTED:WILL-RETRY"),this.cause="page.frozen",this.state.goto_m_from_rec(117),this.exit_rec_to_m(),this.evtRetry(d.page_frozen);break;case 270:this.state.s_h==710?(this.disposeHTTP(),this.notifyStatus("DISCONNECTED:WILL-RETRY"),this.cause="page.frozen",this.state.goto_m_from_hs(117),this.exit_hs_to_m(),this.evtRetry(d.page_frozen)):this.state.s_h==720&&(this.disposeHTTP(),this.notifyStatus("DISCONNECTED:WILL-RETRY"),this.cause="page.frozen",this.state.goto_m_from_hp(117),this.exit_hp_to_m(),this.evtRetry(d.page_frozen));break}break}},evtPageResumed:function(){this.traceEvent("page.resumed"),this.state.s_m==117&&(this.state.s_m=116,this.state.traceState(),this.evtSelectCreate())},evtNetworkNotReachable:function(t){Ls.isInfoEnabled()&&Ls.info(""+t+" is NOT reachable"),this.traceEvent("nr:network.not.reachable"),this.state.s_nr==1410?(this.state.s_nr=1411,this.state.traceState()):this.state.s_nr==1412&&(this.state.s_nr=1411,this.state.traceState())},evtNetworkReachable:function(t){Ls.isInfoEnabled()&&Ls.info(""+t+" is reachable"),this.traceEvent("nr:network.reachable"),this.state.s_nr==1410?(this.state.s_nr=1412,this.state.traceState()):this.state.s_nr==1411&&(this.state.s_nr=1412,this.state.traceState(),this.evtOnlineAgain())},evtOnlineAgain:function(){this.traceEvent("online.again"),this.state.s_m==112?(this.state.s_m=116,this.state.traceState(),this.cancel_evtRetryTimeout(),this.evtSelectCreate()):this.state.s_rec==1003&&(this.sendRecovery(),this.state.s_rec=1001,this.state.traceState(),this.cancel_evtRetryTimeout(),this.schedule_evtTransportTimeout(this.options.retryDelay))},evtServerAddressChanged:function(){var t=this;switch(this.traceEvent("nr:serverAddress.changed"),this.state.s_nr){case 1410:case 1411:case 1412:var e=this.nr_reachabilityManager,s=new st(this.getServerAddress()).get_hostname();this.nr_reachabilityManager=this.reachabilityFactory(s),this.state.s_nr=1410,this.state.traceState(),e?.stopListening(),this.nr_reachabilityManager.startListening(function(i){switch(i._hx_index){case 0:t.evtNetworkReachable(s);break;case 1:t.evtNetworkNotReachable(s);break}});break}},evtExtDisconnect:function(t){switch(this.traceEvent("disconnect: cause="+c.string(t)),this.state.s_m){case 110:case 111:case 112:case 113:case 114:case 115:case 116:case 117:this.notifyStatus("DISCONNECTED"),this.notifyServerErrorIfCauseIsError(t),this.state.s_m=100,this.state.traceState(),this.cancel_evtRetryTimeout(),this.evtTerminate(t);break;case 120:case 121:case 122:this.disposeWS(),this.notifyStatus("DISCONNECTED"),this.notifyServerErrorIfCauseIsError(t),this.state.s_m=100,this.state.traceState(),this.cancel_evtTransportTimeout(),this.evtTerminate(t);break;case 130:this.disposeHTTP(),this.notifyStatus("DISCONNECTED"),this.notifyServerErrorIfCauseIsError(t),this.state.s_m=100,this.state.traceState(),this.cancel_evtTransportTimeout(),this.evtTerminate(t);break;case 140:this.disposeHTTP(),this.notifyStatus("DISCONNECTED"),this.notifyServerErrorIfCauseIsError(t),this.state.s_m=100,this.state.traceState(),this.cancel_evtTransportTimeout(),this.evtTerminate(t);break;case 150:var e=this.state.s_tr;if(e!=null)switch(e){case 210:this.sendDestroyWS(),this.closeWS(),this.notifyStatus("DISCONNECTED"),this.notifyServerErrorIfCauseIsError(t),this.state.clear_w(),this.state.goto_m_from_session(100),this.exit_w(),this.evtEndSession(),this.evtTerminate(t);break;case 220:this.disposeHTTP(),this.notifyStatus("DISCONNECTED"),this.notifyServerErrorIfCauseIsError(t),this.state.goto_m_from_session(100),this.cancel_evtTransportTimeout(),this.evtEndSession(),this.evtTerminate(t);break;case 230:this.disposeHTTP(),this.notifyStatus("DISCONNECTED"),this.notifyServerErrorIfCauseIsError(t),this.state.goto_m_from_session(100),this.cancel_evtTransportTimeout(),this.evtEndSession(),this.evtTerminate(t);break;case 240:var i=this.state.s_ws;if((i!=null?i.m:null)==500)this.disposeWS(),this.notifyStatus("DISCONNECTED"),this.notifyServerErrorIfCauseIsError(t),this.state.goto_m_from_ws(100),this.exit_ws_to_m(),this.evtTerminate(t);else{var i,n,s=this.state.s_ws;if((s!=null?s.m:null)!=501){var s=this.state.s_ws;n=(s!=null?s.m:null)==502}else n=!0;if(n)i=!0;else{var n=this.state.s_ws;i=(n!=null?n.m:null)==503}i&&(this.sendDestroyWS(),this.closeWS(),this.notifyStatus("DISCONNECTED"),this.notifyServerErrorIfCauseIsError(t),this.state.goto_m_from_ws(100),this.exit_ws_to_m(),this.evtTerminate(t))}break;case 250:var i,n=this.state.s_wp;if((n!=null?n.m:null)!=600){var n=this.state.s_wp;i=(n!=null?n.m:null)==601}else i=!0;if(i)this.disposeWS(),this.notifyStatus("DISCONNECTED"),this.notifyServerErrorIfCauseIsError(t),this.state.goto_m_from_wp(100),this.exit_ws_to_m(),this.evtTerminate(t);else{var i=this.state.s_wp;(i!=null?i.m:null)==602&&(this.sendDestroyWS(),this.closeWS(),this.notifyStatus("DISCONNECTED"),this.notifyServerErrorIfCauseIsError(t),this.state.goto_m_from_wp(100),this.exit_wp_to_m(),this.evtTerminate(t))}break;case 260:this.disposeHTTP(),this.notifyStatus("DISCONNECTED"),this.notifyServerErrorIfCauseIsError(t),this.state.goto_m_from_rec(100),this.exit_rec_to_m(),this.evtTerminate(t);break;case 270:this.state.s_h==710?(this.disposeHTTP(),this.notifyStatus("DISCONNECTED"),this.notifyServerErrorIfCauseIsError(t),this.state.goto_m_from_hs(100),this.exit_hs_to_m(),this.evtTerminate(t)):this.state.s_h==720&&(this.disposeHTTP(),this.notifyStatus("DISCONNECTED"),this.notifyServerErrorIfCauseIsError(t),this.state.goto_m_from_hp(100),this.exit_hp_to_m(),this.evtTerminate(t));break}break}},evtSelectCreate:function(){if(this.traceEvent("select.create"),this.state.s_m==101||this.state.s_m==116)switch(this.getBestForCreating()._hx_index){case 0:this.notifyStatus("CONNECTING"),this.openWS_Create(),this.state.s_m=120,this.state.traceState(),this.evtCreate(),this.schedule_evtTransportTimeout(this.delayCounter.get_currentRetryDelay());break;case 1:this.notifyStatus("CONNECTING"),this.sendCreateHTTP(),this.state.s_m=130,this.state.traceState(),this.evtCreate(),this.schedule_evtTransportTimeout(this.delayCounter.get_currentRetryDelay());break;case 2:this.notifyStatus("DISCONNECTED"),this.state.s_m=100,this.state.traceState(),this.evtTerminate(ut.TC_otherError("Unable to select a transport"));break}},evtWSOpen:function(){if(this.traceEvent("ws.open"),this.state.s_m==120)this.sendCreateWS(),this.state.s_m=121,this.state.traceState();else{var t=this.state.s_ws;if((t!=null?t.m:null)==500)this.sendBindWS_Streaming(),this.state.s_ws.m=501,this.state.traceState();else{var t=this.state.s_wp;(t!=null?t.m:null)==600&&(f.sure(this.ws).send("wsok"),this.state.s_wp.m=601,this.state.traceState())}}},evtMessage:function(t){var e=!0;if(b.startsWith(t,"U,")){var s=gi(t);this.evtU(s.subId,s.itemIdx,s.values,t)}else if(b.startsWith(t,"REQOK"))t=="REQOK"?this.evtREQOK_withoutReqId():this.evtREQOK(k(t.split(",")[1]));else if(b.startsWith(t,"PROBE"))this.evtPROBE();else if(b.startsWith(t,"LOOP"))this.evtLOOP(k(t.split(",")[1]));else if(b.startsWith(t,"CONOK")){var i=t.split(",");this.evtCONOK(i[1],k(i[2]),k(i[3]),i[4])}else if(b.startsWith(t,"WSOK"))this.evtWSOK();else if(b.startsWith(t,"SERVNAME"))this.evtSERVNAME(t.split(",")[1]);else if(b.startsWith(t,"CLIENTIP"))this.evtCLIENTIP(t.split(",")[1]);else if(b.startsWith(t,"CONS")){var n=t.split(",")[1];switch(n){case"unlimited":this.evtCONS(Zt.BWUnlimited);break;case"unmanaged":this.evtCONS(Zt.BWUnmanaged);break;default:this.evtCONS(Zt.BWLimited(Js(n)))}}else if(b.startsWith(t,"MSGDONE")){var i=t.split(","),r=i[1];r=="*"&&(r="UNORDERED_MESSAGES");var o=k(i[2]),l=i[3];this.evtMSGDONE(r,o,l==""?"":yt(l))}else if(b.startsWith(t,"MSGFAIL")){var i=t.split(","),r=i[1];r=="*"&&(r="UNORDERED_MESSAGES"),this.evtMSGFAIL(r,k(i[2]),k(i[3]),yt(i[4]))}else if(b.startsWith(t,"REQERR")){var i=t.split(",");this.evtREQERR(k(i[1]),k(i[2]),yt(i[3]))}else if(b.startsWith(t,"PROG"))this.evtPROG(k(t.split(",")[1]));else if(b.startsWith(t,"SUBOK")){var i=t.split(",");this.evtSUBOK(k(i[1]),k(i[2]),k(i[3]))}else if(b.startsWith(t,"SUBCMD")){var i=t.split(",");this.evtSUBCMD(k(i[1]),k(i[2]),k(i[3]),k(i[4]),k(i[5]))}else if(b.startsWith(t,"UNSUB"))this.evtUNSUB(k(t.split(",")[1]));else if(b.startsWith(t,"CONF")){var i=t.split(","),v=k(i[1]);i[2]=="unlimited"?this.evtCONF(v,Dt.RFreqUnlimited):this.evtCONF(v,Dt.RFreqLimited(Js(i[2])))}else if(b.startsWith(t,"EOS")){var i=t.split(",");this.evtEOS(k(i[1]),k(i[2]))}else if(b.startsWith(t,"CS")){var i=t.split(",");this.evtCS(k(i[1]),k(i[2]))}else if(b.startsWith(t,"OV")){var i=t.split(",");this.evtOV(k(i[1]),k(i[2]),k(i[3]))}else if(b.startsWith(t,"NOOP"))this.evtNOOP();else if(b.startsWith(t,"CONERR")){var i=t.split(",");this.evtCONERR(k(i[1]),yt(i[2]))}else if(b.startsWith(t,"END")){var i=t.split(",");this.evtEND(k(i[1]),yt(i[2]))}else if(b.startsWith(t,"ERROR")){var i=t.split(",");this.evtERROR(k(i[1]),yt(i[2]))}else b.startsWith(t,"SYNC")?this.evtSYNC(k(t.split(",")[1])):e=!1;return e},evtCtrlMessage:function(t){if(b.startsWith(t,"REQOK"))t=="REQOK"?this.evtREQOK_withoutReqId():this.evtREQOK(k(t.split(",")[1]));else if(b.startsWith(t,"REQERR")){var e=t.split(",");this.evtREQERR(k(e[1]),k(e[2]),yt(e[3]))}else if(b.startsWith(t,"ERROR")){var e=t.split(",");this.evtERROR(k(e[1]),yt(e[2]))}},evtTransportTimeout:function(){switch(this.traceEvent("transport.timeout"),this.state.s_m){case 120:case 121:this.suspendWS_Streaming(),this.disposeWS(),this.cause="ws.unavailable",this.state.s_m=115,this.state.traceState(),this.cancel_evtTransportTimeout(),this.entry_m115(d.ws_unavailable);break;case 122:this.disposeWS(),this.notifyStatus("DISCONNECTED:WILL-RETRY"),this.cause="ws.timeout",this.state.s_m=112,this.state.traceState(),this.cancel_evtTransportTimeout(),this.entry_m112(d.ws_timeout);break;case 130:this.disposeHTTP(),this.notifyStatus("DISCONNECTED:WILL-RETRY"),this.cause="http.timeout",this.state.s_m=112,this.state.traceState(),this.cancel_evtTransportTimeout(),this.entry_m112(d.http_timeout);break;case 140:this.disposeHTTP(),this.notifyStatus("DISCONNECTED:WILL-RETRY"),this.cause="ttl.timeout";var t=this.waitingInterval(this.delayCounter.get_currentRetryDelay(),this.connectTs);this.state.s_m=111,this.state.traceState(),this.cancel_evtTransportTimeout(),this.entry_m111(d.http_error,t);break;case 150:var e=this.state.s_tr;if(e!=null)switch(e){case 220:if(this.options.sessionRecoveryTimeout==0)this.disposeHTTP(),this.notifyStatus("DISCONNECTED:WILL-RETRY"),this.cause="http.timeout",this.state.goto_m_from_session(112),this.cancel_evtTransportTimeout(),this.evtEndSession(),this.entry_m112(d.http_timeout);else{this.disposeHTTP(),this.notifyStatus("DISCONNECTED:TRYING-RECOVERY"),this.cause="http.timeout";var t=this.randomGenerator(this.options.firstRetryMaxDelay);this.state.goto_rec(),this.cancel_evtTransportTimeout(),this.entry_rec(t,d.http_timeout)}break;case 230:if(this.options.sessionRecoveryTimeout==0)this.disposeHTTP(),this.notifyStatus("DISCONNECTED:WILL-RETRY"),this.cause="ttl.timeout",this.state.goto_m_from_session(112),this.cancel_evtTransportTimeout(),this.evtEndSession(),this.entry_m112(d.http_timeout);else{this.disposeHTTP(),this.notifyStatus("DISCONNECTED:TRYING-RECOVERY"),this.cause="ttl.timeout";var t=this.randomGenerator(this.options.firstRetryMaxDelay);this.state.goto_rec(),this.cancel_evtTransportTimeout(),this.entry_rec(t,d.http_error)}break;case 240:var s=this.state.s_ws,e=s!=null?s.m:null;if(e!=null)switch(e){case 500:this.disableWS(),this.disposeWS(),this.cause="ws.unavailable",this.state.clear_ws(),this.state.s_tr=200,this.state.traceState(),this.cancel_evtTransportTimeout(),this.evtSwitchTransport();break;case 501:if(this.options.sessionRecoveryTimeout==0)this.disableWS(),this.disposeWS(),this.notifyStatus("DISCONNECTED:WILL-RETRY"),this.cause="ws.unavailable",this.state.goto_m_from_ws(112),this.exit_ws_to_m(),this.entry_m112(d.ws_unavailable);else{this.disableWS(),this.disposeWS(),this.notifyStatus("DISCONNECTED:TRYING-RECOVERY"),this.cause="ws.unavailable";var t=this.randomGenerator(this.options.firstRetryMaxDelay);this.state.goto_rec_from_ws(),this.exit_ws(),this.entry_rec(t,d.ws_unavailable)}break;case 502:if(this.options.sessionRecoveryTimeout==0)this.disposeWS(),this.notifyStatus("DISCONNECTED:WILL-RETRY"),this.cause="ws.timeout",this.state.goto_m_from_ws(112),this.exit_ws_to_m(),this.entry_m112(d.ws_timeout);else{this.disposeWS(),this.notifyStatus("DISCONNECTED:TRYING-RECOVERY"),this.cause="ws.timeout";var t=this.randomGenerator(this.options.firstRetryMaxDelay);this.state.goto_rec_from_ws(),this.exit_ws(),this.entry_rec(t,d.ws_timeout)}break}break;case 250:var s=this.state.s_wp,e=s!=null?s.m:null;if(e!=null)switch(e){case 600:case 601:this.disableWS(),this.disposeWS(),this.cause="ws.unavailable",this.state.clear_wp(),this.state.s_tr=200,this.state.traceState(),this.exit_wp(),this.evtSwitchTransport();break}break;case 260:this.state.s_rec==1001&&(this.disposeHTTP(),this.state.s_rec=1002,this.state.traceState(),this.cancel_evtTransportTimeout(),this.evtCheckRecoveryTimeout(Me.RRC_transport_timeout));break;case 270:var e=this.state.s_h;if(e!=null&&e==710){var s=this.state.s_hs,e=s!=null?s.m:null;if(e!=null)switch(e){case 800:this.disableHTTP_Streaming(),this.cause="http.streaming.unavailable",this.state.s_hs.m=801,this.state.traceState(),this.cancel_evtTransportTimeout(),this.evtForcePolling(),this.schedule_evtTransportTimeout(this.options.retryDelay);break;case 801:if(this.options.sessionRecoveryTimeout==0)this.disposeHTTP(),this.notifyStatus("DISCONNECTED:WILL-RETRY"),this.cause="http.timeout",this.state.goto_m_from_hs(112),this.exit_hs_to_m(),this.entry_m112(d.http_timeout);else{this.disposeHTTP(),this.notifyStatus("DISCONNECTED:TRYING-RECOVERY"),this.cause="http.timeout";var t=this.randomGenerator(this.options.firstRetryMaxDelay);this.state.goto_rec_from_hs(),this.exit_hs_to_rec(),this.entry_rec(t,d.http_timeout)}break}}break}break}},evtTransportError:function(){switch(this.traceEvent("transport.error"),this.state.s_m){case 120:case 121:this.suspendWS_Streaming(),this.disposeWS(),this.cause="ws.unavailable",this.state.s_m=115,this.state.traceState(),this.cancel_evtTransportTimeout(),this.evtRetry(d.ws_unavailable),this.evtRetryTimeout();break;case 122:this.disposeWS(),this.notifyStatus("DISCONNECTED:WILL-RETRY"),this.cause="ws.error";var t=this.waitingInterval(this.delayCounter.get_currentRetryDelay(),this.connectTs);this.state.s_m=112,this.state.traceState(),this.cancel_evtTransportTimeout(),this.evtRetry(d.ws_error,t),this.schedule_evtRetryTimeout(t);break;case 130:this.disposeHTTP(),this.notifyStatus("DISCONNECTED:WILL-RETRY"),this.cause="http.error";var t=this.waitingInterval(this.delayCounter.get_currentRetryDelay(),this.connectTs);this.state.s_m=112,this.state.traceState(),this.cancel_evtTransportTimeout(),this.evtRetry(d.http_error,t),this.schedule_evtRetryTimeout(t);break;case 140:this.disposeHTTP(),this.notifyStatus("DISCONNECTED:WILL-RETRY"),this.cause="ttl.error";var t=this.waitingInterval(this.delayCounter.get_currentRetryDelay(),this.connectTs);this.state.s_m=111,this.state.traceState(),this.cancel_evtTransportTimeout(),this.evtRetry(d.http_error,t),this.schedule_evtRetryTimeout(t);break;case 150:var e=this.state.s_tr;if(e!=null)switch(e){case 210:if(this.options.sessionRecoveryTimeout==0)this.disposeWS(),this.notifyStatus("DISCONNECTED:WILL-RETRY"),this.cause="ws.error",this.state.clear_w(),this.state.goto_m_from_session(113),this.exit_w(),this.evtEndSession(),this.entry_m113(d.ws_error);else{this.disposeWS(),this.notifyStatus("DISCONNECTED:TRYING-RECOVERY"),this.cause="ws.error";var t=this.randomGenerator(this.options.firstRetryMaxDelay);this.state.clear_w(),this.state.s_tr=260,this.state.s_rec=1e3,this.state.traceState(),this.exit_w(),this.entry_rec(t,d.ws_error)}break;case 220:if(this.options.sessionRecoveryTimeout==0){this.disposeHTTP(),this.notifyStatus("DISCONNECTED:WILL-RETRY"),this.cause="http.error";var t=this.waitingInterval(this.delayCounter.get_currentRetryDelay(),this.connectTs);this.state.goto_m_from_session(112),this.cancel_evtTransportTimeout(),this.evtEndSession(),this.evtRetry(d.http_error,t),this.schedule_evtRetryTimeout(t)}else{this.disposeHTTP(),this.notifyStatus("DISCONNECTED:TRYING-RECOVERY"),this.cause="http.error";var t=this.randomGenerator(this.options.firstRetryMaxDelay);this.state.goto_rec(),this.cancel_evtTransportTimeout(),this.entry_rec(t,d.http_error)}break;case 230:if(this.options.sessionRecoveryTimeout==0){this.disposeHTTP(),this.notifyStatus("DISCONNECTED:WILL-RETRY"),this.cause="ttl.error";var t=this.waitingInterval(this.delayCounter.get_currentRetryDelay(),this.connectTs);this.state.goto_m_from_session(112),this.cancel_evtTransportTimeout(),this.evtEndSession(),this.evtRetry(d.http_error,t),this.schedule_evtRetryTimeout(t)}else{this.disposeHTTP(),this.notifyStatus("DISCONNECTED:TRYING-RECOVERY"),this.cause="ttl.error";var t=this.randomGenerator(this.options.firstRetryMaxDelay);this.state.goto_rec(),this.cancel_evtTransportTimeout(),this.entry_rec(t,d.http_error)}break;case 240:switch(f.sure(this.state.s_ws).m){case 500:this.disableWS(),this.disposeWS(),this.cause="ws.unavailable",this.state.clear_ws(),this.state.s_tr=200,this.state.traceState(),this.cancel_evtTransportTimeout(),this.evtSwitchTransport();break;case 501:if(this.options.sessionRecoveryTimeout==0)this.disableWS(),this.disposeWS(),this.notifyStatus("DISCONNECTED:WILL-RETRY"),this.cause="ws.unavailable",this.state.goto_m_from_ws(112),this.exit_ws_to_m(),this.entry_m112(d.ws_unavailable);else{this.disableWS(),this.disposeWS(),this.notifyStatus("DISCONNECTED:TRYING-RECOVERY"),this.cause="ws.unavailable";var t=this.randomGenerator(this.options.firstRetryMaxDelay);this.state.goto_rec_from_ws(),this.exit_ws(),this.entry_rec(t,d.ws_unavailable)}break;case 502:if(this.options.sessionRecoveryTimeout==0)this.disposeWS(),this.notifyStatus("DISCONNECTED:WILL-RETRY"),this.cause="ws.error",this.state.goto_m_from_ws(112),this.exit_ws_to_m(),this.entry_m112(d.ws_error);else{this.disposeWS(),this.notifyStatus("DISCONNECTED:TRYING-RECOVERY"),this.cause="ws.error";var t=this.randomGenerator(this.options.firstRetryMaxDelay);this.state.goto_rec_from_ws(),this.cancel_evtTransportTimeout(),this.entry_rec(t,d.ws_error)}break;case 503:if(this.options.sessionRecoveryTimeout==0)this.disposeWS(),this.notifyStatus("DISCONNECTED:WILL-RETRY"),this.cause="ws.error",this.state.goto_m_from_ws(113),this.exit_ws_to_m(),this.entry_m113(d.ws_error);else{this.disposeWS(),this.notifyStatus("DISCONNECTED:TRYING-RECOVERY"),this.cause="ws.error";var t=this.randomGenerator(this.options.firstRetryMaxDelay);this.state.goto_rec_from_ws(),this.exit_ws(),this.entry_rec(t,d.ws_error)}break}break;case 250:switch(f.sure(this.state.s_wp).m){case 600:case 601:this.disableWS(),this.disposeWS(),this.cause="ws.unavailable",this.state.clear_wp(),this.state.s_tr=200,this.state.traceState(),this.cancel_evtTransportTimeout(),this.evtSwitchTransport();break;case 602:if(this.options.sessionRecoveryTimeout==0)this.disposeWS(),this.notifyStatus("DISCONNECTED:WILL-RETRY"),this.cause="ws.error",this.state.goto_m_from_wp(113),this.exit_wp_to_m(),this.entry_m113(d.ws_error);else{this.disposeWS(),this.notifyStatus("DISCONNECTED:TRYING-RECOVERY"),this.cause="ws.error";var t=this.randomGenerator(this.options.firstRetryMaxDelay);this.state.goto_rec_from_wp(),this.exit_wp(),this.entry_rec(t,d.ws_error)}break}break;case 260:this.state.s_rec==1001&&(this.disposeHTTP(),this.state.s_rec=1002,this.state.traceState(),this.cancel_evtTransportTimeout(),this.evtCheckRecoveryTimeout(Me.RRC_transport_error));break;case 270:switch(f.sure(this.state.s_h)){case 710:switch(f.sure(this.state.s_hs).m){case 800:case 801:if(this.options.sessionRecoveryTimeout==0)this.disposeHTTP(),this.notifyStatus("DISCONNECTED:WILL-RETRY"),this.cause="http.error",this.state.goto_m_from_hs(112),this.exit_hs_to_m(),this.entry_m112(d.http_error);else{this.disposeHTTP(),this.notifyStatus("DISCONNECTED:TRYING-RECOVERY"),this.cause="http.error";var t=this.randomGenerator(this.options.firstRetryMaxDelay);this.state.goto_rec_from_hs(),this.exit_hs_to_rec(),this.entry_rec(t,d.http_error)}break;case 802:if(this.options.sessionRecoveryTimeout==0)this.disposeHTTP(),this.notifyStatus("DISCONNECTED:WILL-RETRY"),this.cause="http.error",this.state.goto_m_from_hs(113),this.exit_hs_to_m(),this.entry_m113(d.http_error);else{this.disposeHTTP(),this.notifyStatus("DISCONNECTED:TRYING-RECOVERY"),this.cause="http.error";var t=this.randomGenerator(this.options.firstRetryMaxDelay);this.state.goto_rec_from_hs(),this.exit_hs_to_rec(),this.entry_rec(t,d.http_error)}break}break;case 720:switch(f.sure(this.state.s_hp).m){case 900:case 901:case 902:case 903:case 904:if(this.options.sessionRecoveryTimeout==0)this.disposeHTTP(),this.notifyStatus("DISCONNECTED:WILL-RETRY"),this.cause="http.error",this.state.goto_m_from_hp(112),this.exit_hp_to_m(),this.entry_m112(d.http_error);else{this.disposeHTTP(),this.notifyStatus("DISCONNECTED:TRYING-RECOVERY"),this.cause="http.error";var t=this.randomGenerator(this.options.firstRetryMaxDelay);this.state.goto_rec_from_hp(),this.exit_hp_to_rec(),this.entry_rec(t,d.http_error)}break}break}break}break}},evtIdleTimeout:function(){this.traceEvent("idle.timeout");var t,e=this.state.s_wp,s=e!=null?e.p:null;if(s==null)t=!1;else switch(s){case 610:case 611:case 613:t=!0;break;default:t=!1}if(t)if(this.options.sessionRecoveryTimeout==0)this.disposeWS(),this.notifyStatus("DISCONNECTED:WILL-RETRY"),this.cause="ws.idle.timeout",this.state.goto_m_from_wp(113),this.exit_wp_to_m(),this.entry_m113(d.idle_timeout);else{this.disposeWS(),this.notifyStatus("DISCONNECTED:TRYING-RECOVERY"),this.cause="ws.idle.timeout";var i=this.randomGenerator(this.options.firstRetryMaxDelay);this.state.goto_rec_from_wp(),this.exit_wp(),this.entry_rec(i,d.idle_timeout)}else{var t,e=this.state.s_hp,s=e!=null?e.m:null;if(s==null)t=!1;else switch(s){case 900:case 901:case 903:t=!0;break;default:t=!1}if(t)if(this.options.sessionRecoveryTimeout==0)this.disposeHTTP(),this.notifyStatus("DISCONNECTED:WILL-RETRY"),this.cause="http.idle.timeout",this.state.goto_m_from_hp(112),this.exit_hp_to_m(),this.entry_m112(d.idle_timeout);else{this.disposeHTTP(),this.notifyStatus("DISCONNECTED:TRYING-RECOVERY"),this.cause="http.idle.timeout";var i=this.randomGenerator(this.options.firstRetryMaxDelay);this.state.goto_rec_from_hp(),this.exit_hp_to_rec(),this.entry_rec(i,d.idle_timeout)}}},evtPollingTimeout:function(){this.traceEvent("polling.timeout");var t=this.state.s_wp;if((t!=null?t.p:null)==612)this.sendBindWS_Polling(),this.state.s_wp.p=613,this.state.traceState(),this.cancel_evtPollingTimeout(),this.schedule_evtIdleTimeout(U.plus(f.sure(this.idleTimeout),this.options.retryDelay));else{var t=this.state.s_hp;(t!=null?t.m:null)==902&&(this.sendBindHTTP_Polling(),this.state.s_hp.m=903,this.state.traceState(),this.cancel_evtPollingTimeout(),this.schedule_evtIdleTimeout(U.plus(f.sure(this.idleTimeout),this.options.retryDelay)))}},evtKeepaliveTimeout:function(){this.traceEvent("keepalive.timeout");var t=this.state.s_w;if((t!=null?t.k:null)==310)this.state.s_w.k=311,this.state.traceState(),this.cancel_evtKeepaliveTimeout(),this.schedule_evtStalledTimeout(this.options.stalledTimeout);else{var t=this.state.s_ws;if((t!=null?t.k:null)==520)this.state.s_ws.k=521,this.state.traceState(),this.cancel_evtKeepaliveTimeout(),this.schedule_evtStalledTimeout(this.options.stalledTimeout);else{var t=this.state.s_hs;(t!=null?t.k:null)==820&&(this.state.s_hs.k=821,this.state.traceState(),this.cancel_evtKeepaliveTimeout(),this.schedule_evtStalledTimeout(this.options.stalledTimeout))}}},evtStalledTimeout:function(){this.traceEvent("stalled.timeout");var t=this.state.s_w;if((t!=null?t.k:null)==311)this.state.s_w.k=312,this.state.traceState(),this.cancel_evtStalledTimeout(),this.schedule_evtReconnectTimeout(this.options.reconnectTimeout);else{var t=this.state.s_ws;if((t!=null?t.k:null)==521)this.state.s_ws.k=522,this.state.traceState(),this.cancel_evtStalledTimeout(),this.schedule_evtReconnectTimeout(this.options.reconnectTimeout);else{var t=this.state.s_hs;(t!=null?t.k:null)==821&&(this.state.s_hs.k=822,this.state.traceState(),this.cancel_evtStalledTimeout(),this.schedule_evtReconnectTimeout(this.options.reconnectTimeout))}}},evtReconnectTimeout:function(){this.traceEvent("reconnect.timeout");var t=this.state.s_w;if((t!=null?t.k:null)==312)if(this.options.sessionRecoveryTimeout==0)this.disposeWS(),this.notifyStatus("DISCONNECTED:WILL-RETRY"),this.cause="ws.stalled",this.state.goto_m_from_w(113),this.exit_w_to_m(),this.entry_m113(d.stalled_timeout);else{this.disposeWS(),this.notifyStatus("DISCONNECTED:TRYING-RECOVERY"),this.cause="ws.stalled";var e=this.randomGenerator(this.options.firstRetryMaxDelay);this.state.goto_rec_from_w(),this.exit_w(),this.entry_rec(e,d.stalled_timeout)}else{var t=this.state.s_ws;if((t!=null?t.k:null)==522)if(this.options.sessionRecoveryTimeout==0)this.disposeWS(),this.notifyStatus("DISCONNECTED:WILL-RETRY"),this.cause="ws.stalled",this.state.goto_m_from_ws(113),this.exit_ws_to_m(),this.entry_m113(d.stalled_timeout);else{this.disposeWS(),this.notifyStatus("DISCONNECTED:TRYING-RECOVERY"),this.cause="ws.stalled";var e=this.randomGenerator(this.options.firstRetryMaxDelay);this.state.goto_rec_from_ws(),this.exit_ws(),this.entry_rec(e,d.stalled_timeout)}else{var t=this.state.s_hs;if((t!=null?t.k:null)==822)if(this.options.sessionRecoveryTimeout==0)this.disposeHTTP(),this.notifyStatus("DISCONNECTED:WILL-RETRY"),this.cause="http.stalled",this.state.goto_m_from_hs(113),this.exit_hs_to_m(),this.entry_m113(d.stalled_timeout);else{this.disposeHTTP(),this.notifyStatus("DISCONNECTED:TRYING-RECOVERY"),this.cause="http.stalled";var e=this.randomGenerator(this.options.firstRetryMaxDelay);this.state.goto_rec_from_hs(),this.exit_hs_to_rec(),this.entry_rec(e,d.stalled_timeout)}}}},evtRestartKeepalive:function(){this.traceEvent("restart.keepalive");var t=this.state.s_w;if((t!=null?t.k:null)!=null)this.state.s_w.k=310,this.state.traceState(),this.exit_keepalive_unit(),this.schedule_evtKeepaliveTimeout(f.sure(this.keepaliveInterval));else{var t=this.state.s_ws;if((t!=null?t.k:null)!=null)this.state.s_ws.k=520,this.state.traceState(),this.exit_keepalive_unit(),this.schedule_evtKeepaliveTimeout(f.sure(this.keepaliveInterval));else{var t=this.state.s_hs;(t!=null?t.k:null)!=null&&(this.state.s_hs.k=820,this.state.traceState(),this.exit_keepalive_unit(),this.schedule_evtKeepaliveTimeout(f.sure(this.keepaliveInterval)))}}},evtWSOK:function(){switch(this.traceEvent("WSOK"),m.isDebugEnabled()&&m.debug("WSOK"),this.state.s_m){case 121:this.state.s_m=122,this.state.traceState();break;case 150:var t=this.state.s_tr;if(t!=null)switch(t){case 240:var e=this.state.s_ws,t=e!=null?e.m:null;t!=null&&t==501&&(this.state.s_ws.m=502,this.state.traceState());break;case 250:var e=this.state.s_wp,t=e!=null?e.m:null;t!=null&&t==601&&(this.sendBindWS_FirstPolling(),this.state.s_wp.m=602,this.state.s_wp.p=610,this.state.s_wp.c=620,this.state.s_wp.s=630,this.state.traceState(),this.cancel_evtTransportTimeout(),this.evtSendPendingControls(),this.evtSendPendingMessages(),this.schedule_evtIdleTimeout(U.plus(f.sure(this.idleTimeout),this.options.retryDelay)));break}break}},evtCONERR:function(t,e){this.traceEvent("CONERR"),m.isDebugEnabled()&&m.debug("CONERR "+t+" "+e);var s=d.standardError(t,e),i=ut.TC_standardError(t,e);if(this.state.s_m==122)switch(t){case 5:this.disposeWS(),this.notifyStatus("DISCONNECTED:WILL-RETRY"),this.cause="ws.conerr."+t,this.state.s_m=110,this.state.traceState(),this.cancel_evtTransportTimeout(),this.evtRetry(s),this.evtRetryTimeout();break;case 4:case 6:case 20:case 40:case 41:case 48:this.disposeWS(),this.notifyStatus("DISCONNECTED:WILL-RETRY"),this.cause="ws.conerr."+t;var n=this.waitingInterval(this.delayCounter.get_currentRetryDelay(),this.connectTs);this.state.s_m=112,this.state.traceState(),this.cancel_evtTransportTimeout(),this.evtRetry(s,n),this.schedule_evtRetryTimeout(n);break;default:this.disposeWS(),this.notifyStatus("DISCONNECTED"),this.notifyServerError_CONERR(t,e),this.state.s_m=100,this.state.traceState(),this.cancel_evtTransportTimeout(),this.evtTerminate(i)}else if(this.state.s_m==130)switch(t){case 5:this.disposeHTTP(),this.notifyStatus("DISCONNECTED:WILL-RETRY"),this.cause="http.conerr."+t,this.state.s_m=110,this.state.traceState(),this.cancel_evtTransportTimeout(),this.evtRetry(s),this.evtRetryTimeout();break;case 4:case 6:case 20:case 40:case 41:case 48:this.disposeHTTP(),this.notifyStatus("DISCONNECTED:WILL-RETRY"),this.cause="http.conerr."+t;var n=this.waitingInterval(this.delayCounter.get_currentRetryDelay(),this.connectTs);this.state.s_m=112,this.state.traceState(),this.cancel_evtTransportTimeout(),this.evtRetry(s,n),this.schedule_evtRetryTimeout(n);break;default:this.disposeHTTP(),this.notifyStatus("DISCONNECTED"),this.notifyServerError_CONERR(t,e),this.state.s_m=100,this.state.traceState(),this.cancel_evtTransportTimeout(),this.evtTerminate(i)}else if(this.state.s_m==140)switch(t){case 5:this.disposeHTTP(),this.notifyStatus("DISCONNECTED:WILL-RETRY"),this.cause="ttl.conerr."+t,this.state.s_m=110,this.state.traceState(),this.cancel_evtTransportTimeout(),this.evtRetry(s),this.evtRetryTimeout();break;case 4:case 6:case 20:case 40:case 41:case 48:this.disposeHTTP(),this.notifyStatus("DISCONNECTED:WILL-RETRY"),this.cause="ttl.conerr."+t;var n=this.waitingInterval(this.delayCounter.get_currentRetryDelay(),this.connectTs);this.state.s_m=112,this.state.traceState(),this.cancel_evtTransportTimeout(),this.evtRetry(s,n),this.schedule_evtRetryTimeout(n);break;default:this.disposeHTTP(),this.notifyStatus("DISCONNECTED"),this.notifyServerError_CONERR(t,e),this.state.s_m=100,this.state.traceState(),this.cancel_evtTransportTimeout(),this.evtTerminate(i)}else{var r=this.state.s_ws;if((r!=null?r.m:null)==502)switch(t){case 4:case 6:case 20:case 40:case 41:case 48:this.disposeWS(),this.notifyStatus("DISCONNECTED:WILL-RETRY"),this.cause="ws.conerr."+t,this.state.goto_m_from_ws(112),this.exit_ws_to_m(),this.entry_m112(d.standardError(t,e));break;default:this.disposeWS(),this.notifyStatus("DISCONNECTED"),this.notifyServerError_CONERR(t,e),this.state.goto_m_from_ws(100),this.exit_ws_to_m(),this.evtTerminate(i)}else{var r,o=this.state.s_wp;if((o!=null?o.p:null)!=610){var o=this.state.s_wp;r=(o!=null?o.p:null)==613}else r=!0;if(r)switch(t){case 4:case 6:case 20:case 40:case 41:case 48:this.disposeWS(),this.notifyStatus("DISCONNECTED:WILL-RETRY"),this.cause="ws.conerr."+t,this.state.goto_m_from_wp(112),this.exit_wp_to_m(),this.entry_m112(d.standardError(t,e));break;default:this.disposeWS(),this.notifyStatus("DISCONNECTED"),this.notifyServerError_CONERR(t,e),this.state.goto_m_from_wp(100),this.exit_wp_to_m(),this.evtTerminate(i)}else{var r,o=this.state.s_hs;if((o!=null?o.m:null)!=800){var o=this.state.s_hs;r=(o!=null?o.m:null)==801}else r=!0;if(r)switch(t){case 4:case 6:case 20:case 40:case 41:case 48:this.disposeHTTP(),this.notifyStatus("DISCONNECTED:WILL-RETRY"),this.cause="http.conerr."+t,this.state.goto_m_from_hs(112),this.exit_hs_to_m(),this.entry_m112(d.standardError(t,e));break;default:this.disposeHTTP(),this.notifyStatus("DISCONNECTED"),this.notifyServerError_CONERR(t,e),this.state.goto_m_from_hs(100),this.exit_hs_to_m(),this.evtTerminate(i)}else{var r,o=this.state.s_hp;if((o!=null?o.m:null)!=900){var o=this.state.s_hp;r=(o!=null?o.m:null)==903}else r=!0;if(r)switch(t){case 4:case 6:case 20:case 40:case 41:case 48:this.disposeHTTP(),this.notifyStatus("DISCONNECTED:WILL-RETRY"),this.cause="http.conerr."+t,this.state.goto_m_from_hp(112),this.exit_hp_to_m(),this.entry_m112(d.standardError(t,e));break;default:this.disposeHTTP(),this.notifyStatus("DISCONNECTED"),this.notifyServerError_CONERR(t,e),this.state.goto_m_from_hp(100),this.exit_hp_to_m(),this.evtTerminate(i)}else if(this.state.s_rec==1001)switch(t){case 4:case 6:case 20:case 40:case 41:case 48:this.disposeHTTP(),this.notifyStatus("DISCONNECTED:WILL-RETRY"),this.cause="recovery.conerr."+t,this.state.goto_m_from_rec(113),this.exit_rec_to_m(),this.entry_m113(s);break;default:this.disposeHTTP(),this.notifyStatus("DISCONNECTED"),this.notifyServerError_CONERR(t,e),this.state.goto_m_from_rec(100),this.exit_rec_to_m(),this.evtTerminate(i)}}}}}},evtEND:function(t,e){this.traceEvent("END"),m.isDebugEnabled()&&m.debug("END "+t+" "+e);var s=d.standardError(t,e),i=ut.TC_standardError(t,e),n=this.state.s_w;if((n!=null?n.p:null)==300)switch(t){case 41:case 48:this.disposeWS(),this.notifyStatus("DISCONNECTED:WILL-RETRY"),this.cause="ws.end."+t;var r=this.randomGenerator(this.options.firstRetryMaxDelay);this.state.clear_w(),this.state.goto_m_from_session(113),this.exit_w(),this.evtEndSession(),this.evtRetry(d.standardError(t,e),r),this.schedule_evtRetryTimeout(r);break;default:this.disposeWS(),this.notifyStatus("DISCONNECTED"),this.notifyServerError_END(t,e),this.state.clear_w(),this.state.goto_m_from_session(100),this.exit_w(),this.evtEndSession(),this.evtTerminate(i)}else{var n=this.state.s_ws;if((n!=null?n.m:null)==502)switch(t){case 41:case 48:this.disposeWS(),this.notifyStatus("DISCONNECTED:WILL-RETRY"),this.cause="ws.end."+t,this.state.goto_m_from_ws(112),this.exit_ws_to_m(),this.entry_m112(d.standardError(t,e));break;default:this.disposeWS(),this.notifyStatus("DISCONNECTED"),this.notifyServerError_END(t,e),this.state.goto_m_from_ws(100),this.exit_ws_to_m(),this.evtTerminate(i)}else{var n=this.state.s_ws;if((n!=null?n.p:null)==510)switch(t){case 41:case 48:this.disposeWS(),this.notifyStatus("DISCONNECTED:WILL-RETRY"),this.cause="ws.end."+t,this.state.goto_m_from_ws(113),this.exit_ws_to_m(),this.entry_m113(s);break;default:this.disposeWS(),this.notifyStatus("DISCONNECTED"),this.notifyServerError_END(t,e),this.state.goto_m_from_ws(100),this.exit_ws_to_m(),this.evtTerminate(i)}else{var n,o=this.state.s_wp;if((o!=null?o.p:null)!=610){var o=this.state.s_wp;n=(o!=null?o.p:null)==613}else n=!0;if(n)switch(t){case 41:case 48:this.disposeWS(),this.notifyStatus("DISCONNECTED:WILL-RETRY"),this.cause="ws.end."+t,this.state.goto_m_from_wp(112),this.exit_wp_to_m(),this.entry_m112(d.standardError(t,e));break;default:this.disposeWS(),this.notifyStatus("DISCONNECTED"),this.notifyServerError_END(t,e),this.state.goto_m_from_wp(100),this.exit_wp_to_m(),this.evtTerminate(i)}else{var n=this.state.s_wp;if((n!=null?n.p:null)==611)switch(t){case 41:case 48:this.disposeWS(),this.notifyStatus("DISCONNECTED:WILL-RETRY"),this.cause="ws.end."+t,this.state.goto_m_from_wp(113),this.exit_wp_to_m(),this.entry_m113(s);break;default:this.disposeWS(),this.notifyStatus("DISCONNECTED"),this.notifyServerError_END(t,e),this.state.goto_m_from_wp(100),this.exit_wp_to_m(),this.evtTerminate(i)}else{var n,o=this.state.s_hs;if((o!=null?o.m:null)!=800){var o=this.state.s_hs;n=(o!=null?o.m:null)==801}else n=!0;if(n)switch(t){case 41:case 48:this.disposeHTTP(),this.notifyStatus("DISCONNECTED:WILL-RETRY"),this.cause="http.end."+t,this.state.goto_m_from_hs(112),this.exit_hs_to_m(),this.entry_m112(d.standardError(t,e));break;default:this.disposeHTTP(),this.notifyStatus("DISCONNECTED"),this.notifyServerError_END(t,e),this.state.goto_m_from_hs(100),this.exit_hs_to_m(),this.evtTerminate(i)}else{var n=this.state.s_hs;if((n!=null?n.p:null)==810)switch(t){case 41:case 48:this.disposeHTTP(),this.notifyStatus("DISCONNECTED:WILL-RETRY"),this.cause="http.end."+t,this.state.goto_m_from_hs(113),this.exit_hs_to_m(),this.entry_m113(s);break;default:this.disposeHTTP(),this.notifyStatus("DISCONNECTED"),this.notifyServerError_END(t,e),this.state.goto_m_from_hs(100),this.exit_hs_to_m(),this.evtTerminate(i)}else{var n,o=this.state.s_hp;if((o!=null?o.m:null)!=900){var o=this.state.s_hp;n=(o!=null?o.m:null)==903}else n=!0;if(n)switch(t){case 41:case 48:this.disposeHTTP(),this.notifyStatus("DISCONNECTED:WILL-RETRY"),this.cause="http.end."+t,this.state.goto_m_from_hp(112),this.exit_hp_to_m(),this.entry_m112(d.standardError(t,e));break;default:this.disposeHTTP(),this.notifyStatus("DISCONNECTED"),this.notifyServerError_END(t,e),this.state.goto_m_from_hp(100),this.exit_hp_to_m(),this.evtTerminate(i)}else{var n=this.state.s_hp;if((n!=null?n.m:null)==901)switch(t){case 41:case 48:this.disposeHTTP(),this.notifyStatus("DISCONNECTED:WILL-RETRY"),this.cause="http.end."+t,this.state.goto_m_from_hp(113),this.exit_hp_to_m(),this.entry_m113(s);break;default:this.disposeHTTP(),this.notifyStatus("DISCONNECTED"),this.notifyServerError_END(t,e),this.state.goto_m_from_hp(100),this.exit_hp_to_m(),this.evtTerminate(i)}else if(this.state.s_rec==1001)switch(t){case 41:case 48:this.disposeHTTP(),this.notifyStatus("DISCONNECTED:WILL-RETRY"),this.cause="recovery.end."+t,this.state.goto_m_from_rec(113),this.exit_rec_to_m(),this.entry_m113(s);break;default:this.disposeHTTP(),this.notifyStatus("DISCONNECTED"),this.notifyServerError_END(t,e),this.state.goto_m_from_rec(100),this.exit_rec_to_m(),this.evtTerminate(i)}}}}}}}}}},evtERROR:function(t,e){this.traceEvent("ERROR"),m.isDebugEnabled()&&m.debug("ERROR "+t+" "+e);var s=ut.TC_standardError(t,e),i=this.state.s_w;if((i!=null?i.p:null)==300)this.disposeWS(),this.notifyStatus("DISCONNECTED"),this.notifyServerError_ERROR(t,e),this.state.clear_w(),this.state.goto_m_from_session(100),this.exit_w(),this.evtEndSession(),this.evtTerminate(s);else{var i=this.state.s_ws;if((i!=null?i.p:null)==510)this.disposeWS(),this.notifyStatus("DISCONNECTED"),this.notifyServerError_ERROR(t,e),this.state.goto_m_from_ws(100),this.exit_ws_to_m(),this.evtTerminate(s);else{var i=this.state.s_wp;(i!=null?i.c:null)==620?(this.disposeWS(),this.notifyStatus("DISCONNECTED"),this.notifyServerError_ERROR(t,e),this.state.goto_m_from_wp(100),this.exit_wp_to_m(),this.evtTerminate(s)):this.state.s_ctrl==1102&&(this.disposeHTTP(),this.notifyStatus("DISCONNECTED"),this.notifyServerError_ERROR(t,e),this.state.goto_m_from_ctrl(100),this.exit_ctrl_to_m(),this.evtTerminate(s))}}},evtREQOK_withoutReqId:function(){this.traceEvent("REQOK"),m.isDebugEnabled()&&m.debug("REQOK"),this.state.s_ctrl==1102&&(this.state.s_ctrl=1102,this.state.traceState())},evtREQOK:function(t){this.traceEvent("REQOK"),m.isDebugEnabled()&&m.debug("REQOK "+t);var e=!0;this.state.s_swt==1302&&t==this.swt_lastReqId?(this.state.s_swt=1303,this.state.traceState(),e=this.evtREQOK_TransportRegion(t)):this.state.s_bw==1202&&t==this.bw_lastReqId?(this.state.s_bw=1200,this.state.traceState(),e=this.evtREQOK_TransportRegion(t),this.evtCheckBW()):e=this.evtREQOK_Forward(t),e&&this.evtREQOK_TransportRegion(t)},evtREQOK_Forward:function(t){return!0},evtREQOK_TransportRegion:function(t){var e=this.state.s_w;if((e!=null?e.p:null)==300)this.state.s_w.p=300,this.state.traceState(),this.doREQOK(t),this.evtRestartKeepalive();else{var e=this.state.s_ws;if((e!=null?e.p:null)==510)this.state.s_ws.p=510,this.state.traceState(),this.doREQOK(t),this.evtRestartKeepalive();else{var e=this.state.s_wp;(e!=null?e.c:null)==620?(this.state.s_wp.c=620,this.state.traceState(),this.doREQOK(t)):this.state.s_ctrl==1102&&(this.state.s_ctrl=1102,this.state.traceState(),this.doREQOK(t))}}return!1},evtREQERR:function(t,e,s){this.traceEvent("REQERR"),m.isDebugEnabled()&&m.debug("REQERR "+t+" "+e+" "+s);var i=!0;this.state.s_swt==1302&&t==this.swt_lastReqId?(this.state.s_swt=1301,this.state.traceState(),i=this.evtREQERR_TransportRegion(t,e,s)):this.state.s_bw==1202&&t==this.bw_lastReqId?(this.state.s_bw=1200,this.state.traceState(),i=this.evtREQERR_TransportRegion(t,e,s),this.evtCheckBW()):i=this.evtREQERR_Forward(t,e,s),i&&this.evtREQERR_TransportRegion(t,e,s)},evtREQERR_Forward:function(t,e,s){return!0},evtREQERR_TransportRegion:function(t,e,s){var i=d.standardError(e,s),n=ut.TC_standardError(e,s),r=this.state.s_w;if((r!=null?r.p:null)==300)switch(e){case 20:this.disposeWS(),this.notifyStatus("DISCONNECTED:WILL-RETRY"),this.cause="ws.reqerr."+e;var o=this.randomGenerator(this.options.firstRetryMaxDelay);this.state.clear_w(),this.state.goto_m_from_session(113),this.exit_w(),this.evtEndSession(),this.evtRetry(d.standardError(e,s),o),this.schedule_evtRetryTimeout(o);break;case 11:case 65:case 67:this.disposeWS(),this.notifyStatus("DISCONNECTED"),this.notifyServerError_REQERR(e,s),this.state.clear_w(),this.state.goto_m_from_session(100),this.exit_w(),this.evtEndSession(),this.evtTerminate(n);break;default:this.state.s_w.p=300,this.state.traceState(),this.doREQERR(t,e,s),this.evtRestartKeepalive()}else{var r=this.state.s_ws;if((r!=null?r.p:null)==510)switch(e){case 20:this.disposeWS(),this.notifyStatus("DISCONNECTED:WILL-RETRY"),this.cause="ws.reqerr."+e+")",this.state.goto_m_from_ws(113),this.exit_ws_to_m(),this.entry_m113(i);break;case 11:case 65:case 67:this.disposeWS(),this.notifyStatus("DISCONNECTED"),this.notifyServerError_REQERR(e,s),this.state.goto_m_from_ws(100),this.exit_ws_to_m(),this.evtTerminate(n);break;default:this.state.s_ws.p=510,this.state.traceState(),this.doREQERR(t,e,s),this.evtRestartKeepalive()}else{var r=this.state.s_wp;if((r!=null?r.c:null)==620)switch(e){case 20:this.disposeWS(),this.notifyStatus("DISCONNECTED:WILL-RETRY"),this.cause="ws.reqerr."+e,this.state.goto_m_from_wp(113),this.exit_wp_to_m(),this.entry_m113(i);break;case 11:case 65:case 67:this.disposeWS(),this.notifyStatus("DISCONNECTED"),this.notifyServerError_REQERR(e,s),this.state.goto_m_from_wp(100),this.exit_wp_to_m(),this.evtTerminate(n);break;default:this.state.s_wp.c=620,this.state.traceState(),this.doREQERR(t,e,s)}else if(this.state.s_ctrl==1102)switch(e){case 20:this.disposeHTTP(),this.notifyStatus("DISCONNECTED:WILL-RETRY"),this.cause="http.reqerr."+e,this.state.goto_m_from_ctrl(113),this.exit_ctrl_to_m(),this.entry_m113(i);break;case 11:case 65:case 67:this.disposeHTTP(),this.notifyStatus("DISCONNECTED"),this.notifyServerError_REQERR(e,s),this.state.goto_m_from_ctrl(100),this.exit_ctrl_to_m(),this.evtTerminate(n);break;default:this.state.s_ctrl=1102,this.state.traceState(),this.doREQERR(t,e,s)}}}return!1},evtPROG:function(t){this.traceEvent("PROG");var e=d.prog_mismatch(this.rec_serverProg,t);m.isDebugEnabled()&&m.debug("PROG "+t);var s=this.state.s_w;if((s!=null?s.p:null)==300)t!=this.rec_serverProg?(this.disposeWS(),this.notifyStatus("DISCONNECTED:WILL-RETRY"),this.cause="prog.mismatch."+t+"."+this.rec_serverProg,this.state.clear_w(),this.state.goto_m_from_session(113),this.exit_w(),this.evtEndSession(),this.entry_m113(e)):(this.state.s_w.p=300,this.state.traceState(),this.evtRestartKeepalive());else if(this.state.s_tr==220)t!=this.rec_serverProg?(this.disposeHTTP(),this.notifyStatus("DISCONNECTED:WILL-RETRY"),this.cause="prog.mismatch."+t+"."+this.rec_serverProg,this.state.goto_m_from_session(113),this.cancel_evtTransportTimeout(),this.evtEndSession(),this.entry_m113(e)):(this.state.s_tr=220,this.state.traceState());else if(this.state.s_tr==230)t!=this.rec_serverProg?(this.disposeHTTP(),this.notifyStatus("DISCONNECTED:WILL-RETRY"),this.cause="prog.mismatch."+t+"."+this.rec_serverProg,this.state.goto_m_from_session(113),this.cancel_evtTransportTimeout(),this.evtEndSession(),this.entry_m113(e)):(this.state.s_tr=230,this.state.traceState());else{var s=this.state.s_ws;if((s!=null?s.p:null)==510)t!=this.rec_serverProg?(this.disposeWS(),this.notifyStatus("DISCONNECTED:WILL-RETRY"),this.cause="prog.mismatch."+t+"."+this.rec_serverProg,this.state.goto_m_from_ws(113),this.exit_ws_to_m(),this.entry_m113(e)):(this.state.s_ws.p=510,this.state.traceState(),this.evtRestartKeepalive());else{var s=this.state.s_wp;if((s!=null?s.p:null)==611)t!=this.rec_serverProg?(this.disposeWS(),this.notifyStatus("DISCONNECTED:WILL-RETRY"),this.cause="prog.mismatch."+t+"."+this.rec_serverProg,this.state.goto_m_from_wp(113),this.exit_wp_to_m(),this.entry_m113(e)):(this.state.s_wp.p=611,this.state.traceState());else{var s=this.state.s_hs;if((s!=null?s.p:null)==810)t!=this.rec_serverProg?(this.disposeHTTP(),this.notifyStatus("DISCONNECTED:WILL-RETRY"),this.cause="prog.mismatch."+t+"."+this.rec_serverProg,this.state.goto_m_from_hs(113),this.exit_hs_to_m(),this.entry_m113(e)):(this.state.s_hs.p=810,this.state.traceState(),this.evtRestartKeepalive());else{var s=this.state.s_hp;(s!=null?s.m:null)==901?t!=this.rec_serverProg?(this.disposeHTTP(),this.notifyStatus("DISCONNECTED:WILL-RETRY"),this.cause="prog.mismatch."+t+"."+this.rec_serverProg,this.state.goto_m_from_hp(113),this.exit_hp_to_m(),this.entry_m113(e)):(this.state.s_hp.m=901,this.state.traceState()):this.state.s_rec==1001&&(t>this.rec_clientProg?(this.disposeHTTP(),this.notifyStatus("DISCONNECTED:WILL-RETRY"),this.cause="prog.mismatch."+t+"."+this.rec_serverProg,this.state.goto_m_from_rec(113),this.exit_rec_to_m(),this.entry_m113(e)):(this.state.s_rec=1001,this.state.traceState(),this.doPROG(t)))}}}}},evtLOOP:function(t){this.traceEvent("LOOP"),m.isDebugEnabled()&&m.debug("LOOP "+t);var e=this.state.s_w;if((e!=null?e.p:null)==300)this.closeWS(),this.cause="ws.loop",this.state.clear_w(),this.state.s_tr=200,this.state.traceState(),this.exit_w(),this.evtSwitchTransport();else if(this.state.s_tr==220)this.closeHTTP(),this.cause="http.loop",this.state.s_tr=200,this.state.traceState(),this.cancel_evtTransportTimeout(),this.evtSwitchTransport();else if(this.state.s_tr==230)this.closeHTTP(),this.cause="ttl.loop",this.state.s_tr=200,this.state.traceState(),this.cancel_evtTransportTimeout(),this.evtSwitchTransport();else{var e=this.state.s_ws;if((e!=null?e.p:null)==510)this.closeWS(),this.cause="ws.loop",this.state.clear_ws(),this.state.s_tr=200,this.state.traceState(),this.exit_ws(),this.evtSwitchTransport();else{var e=this.state.s_wp;if((e!=null?e.p:null)==611)this.isSwitching()?(this.closeWS(),this.cause="ws.loop",this.state.clear_wp(),this.state.s_tr=200,this.state.traceState(),this.exit_wp(),this.evtSwitchTransport()):(this.doLOOP(t),this.state.s_wp.p=612,this.state.traceState(),this.cancel_evtIdleTimeout(),this.schedule_evtPollingTimeout(this.options.pollingInterval));else{var e=this.state.s_hs;if((e!=null?e.p:null)==810)this.closeHTTP(),this.cause="http.loop",this.state.s_hs.p=811,this.state.traceState(),this.evtSwitchTransport();else{var e=this.state.s_hp;(e!=null?e.m:null)==901?this.isSwitching()?(this.closeHTTP(),this.state.s_hp.m=904,this.state.traceState(),this.cancel_evtIdleTimeout(),this.evtSwitchTransport()):(this.doLOOP(t),this.closeHTTP(),this.state.s_hp.m=902,this.state.traceState(),this.cancel_evtIdleTimeout(),this.schedule_evtPollingTimeout(this.options.pollingInterval)):this.state.s_rec==1001&&(this.closeHTTP(),this.cause="recovery.loop",this.state.goto_200_from_rec(),this.exit_rec(),this.evtSwitchTransport())}}}}},evtCONOK:function(t,e,s,i){if(this.traceEvent("CONOK"),m.isDebugEnabled()&&m.debug("CONOK "+t+" "+e+" "+s+" "+i),this.state.s_m==122)this.doCONOK_CreateWS(t,e,s,i),this.resetCurrentRetryDelay(),this.notifyStatus("CONNECTED:WS-STREAMING"),this.state.s_m=150,this.state.s_tr=210,this.state.s_w=new ms(300,310,340),this.state.s_rhb=320,this.state.s_slw=330,this.state.s_swt=1300,this.state.s_bw=1200,this.state.traceState(),this.cancel_evtTransportTimeout(),this.evtSendPendingControls(),this.evtSendPendingMessages(),this.evtStartSession(),this.schedule_evtKeepaliveTimeout(f.sure(this.keepaliveInterval)),this.evtSelectRhb(),this.evtCheckTransport(),this.evtCheckBW();else if(this.state.s_m==130)this.doCONOK_CreateHTTP(t,e,s,i),this.resetCurrentRetryDelay(),this.notifyStatus("CONNECTED:STREAM-SENSING"),this.state.s_m=150,this.state.s_tr=220,this.state.s_swt=1300,this.state.s_bw=1200,this.state.traceState(),this.cancel_evtTransportTimeout(),this.evtStartSession(),this.schedule_evtTransportTimeout(this.options.retryDelay),this.evtCheckTransport(),this.evtCheckBW();else if(this.state.s_m==140)this.doCONOK_CreateHTTP(t,e,s,i),this.resetCurrentRetryDelay(),this.notifyStatus("CONNECTED:STREAM-SENSING"),this.state.s_m=150,this.state.s_tr=230,this.state.s_swt=1300,this.state.s_bw=1200,this.state.traceState(),this.cancel_evtTransportTimeout(),this.evtStartSession(),this.schedule_evtTransportTimeout(this.options.retryDelay),this.evtCheckTransport(),this.evtCheckBW();else{var n=this.state.s_ws;if((n!=null?n.m:null)==502)this.doCONOK_BindWS_Streaming(t,e,s,i),this.notifyStatus("CONNECTED:WS-STREAMING"),this.state.s_ws.m=503,this.state.s_ws.p=510,this.state.s_ws.k=520,this.state.s_ws.s=550,this.state.s_rhb=320,this.state.s_slw=330,this.state.traceState(),this.cancel_evtTransportTimeout(),this.evtSendPendingControls(),this.evtSendPendingMessages(),this.schedule_evtKeepaliveTimeout(f.sure(this.keepaliveInterval)),this.evtSelectRhb();else{var n=this.state.s_wp;if((n!=null?n.p:null)==610)this.doCONOK_BindWS_Polling(t,e,s,i),this.notifyStatus("CONNECTED:WS-POLLING"),this.state.s_wp.p=611,this.state.traceState();else{var n=this.state.s_wp;if((n!=null?n.p:null)==613)this.doCONOK_BindWS_Polling(t,e,s,i),this.state.s_wp.p=611,this.state.traceState();else{var n=this.state.s_hs;if((n!=null?n.m:null)==800)this.doCONOK_BindHTTP_Streaming(t,e,s,i),this.notifyStatus("CONNECTED:HTTP-STREAMING"),this.state.s_hs.m=802,this.state.s_hs.p=810,this.state.s_hs.k=820,this.state.s_rhb=320,this.state.s_slw=330,this.state.traceState(),this.cancel_evtTransportTimeout(),this.schedule_evtKeepaliveTimeout(f.sure(this.keepaliveInterval)),this.evtSelectRhb();else{var n=this.state.s_hs;if((n!=null?n.m:null)==801)this.doCONOK_BindHTTP_Streaming(t,e,s,i),this.notifyStatus("CONNECTED:HTTP-STREAMING"),this.state.s_hs.m=802,this.state.s_hs.p=810,this.state.s_hs.k=820,this.state.s_rhb=320,this.state.s_slw=330,this.state.traceState(),this.cancel_evtTransportTimeout(),this.schedule_evtKeepaliveTimeout(f.sure(this.keepaliveInterval)),this.evtSelectRhb();else{var n=this.state.s_hp;if((n!=null?n.m:null)==900)this.doCONOK_BindHTTP_Polling(t,e,s,i),this.notifyStatus("CONNECTED:HTTP-POLLING"),this.state.s_hp.m=901,this.state.traceState();else{var n=this.state.s_hp;(n!=null?n.m:null)==903&&(this.doCONOK_BindHTTP_Polling(t,e,s,i),this.state.s_hp.m=901,this.state.traceState())}}}}}}}},evtSERVNAME:function(t){this.traceEvent("SERVNAME"),m.isDebugEnabled()&&m.debug("SERVNAME "+t),this.state.inPushing()&&(this.doSERVNAME(t),this.state.inStreaming()&&this.evtRestartKeepalive())},evtCLIENTIP:function(t){this.traceEvent("CLIENTIP"),m.isDebugEnabled()&&m.debug("CLIENTIP "+t),this.state.inPushing()&&(this.doCLIENTIP(t),this.state.inStreaming()&&this.evtRestartKeepalive())},evtCONS:function(t){this.traceEvent("CONS"),m.isDebugEnabled()&&m.debug("CONS "+c.string(t)),this.state.inPushing()&&(this.doCONS(t),this.state.inStreaming()&&this.evtRestartKeepalive())},evtPROBE:function(){this.traceEvent("PROBE"),m.isDebugEnabled()&&m.debug("PROBE"),this.clientEventDispatcher.onServerKeepalive(),this.state.inPushing()&&this.state.inStreaming()&&this.evtRestartKeepalive()},evtNOOP:function(){this.traceEvent("NOOP"),this.state.inPushing()&&this.state.inStreaming()&&this.evtRestartKeepalive()},evtSYNC:function(t){this.traceEvent("SYNC"),m.isDebugEnabled()&&m.debug("SYNC "+t);var e=!0,s,i,n=this.state.s_w;if((n!=null?n.p:null)!=300){var n=this.state.s_ws;i=(n!=null?n.p:null)==510}else i=!0;if(i)s=!0;else{var i=this.state.s_hs;s=(i!=null?i.p:null)==810}if(s)e=this.evtSYNC_PushingRegion(t),this.evtRestartKeepalive();else{var s,i;if(this.state.s_tr==220||this.state.s_tr==230)i=!0;else{var n=this.state.s_wp;i=(n!=null?n.p:null)==611}if(i)s=!0;else{var i=this.state.s_hp;s=(i!=null?i.m:null)==901}(s||this.state.s_rec==1001)&&(e=this.evtSYNC_PushingRegion(t))}e&&this.evtSYNC_PushingRegion(t)},evtSYNC_PushingRegion:function(t){var e=t*1e3;if(this.state.s_slw!=null){var s=this.state.s_slw;if(s!=null)switch(s){case 330:this.doSYNC(e),this.state.s_slw=331,this.state.traceState();break;case 331:var i=this.doSYNC_G(e);this.state.s_slw=332,this.state.traceState(),this.evtCheckAvg(i);break;case 333:var i=this.doSYNC_NG(e);this.state.s_slw=332,this.state.traceState(),this.evtCheckAvg(i);break}}return!1},evtMSGDONE:function(t,e,s){this.traceEvent("MSGDONE"),m.isDebugEnabled()&&m.debug("MSGDONE "+t+" "+e+" "+s),this.state.inPushing()&&(this.isFreshData()?(this.doMSGDONE(t,e,s),this.state.inStreaming()&&this.evtRestartKeepalive()):(this.onStaleData(),this.state.inStreaming()&&this.evtRestartKeepalive()))},evtMSGFAIL:function(t,e,s,i){this.traceEvent("MSGFAIL"),m.isDebugEnabled()&&m.debug("MSGFAIL "+t+" "+e+" "+s+" "+i),this.state.inPushing()&&(this.isFreshData()?(this.doMSGFAIL(t,e,s,i),this.state.inStreaming()&&this.evtRestartKeepalive()):(this.onStaleData(),this.state.inStreaming()&&this.evtRestartKeepalive()))},evtU:function(t,e,s,i){this.traceEvent("U"),m.isDebugEnabled()&&m.debug(""+i),this.state.inPushing()&&(this.isFreshData()?(this.doU(t,e,s),this.state.inStreaming()&&this.evtRestartKeepalive()):(this.onStaleData(),this.state.inStreaming()&&this.evtRestartKeepalive()))},evtSUBOK:function(t,e,s){this.traceEvent("SUBOK"),m.isDebugEnabled()&&m.debug("SUBOK "+t+" "+e+" "+s),this.state.inPushing()&&(this.isFreshData()?(this.doSUBOK(t,e,s),this.state.inStreaming()&&this.evtRestartKeepalive()):(this.onStaleData(),this.state.inStreaming()&&this.evtRestartKeepalive()))},evtSUBCMD:function(t,e,s,i,n){this.traceEvent("SUBCMD"),m.isDebugEnabled()&&m.debug("SUBCMD "+t+" "+e+" "+s+" "+i+" "+n),this.state.inPushing()&&(this.isFreshData()?(this.doSUBCMD(t,e,s,i,n),this.state.inStreaming()&&this.evtRestartKeepalive()):(this.onStaleData(),this.state.inStreaming()&&this.evtRestartKeepalive()))},evtUNSUB:function(t){this.traceEvent("UNSUB"),m.isDebugEnabled()&&m.debug("UNSUB "+t),this.state.inPushing()&&(this.isFreshData()?(this.doUNSUB(t),this.state.inStreaming()&&this.evtRestartKeepalive()):(this.onStaleData(),this.state.inStreaming()&&this.evtRestartKeepalive()))},evtEOS:function(t,e){this.traceEvent("EOS"),m.isDebugEnabled()&&m.debug("EOS "+t+" "+e),this.state.inPushing()&&(this.isFreshData()?(this.doEOS(t,e),this.state.inStreaming()&&this.evtRestartKeepalive()):(this.onStaleData(),this.state.inStreaming()&&this.evtRestartKeepalive()))},evtCS:function(t,e){this.traceEvent("CS"),m.isDebugEnabled()&&m.debug("CS "+t+" "+e),this.state.inPushing()&&(this.isFreshData()?(this.doCS(t,e),this.state.inStreaming()&&this.evtRestartKeepalive()):(this.onStaleData(),this.state.inStreaming()&&this.evtRestartKeepalive()))},evtOV:function(t,e,s){this.traceEvent("OV"),m.isDebugEnabled()&&m.debug("OV "+t+" "+e+" "+s),this.state.inPushing()&&(this.isFreshData()?(this.doOV(t,e,s),this.state.inStreaming()&&this.evtRestartKeepalive()):(this.onStaleData(),this.state.inStreaming()&&this.evtRestartKeepalive()))},evtCONF:function(t,e){this.traceEvent("CONF"),m.isDebugEnabled()&&m.debug("CONF "+t+" "+c.string(e)),this.state.inPushing()&&(this.isFreshData()?(this.doCONF(t,e),this.state.inStreaming()&&this.evtRestartKeepalive()):(this.onStaleData(),this.state.inStreaming()&&this.evtRestartKeepalive()))},evtCheckAvg:function(t){if(this.traceEvent("check.avg"),this.state.s_slw==332)switch(t._hx_index){case 0:this.state.s_slw=331,this.state.traceState();break;case 1:this.state.s_slw=333,this.state.traceState();break;case 2:this.disableStreaming(),this.cause="slow",this.state.s_slw=334,this.state.traceState(),this.evtForcePolling();break}},evtSendPendingControls:function(){this.traceEvent("send.pending.controls");var t=this.getPendingControls(),e=this.state.s_w;if((e!=null?e.s:null)==340&&!P.empty(t))this.sendPengingControlsWS(t),this.state.s_w.s=340,this.state.traceState(),this.evtRestartHeartbeat();else{var e=this.state.s_ws;if((e!=null?e.s:null)==550&&!P.empty(t))this.sendPengingControlsWS(t),this.state.s_ws.s=550,this.state.traceState(),this.evtRestartHeartbeat();else{var e=this.state.s_wp;(e!=null?e.s:null)==630&&!P.empty(t)&&(this.sendPengingControlsWS(t),this.state.s_wp.s=630,this.state.traceState())}}},evtSendPendingMessages:function(){this.traceEvent("send.pending.messages");var t=this.state.s_w;if((t!=null?t.s:null)==340&&P.exists(this.messageManagers,function(e){return e.isPending()}))this.sendPendingMessagesWS(),this.state.s_w.s=340,this.state.traceState(),this.genAckMessagesWS(),this.evtRestartHeartbeat();else{var t=this.state.s_ws;if((t!=null?t.s:null)==550&&P.exists(this.messageManagers,function(s){return s.isPending()}))this.sendPendingMessagesWS(),this.state.s_ws.s=550,this.state.traceState(),this.genAckMessagesWS(),this.evtRestartHeartbeat();else{var t=this.state.s_wp;(t!=null?t.s:null)==630&&P.exists(this.messageManagers,function(i){return i.isPending()})&&(this.sendPendingMessagesWS(),this.state.s_wp.s=630,this.state.traceState(),this.genAckMessagesWS())}}},evtSelectRhb:function(){this.traceEvent("select.rhb"),this.state.s_rhb==320&&(this.rhb_grantedInterval==0?this.options.reverseHeartbeatInterval==0?(this.state.s_rhb=321,this.state.traceState()):(this.rhb_currentInterval=this.options.reverseHeartbeatInterval,this.state.s_rhb=322,this.state.traceState(),this.schedule_evtRhbTimeout(this.rhb_currentInterval)):this.options.reverseHeartbeatInterval>0&&this.options.reverseHeartbeatInterval<f.sure(this.rhb_grantedInterval)?(this.rhb_currentInterval=this.options.reverseHeartbeatInterval,this.state.s_rhb=323,this.state.traceState(),this.schedule_evtRhbTimeout(this.rhb_currentInterval)):(this.rhb_currentInterval=this.rhb_grantedInterval,this.state.s_rhb=323,this.state.traceState(),this.schedule_evtRhbTimeout(f.sure(this.rhb_currentInterval))))},evtExtSetReverseHeartbeatInterval:function(){if(this.traceEvent("setReverseHeartbeatInterval"),this.state.s_rhb!=null){var t=this.state.s_rhb;if(t!=null)switch(t){case 321:this.options.reverseHeartbeatInterval!=0&&(this.rhb_currentInterval=this.options.reverseHeartbeatInterval,this.state.s_rhb=322,this.state.traceState(),this.schedule_evtRhbTimeout(this.rhb_currentInterval));break;case 322:this.options.reverseHeartbeatInterval==0?(this.state.s_rhb=321,this.state.traceState(),this.cancel_evtRhbTimeout()):(this.rhb_currentInterval=this.options.reverseHeartbeatInterval,this.state.s_rhb=322,this.state.traceState());break;case 323:this.options.reverseHeartbeatInterval>0&&this.options.reverseHeartbeatInterval<f.sure(this.rhb_grantedInterval)?(this.rhb_currentInterval=this.options.reverseHeartbeatInterval,this.state.s_rhb=323,this.state.traceState()):(this.rhb_currentInterval=this.rhb_grantedInterval,this.state.s_rhb=323,this.state.traceState());break}}},evtRestartHeartbeat:function(){if(this.traceEvent("restart.heartbeat"),this.state.s_rhb!=null){var t=this.state.s_rhb;if(t!=null)switch(t){case 322:this.state.s_rhb=322,this.state.traceState(),this.cancel_evtRhbTimeout(),this.schedule_evtRhbTimeout(f.sure(this.rhb_currentInterval));break;case 323:this.state.s_rhb=323,this.state.traceState(),this.cancel_evtRhbTimeout(),this.schedule_evtRhbTimeout(f.sure(this.rhb_currentInterval));break;case 324:this.rhb_grantedInterval==0?this.options.reverseHeartbeatInterval!=0?(this.rhb_currentInterval=this.options.reverseHeartbeatInterval,this.state.s_rhb=322,this.state.traceState(),this.schedule_evtRhbTimeout(this.rhb_currentInterval)):(this.state.s_rhb=321,this.state.traceState()):this.options.reverseHeartbeatInterval>0&&this.options.reverseHeartbeatInterval<f.sure(this.rhb_grantedInterval)?(this.rhb_currentInterval=this.options.reverseHeartbeatInterval,this.state.s_rhb=323,this.state.traceState(),this.schedule_evtRhbTimeout(this.rhb_currentInterval)):(this.rhb_currentInterval=this.rhb_grantedInterval,this.state.s_rhb=323,this.state.traceState(),this.schedule_evtRhbTimeout(f.sure(this.rhb_currentInterval)));break}}},evtRhbTimeout:function(){this.traceEvent("rhb.timeout"),this.state.s_rhb==322?(this.state.s_rhb=324,this.state.traceState(),this.cancel_evtRhbTimeout(),this.evtSendHeartbeat()):this.state.s_rhb==323&&(this.state.s_rhb=324,this.state.traceState(),this.cancel_evtRhbTimeout(),this.evtSendHeartbeat())},evtDisposeCtrl:function(){this.traceEvent("du:dispose.ctrl"),this.disposeCtrl()},evtStartRecovery:function(){this.traceEvent("start.recovery"),this.state.s_rec==1e3&&(this.recoverTs=L.now()/1e3,this.state.s_rec=1e3,this.state.traceState())},evtRecoveryTimeout:function(){this.traceEvent("recovery.timeout"),this.state.s_rec==1e3&&(this.sendRecovery(),this.state.s_rec=1001,this.state.traceState(),this.cancel_evtRecoveryTimeout(),this.schedule_evtTransportTimeout(this.options.retryDelay))},evtCheckRecoveryTimeout:function(t){if(this.traceEvent("check.recovery.timeout"),this.state.s_rec==1002){var e=this.options.retryDelay;if(It.plus(this.connectTs,e)<It.plus(this.recoverTs,this.options.sessionRecoveryTimeout)){this.cause="recovery.error";var s=It.minus(L.now()/1e3,this.connectTs),i=e>rs.toMillis(s)?U.minus(e,rs.toMillis(s)):U.ZERO;this.state.s_rec=1003,this.state.traceState(),x.isErrorEnabled()&&(i>0?x.isErrorEnabled()&&x.error("Retrying recovery in "+i+"ms. Cause: "+c.string(t)):x.isErrorEnabled()&&x.error("Retrying recovery. Cause: "+c.string(t))),this.schedule_evtRetryTimeout(i)}else this.notifyStatus("DISCONNECTED:WILL-RETRY"),this.cause="recovery.timeout",this.state.goto_m_from_rec(113),this.exit_rec_to_m(),this.entry_m113(d.recovery_timeout)}},evtCreate:function(){this.traceEvent("du:create"),this.state.s_du==20?(this.state.s_du=21,this.state.traceState()):this.state.s_du==23&&(this.state.s_du=21,this.state.traceState())},evtCheckTransport:function(){if(this.traceEvent("check.transport"),this.state.s_swt==1300)if(this.state.s_tr==220||this.state.s_tr==230||this.state.s_tr==260)this.state.s_swt=1301,this.state.traceState();else{var t=this.getBestForBinding();t==M.BFB_ws_streaming&&(this.state.s_tr==210||this.state.s_tr==240)||t==M.BFB_http_streaming&&this.state.s_tr==270&&this.state.s_h==710||t==M.BFB_ws_polling&&this.state.s_tr==250||t==M.BFB_http_polling&&this.state.s_tr==270&&this.state.s_h==720?(this.state.s_swt=1301,this.state.traceState()):(this.state.s_swt=1302,this.state.traceState(),this.evtSendControl(f.sure(this.switchRequest)))}},evtCheckBW:function(){this.traceEvent("check.bw"),this.state.s_bw==1200&&(this.bw_requestedMaxBandwidth!=this.options.requestedMaxBandwidth&&this.options.realMaxBandwidth!=Zt.BWUnmanaged?(this.bw_requestedMaxBandwidth=this.options.requestedMaxBandwidth,this.state.s_bw=1202,this.state.traceState(),this.evtSendControl(f.sure(this.constrainRequest))):(this.state.s_bw=1201,this.state.traceState()))},evtCheckCtrlRequests:function(){if(this.traceEvent("check.ctrl.requests"),this.state.s_ctrl==1100){var t=this.getPendingControls();P.empty(t)?P.exists(this.messageManagers,function(e){return e.isPending()})?(this.sendPendingMessagesHTTP(),this.state.s_ctrl=1102,this.state.traceState(),this.evtRestartHeartbeat(),this.schedule_evtCtrlTimeout(this.options.retryDelay)):this.state.s_rhb==324?(this.sendHeartbeatHTTP(),this.state.s_ctrl=1102,this.state.traceState(),this.evtRestartHeartbeat(),this.schedule_evtCtrlTimeout(this.options.retryDelay)):(this.state.s_ctrl=1101,this.state.traceState()):(this.sendPendingControlsHTTP(t),this.state.s_ctrl=1102,this.state.traceState(),this.evtRestartHeartbeat(),this.schedule_evtCtrlTimeout(this.options.retryDelay))}},evtCtrlDone:function(){this.traceEvent("ctrl.done"),this.state.s_ctrl==1102&&(this.closeCtrl(),this.state.s_ctrl=1100,this.state.traceState(),this.cancel_evtCtrlTimeout(),this.evtCheckCtrlRequests())},evtCtrlError:function(){if(this.traceEvent("ctrl.error"),this.state.s_ctrl==1102){this.disposeCtrl();var t=this.waitingInterval(this.options.retryDelay,this.ctrl_connectTs);this.state.s_ctrl=1103,this.state.traceState(),this.cancel_evtCtrlTimeout(),this.schedule_evtCtrlTimeout(t)}},evtCtrlTimeout:function(){if(this.traceEvent("ctrl.timeout"),this.state.s_ctrl!=null)if(this.state.s_ctrl==1102){this.disposeCtrl();var t=this.waitingInterval(this.options.retryDelay,this.ctrl_connectTs);this.state.s_ctrl=1103,this.state.traceState(),this.cancel_evtCtrlTimeout(),this.schedule_evtCtrlTimeout(t)}else this.state.s_ctrl==1103&&(this.state.s_ctrl=1100,this.state.traceState(),this.cancel_evtCtrlTimeout(),this.evtCheckCtrlRequests())},evtSendControl:function(t){this.traceEvent("send.control");var e=this.state.s_w;if((e!=null?e.s:null)==340)this.sendControlWS(t),this.state.s_w.s=340,this.state.traceState(),this.evtRestartHeartbeat();else{var e=this.state.s_ws;if((e!=null?e.s:null)==550)this.sendControlWS(t),this.state.s_ws.s=550,this.state.traceState(),this.evtRestartHeartbeat();else{var e=this.state.s_wp;(e!=null?e.s:null)==630?(this.sendControlWS(t),this.state.s_wp.s=630,this.state.traceState()):this.state.s_ctrl==1101&&(this.state.s_ctrl=1100,this.state.traceState(),this.evtCheckCtrlRequests())}}},evtSendHeartbeat:function(){this.traceEvent("send.heartbeat");var t=this.state.s_w;if((t!=null?t.s:null)==340)this.sendHeartbeatWS(),this.state.s_w.s=340,this.state.traceState(),this.evtRestartHeartbeat();else{var t=this.state.s_ws;(t!=null?t.s:null)==550?(this.sendHeartbeatWS(),this.state.s_ws.s=550,this.state.traceState(),this.evtRestartHeartbeat()):this.state.s_ctrl==1101&&(this.state.s_ctrl=1100,this.state.traceState(),this.evtCheckCtrlRequests())}},evtStartSession:function(){this.traceEvent("du:start.session"),x.isInfoEnabled()&&x.info("Starting new session: "+this.sessionId),this.state.s_du==21&&(this.state.s_du=22,this.state.traceState())},evtEndSession:function(){x.isInfoEnabled()&&x.info("Destroying session: "+this.sessionId)},evtRetry:function(t,e){this.traceEvent("du:retry"),x.isErrorEnabled()&&(e!=null&&e>0?x.isErrorEnabled()&&x.error("Retrying connection in "+e+"ms. Cause: "+ks(t)):x.isErrorEnabled()&&x.error("Retrying connection. Cause: "+ks(t)));var s=!0;switch(this.state.s_du){case 21:this.resetSequenceMap(),this.state.s_du=23,this.state.traceState(),s=this.evtRetry_NextRegion(),this.genAbortMessages();break;case 22:this.disposeSession(),this.state.s_du=23,this.state.traceState(),s=this.evtRetry_NextRegion(),this.genAbortSubscriptions(),this.genAbortMessages();break}s&&this.evtRetry_NextRegion()},evtRetry_NextRegion:function(){return!1},evtTerminate:function(t){if(this.traceEvent("du:terminate"),x.isInfoEnabled()&&t._hx_index==2&&x.isInfoEnabled()&&x.info("Disconnected. Cause: Requested by user"),x.isErrorEnabled())switch(t._hx_index){case 0:x.isErrorEnabled()&&x.error("Disconnected. Cause: "+t.code+" - "+t.msg);break;case 1:x.isErrorEnabled()&&x.error("Disconnected. Cause: "+t.error);break}var e=!0;switch(this.state.s_du){case 20:this.disposeClient(),this.doUnistallPageLifecycle(),this.state.s_du=20,this.state.traceState(),e=this.evtTerminate_NextRegion(),this.genAbortMessages();break;case 21:this.disposeClient(),this.doUnistallPageLifecycle(),this.state.s_du=20,this.state.traceState(),e=this.evtTerminate_NextRegion(),this.genAbortMessages();break;case 22:this.disposeSession(),this.disposeClient(),this.doUnistallPageLifecycle(),this.state.s_du=20,this.state.traceState(),e=this.evtTerminate_NextRegion(),this.genAbortSubscriptions(),this.genAbortMessages();break;case 23:this.disposeClient(),this.doUnistallPageLifecycle(),this.state.s_du=20,this.state.traceState(),e=this.evtTerminate_NextRegion(),this.genAbortMessages();break}e&&this.evtTerminate_NextRegion()},evtTerminate_NextRegion:function(){return this.evtTerminate_NetworkReachabilityRegion()},evtTerminate_NetworkReachabilityRegion:function(){switch(this.state.s_nr){case 1410:case 1411:case 1412:var t=this.nr_reachabilityManager;this.nr_reachabilityManager=null,this.state.s_nr=1400,this.state.traceState(),t?.stopListening();break}return!1},evtRetryTimeout:function(){switch(this.traceEvent("retry.timeout"),this.state.s_m){case 110:this.notifyStatus("CONNECTING"),this.sendCreateTTL(),this.state.s_m=140,this.state.traceState(),this.evtCreate(),this.schedule_evtTransportTimeout(6e4);break;case 111:this.notifyStatus("CONNECTING"),this.delayCounter.increase(),this.sendCreateTTL(),this.state.s_m=140,this.state.traceState(),this.cancel_evtRetryTimeout(),this.evtCreate(),this.schedule_evtTransportTimeout(6e4);break;case 112:this.delayCounter.increase(),this.state.s_m=116,this.state.traceState(),this.cancel_evtRetryTimeout(),this.evtSelectCreate();break;case 113:this.state.s_m=116,this.state.traceState(),this.cancel_evtRetryTimeout(),this.evtSelectCreate();break;case 115:this.state.s_m=116,this.state.traceState(),this.evtSelectCreate();break;case 150:this.state.s_rec==1003&&(this.sendRecovery(),this.state.s_rec=1001,this.state.traceState(),this.cancel_evtRetryTimeout(),this.schedule_evtTransportTimeout(this.options.retryDelay));break}},evtExtSetForcedTransport:function(){this.traceEvent("setForcedTransport"),this.state.s_swt==1301&&(this.state.s_swt=1300,this.state.traceState(),this.evtCheckTransport())},evtExtSetRequestedMaxBandwidth:function(){this.traceEvent("setRequestedMaxBandwidth"),this.state.s_bw==1201&&(this.state.s_bw=1200,this.state.traceState(),this.evtCheckBW())},evtForceSlowing:function(){this.traceEvent("force.slowing"),this.state.s_swt==1301&&(this.state.s_swt=1300,this.state.traceState(),this.evtCheckTransport())},evtForcePolling:function(){this.traceEvent("force.polling"),this.state.s_swt==1301&&(this.state.s_swt=1300,this.state.traceState(),this.evtCheckTransport())},evtSendMessage:function(t){this.traceEvent("send.message");var e=this.state.s_w;if((e!=null?e.s:null)==340)this.sendMsgWS(t),this.state.s_w.s=340,this.state.traceState(),t.evtWSSent(),this.evtRestartHeartbeat();else{var e=this.state.s_ws;if((e!=null?e.s:null)==550)this.sendMsgWS(t),this.state.s_ws.s=550,this.state.traceState(),t.evtWSSent(),this.evtRestartHeartbeat();else{var e=this.state.s_wp;(e!=null?e.s:null)==630?(this.sendMsgWS(t),this.state.s_wp.s=630,this.state.traceState(),t.evtWSSent()):this.state.s_ctrl==1101&&(this.state.s_ctrl=1100,this.state.traceState(),this.evtCheckCtrlRequests())}}},evtSwitchTransport:function(){this.traceEvent("switch.transport");var t=!0;(this.state.s_swt==1302||this.state.s_swt==1303)&&(this.state.s_swt=1300,this.state.traceState(),t=this.evtSwitchTransport_forwardToTransportRegion(),this.evtCheckTransport()),t&&this.evtSwitchTransport_forwardToTransportRegion()},evtSwitchTransport_forwardToTransportRegion:function(){var t=ut.TC_otherError("Selected transport "+this.options.forcedTransport+" is not available");if(this.state.s_tr==200)switch(this.getBestForBinding()._hx_index){case 0:this.notifyStatus("DISCONNECTED"),this.state.goto_m_from_session(100),this.evtEndSession(),this.evtTerminate(t);break;case 1:this.openWS_Bind(),this.state.s_tr=240,this.state.s_ws=new he(500),this.state.traceState(),this.schedule_evtTransportTimeout(this.options.retryDelay);break;case 2:this.openWS_Bind(),this.state.s_tr=250,this.state.s_wp=new le(600),this.state.traceState(),this.schedule_evtTransportTimeout(this.options.retryDelay);break;case 3:this.sendBindHTTP_Streaming(),this.state.s_tr=270,this.state.s_h=710,this.state.s_hs=new ue(800),this.state.s_ctrl=1100,this.state.traceState(),this.evtCheckCtrlRequests(),this.schedule_evtTransportTimeout(this.options.retryDelay);break;case 4:this.sendBindHTTP_Polling(),this.state.s_tr=270,this.state.s_h=720,this.state.s_hp=new ce(900),this.state.s_rhb=320,this.state.s_ctrl=1100,this.state.traceState(),this.evtCheckCtrlRequests(),this.schedule_evtIdleTimeout(U.plus(f.sure(this.idleTimeout),this.options.retryDelay)),this.evtSelectRhb();break}else{var e=this.state.s_hs;if((e!=null?e.p:null)==811)switch(this.getBestForBinding()._hx_index){case 0:this.notifyStatus("DISCONNECTED"),this.state.goto_m_from_hs(100),this.exit_hs_to_m(),this.evtTerminate(t);break;case 1:this.openWS_Bind(),this.state.clear_hs(),this.state.s_h=null,this.state.s_ctrl=null,this.state.s_tr=240,this.state.s_ws=new he(500),this.state.traceState(),this.exit_hs(),this.exit_ctrl(),this.schedule_evtTransportTimeout(this.options.retryDelay);break;case 2:this.openWS_Bind(),this.state.clear_hs(),this.state.s_h=null,this.state.s_ctrl=null,this.state.s_tr=250,this.state.s_wp=new le(600),this.state.traceState(),this.exit_hs(),this.exit_ctrl(),this.schedule_evtTransportTimeout(this.options.retryDelay);break;case 3:this.sendBindHTTP_Streaming(),this.state.s_hs=new ue(800),this.state.traceState(),this.exit_hs(),this.schedule_evtTransportTimeout(this.options.retryDelay);break;case 4:this.sendBindHTTP_Polling(),this.state.clear_hs(),this.state.s_h=720,this.state.s_hp=new ce(900),this.state.s_rhb=320,this.state.traceState(),this.exit_hs(),this.schedule_evtIdleTimeout(U.plus(f.sure(this.idleTimeout),this.options.retryDelay)),this.evtSelectRhb();break}else{var e=this.state.s_hp;if((e!=null?e.m:null)==904)switch(this.getBestForBinding()._hx_index){case 0:this.notifyStatus("DISCONNECTED"),this.state.goto_m_from_hp(100),this.exit_hp_to_m(),this.evtTerminate(t);break;case 1:this.openWS_Bind(),this.state.clear_hp(),this.state.s_h=null,this.state.s_ctrl=null,this.state.s_tr=240,this.state.s_ws=new he(500),this.state.traceState(),this.exit_hp(),this.exit_ctrl(),this.schedule_evtTransportTimeout(this.options.retryDelay);break;case 2:this.openWS_Bind(),this.state.clear_hp(),this.state.s_h=null,this.state.s_ctrl=null,this.state.s_tr=250,this.state.s_wp=new le(600),this.state.traceState(),this.exit_hp(),this.exit_ctrl(),this.schedule_evtTransportTimeout(this.options.retryDelay);break;case 3:this.sendBindHTTP_Streaming(),this.state.clear_hp(),this.state.s_h=710,this.state.s_hs=new ue(800),this.state.traceState(),this.exit_hp(),this.schedule_evtTransportTimeout(this.options.retryDelay);break;case 4:this.sendBindHTTP_Polling(),this.state.s_hp=new ce(900),this.state.s_rhb=320,this.state.traceState(),this.exit_hp(),this.schedule_evtIdleTimeout(U.plus(f.sure(this.idleTimeout),this.options.retryDelay)),this.evtSelectRhb();break}}}return!1},onFreshData:function(){if(this.rec_serverProg!=this.rec_clientProg)throw new R("Assertion failure: rec_serverProg == rec_clientProg");this.rec_serverProg+=1,this.rec_clientProg+=1},onStaleData:function(){if(this.rec_serverProg>=this.rec_clientProg)throw new R("Assertion failure: rec_serverProg < rec_clientProg");this.rec_serverProg+=1},isFreshData:function(){return this.rec_serverProg==this.rec_clientProg},openWS:function(t,e){var s=this,i=function(o){Ot(function(){s.lock.synchronized(function(){o.isDisposed()||s.evtWSOpen()})})},n=function(o,l){Ot(function(){s.lock.synchronized(function(){if(!o.isDisposed())try{s.evtMessage(l)}catch(D){var v=g.caught(D);x.isErrorEnabled()&&x.error(""+v.get_message()+`
`+v.details()),s.evtExtDisconnect(ut.TC_standardError(61,v.get_message()))}})})},r=function(o,l){Ot(function(){s.lock.synchronized(function(){o.isDisposed()||s.evtTransportError()})})};return this.wsFactory(t,e,i,n,r)},openWS_Create:function(){this.connectTs=L.now()/1e3,this.serverInstanceAddress=this.getServerAddress(),this.ws=this.openWS(st.build(this.serverInstanceAddress,"lightstreamer"),this.options.httpExtraHeaders)},openWS_Bind:function(){this.connectTs=L.now()/1e3,this.ws=this.openWS(st.build(f.sure(this.serverInstanceAddress),"lightstreamer"),this.getHeadersForRequestOtherThanCreate())},sendCreateWS:function(){var t=new tt;this.options.keepaliveInterval>0&&t.LS_keepalive_millis(this.options.keepaliveInterval),this.rhb_grantedInterval=this.options.reverseHeartbeatInterval,this.rhb_grantedInterval>0&&t.LS_inactivity_millis(this.rhb_grantedInterval),this.bw_requestedMaxBandwidth=this.options.requestedMaxBandwidth;var e=this.bw_requestedMaxBandwidth;e!=null&&e._hx_index==0&&t.LS_requested_max_bandwidth_Float(e.bw),this.details.adapterSet!=null&&t.LS_adapter_set(this.details.adapterSet),this.details.user!=null&&t.LS_user(this.details.user),t.LS_cid(Us),this.sessionId!=null&&t.LS_old_session(this.sessionId),this.options.slowingEnabled||t.LS_send_sync(!1),this.cause!=null&&(t.LS_cause(this.cause),this.cause=null),m.isInfoEnabled()&&m.info("Sending session create: "+c.string(t)),this.details.password!=null&&t.LS_password(this.details.password),f.sure(this.ws).send("wsok"),f.sure(this.ws).send(`create_session\r
`+t.getEncodedString())},sendBindWS_Streaming:function(){var t=new tt;t.LS_session(f.sure(this.sessionId)),this.options.keepaliveInterval>0&&t.LS_keepalive_millis(this.options.keepaliveInterval),this.rhb_grantedInterval=this.options.reverseHeartbeatInterval,this.rhb_grantedInterval>0&&t.LS_inactivity_millis(this.rhb_grantedInterval),this.options.slowingEnabled||t.LS_send_sync(!1),this.cause!=null&&(t.LS_cause(this.cause),this.cause=null),m.isInfoEnabled()&&m.info("Sending session bind: "+c.string(t)),f.sure(this.ws).send("wsok"),f.sure(this.ws).send(`bind_session\r
`+t.getEncodedString())},sendBindWS_FirstPolling:function(){var t=new tt;t.LS_session(f.sure(this.sessionId)),t.LS_polling(!0),t.LS_polling_millis(this.options.pollingInterval),this.idleTimeout=this.options.idleTimeout,t.LS_idle_millis(this.idleTimeout),this.cause!=null&&(t.LS_cause(this.cause),this.cause=null),m.isInfoEnabled()&&m.info("Sending session bind: "+c.string(t)),f.sure(this.ws).send(`bind_session\r
`+t.getEncodedString())},sendBindWS_Polling:function(){var t=new tt;t.LS_polling(!0),t.LS_polling_millis(this.options.pollingInterval),this.idleTimeout=this.options.idleTimeout,t.LS_idle_millis(this.idleTimeout),this.cause!=null&&(t.LS_cause(this.cause),this.cause=null),m.isInfoEnabled()&&m.info("Sending session bind: "+c.string(t)),f.sure(this.ws).send(`bind_session\r
`+t.getEncodedString())},sendDestroyWS:function(t){t==null&&(t="api");var e=new tt;e.LS_reqId(this.generateFreshReqId()),e.LS_op("destroy"),e.LS_close_socket(!0),e.LS_cause(t),m.isInfoEnabled()&&m.info("Sending session destroy: "+c.string(e)),f.sure(this.ws).send(`control\r
`+e.getEncodedString())},sendHttpRequest:function(t,e,s){var i=this,n=function(o,l){Ot(function(){i.lock.synchronized(function(){if(!o.isDisposed())try{i.evtMessage(l)}catch(D){var v=g.caught(D);x.isErrorEnabled()&&x.error(""+v.get_message()+`
`+v.details()),i.evtExtDisconnect(ut.TC_standardError(61,v.get_message()))}})})},r=function(o,l){Ot(function(){i.lock.synchronized(function(){o.isDisposed()||i.evtTransportError()})})};return this.httpFactory(t,e.getEncodedString(),s,n,r,function(o){})},sendCreateHTTP:function(){var t=new tt;t.LS_polling(!0),t.LS_polling_millis(0),t.LS_idle_millis(0),this.bw_requestedMaxBandwidth=this.options.requestedMaxBandwidth;var e=this.bw_requestedMaxBandwidth;e!=null&&e._hx_index==0&&t.LS_requested_max_bandwidth_Float(e.bw),this.details.adapterSet!=null&&t.LS_adapter_set(this.details.adapterSet),this.details.user!=null&&t.LS_user(this.details.user),t.LS_cid(Us),this.sessionId!=null&&t.LS_old_session(this.sessionId),this.cause!=null&&(t.LS_cause(this.cause),this.cause=null),m.isInfoEnabled()&&m.info("Sending session create: "+c.string(t)),this.details.password!=null&&t.LS_password(this.details.password),this.connectTs=L.now()/1e3,this.serverInstanceAddress=this.getServerAddress(),this.http=this.sendHttpRequest(st.build(this.serverInstanceAddress,"/lightstreamer"+ei+"/create_session.txt?LS_protocol="+re),t,this.options.httpExtraHeaders)},sendBindHTTP_Streaming:function(){var t=new tt;t.LS_session(f.sure(this.sessionId)),t.LS_content_length(this.options.contentLength),this.options.keepaliveInterval>0&&t.LS_keepalive_millis(this.options.keepaliveInterval),this.rhb_grantedInterval=this.options.reverseHeartbeatInterval,this.rhb_grantedInterval>0&&t.LS_inactivity_millis(this.rhb_grantedInterval),this.options.slowingEnabled||t.LS_send_sync(!1),this.cause!=null&&(t.LS_cause(this.cause),this.cause=null),m.isInfoEnabled()&&m.info("Sending session bind: "+c.string(t)),this.connectTs=L.now()/1e3,this.http=this.sendHttpRequest(st.build(f.sure(this.serverInstanceAddress),"/lightstreamer/bind_session.txt?LS_protocol="+re),t,this.getHeadersForRequestOtherThanCreate())},sendBindHTTP_Polling:function(){var t=new tt;t.LS_session(f.sure(this.sessionId)),t.LS_polling(!0),t.LS_polling_millis(this.options.pollingInterval),this.idleTimeout=this.options.idleTimeout,t.LS_idle_millis(this.idleTimeout),this.cause!=null&&(t.LS_cause(this.cause),this.cause=null),this.rhb_grantedInterval=0,m.isInfoEnabled()&&m.info("Sending session bind: "+c.string(t)),this.connectTs=L.now()/1e3,this.http=this.sendHttpRequest(st.build(f.sure(this.serverInstanceAddress),"/lightstreamer/bind_session.txt?LS_protocol="+re),t,this.getHeadersForRequestOtherThanCreate())},sendCreateTTL:function(){var t=new tt;t.LS_ttl_millis("unlimited"),t.LS_polling(!0),t.LS_polling_millis(0),t.LS_idle_millis(0),this.bw_requestedMaxBandwidth=this.options.requestedMaxBandwidth;var e=this.bw_requestedMaxBandwidth;e!=null&&e._hx_index==0&&t.LS_requested_max_bandwidth_Float(e.bw),this.details.adapterSet!=null&&t.LS_adapter_set(this.details.adapterSet),this.details.user!=null&&t.LS_user(this.details.user),t.LS_cid(Us),this.sessionId!=null&&t.LS_old_session(this.sessionId),this.cause!=null&&(t.LS_cause(this.cause),this.cause=null),m.isInfoEnabled()&&m.info("Sending session create: "+c.string(t)),this.details.password!=null&&t.LS_password(this.details.password),this.connectTs=L.now()/1e3,this.serverInstanceAddress=this.getServerAddress(),this.http=this.sendHttpRequest(st.build(this.serverInstanceAddress,"/lightstreamer"+ei+"/create_session.txt?LS_protocol="+re),t,this.options.httpExtraHeaders)},sendRecovery:function(){var t=new tt;t.LS_session(f.sure(this.sessionId)),t.LS_recovery_from(this.rec_clientProg),t.LS_polling(!0),t.LS_polling_millis(0),t.LS_idle_millis(0),this.cause!=null&&(t.LS_cause(this.cause),this.cause=null),m.isInfoEnabled()&&m.info("Sending session recovery: "+c.string(t)),this.connectTs=L.now()/1e3,this.http=this.sendHttpRequest(st.build(f.sure(this.serverInstanceAddress),"/lightstreamer/bind_session.txt?LS_protocol="+re),t,this.getHeadersForRequestOtherThanCreate())},disposeWS:function(){this.ws!=null&&(this.ws.dispose(),this.ws=null)},closeWS:function(){this.ws!=null&&(this.ws.dispose(),this.ws=null)},suspendWS_Streaming:function(){x.isWarnEnabled()&&x.warn("Websocket suspended"),this.suspendedTransports.insert("WS-STREAMING")},disableWS:function(){x.isWarnEnabled()&&x.warn("Websocket disabled"),this.disabledTransports=this.disabledTransports.union(["WS-STREAMING","WS-POLLING"])},disableHTTP_Streaming:function(){x.isWarnEnabled()&&x.warn("HTTP streaming disabled"),this.disabledTransports=this.disabledTransports.union(["HTTP-STREAMING"])},disableStreaming:function(){x.isWarnEnabled()&&x.warn("Streaming disabled"),this.disabledTransports=this.disabledTransports.union(["WS-STREAMING","HTTP-STREAMING"])},enableAllTransports:function(){x.isInfoEnabled()&&(this.disabledTransports.count()>0||this.suspendedTransports.count()>0)&&x.isInfoEnabled()&&x.info("Transports enabled again."),this.disabledTransports=new Q,this.suspendedTransports=new Q},disposeHTTP:function(){this.http!=null&&(this.http.dispose(),this.http=null)},closeHTTP:function(){this.http!=null&&(this.http.dispose(),this.http=null)},disposeCtrl:function(){this.ctrl_http!=null&&(this.ctrl_http.dispose(),this.ctrl_http=null)},closeCtrl:function(){this.ctrl_http!=null&&(this.ctrl_http.dispose(),this.ctrl_http=null)},notifyStatus:function(t){var e=this.m_status;this.m_status=t,e!=t&&(x.isInfoEnabled()&&x.info("Status: "+t),this.clientEventDispatcher.onStatusChange(t))},getBestForCreating:function(){if(this.getBestForBinding()._hx_index==0)return _t.BFC_none;var t=this.options.forcedTransport,e=this.suspendedTransports.union(this.disabledTransports.toArray()),s=this.options.httpExtraHeaders,i=s==null||P.empty(s);if(t==null)return i?e.contains("WS-STREAMING")?_t.BFC_http:_t.BFC_ws:_t.BFC_http;switch(t){case"WS":case"WS-STREAMING":return i?e.contains("WS-STREAMING")?_t.BFC_http:_t.BFC_ws:_t.BFC_http;default:return _t.BFC_http}},getBestForBinding:function(){var t=this.options.forcedTransport,e=this.disabledTransports,s=this.options.httpExtraHeaders,i=s==null||P.empty(s),n=this.options.httpExtraHeadersOnSessionCreationOnly;if(t==null)return i||n?e.contains("WS-STREAMING")?e.contains("HTTP-STREAMING")?e.contains("WS-POLLING")?M.BFB_http_polling:M.BFB_ws_polling:M.BFB_http_streaming:M.BFB_ws_streaming:e.contains("HTTP-STREAMING")?M.BFB_http_polling:M.BFB_http_streaming;switch(t){case"HTTP":return e.contains("HTTP-STREAMING")?M.BFB_http_polling:M.BFB_http_streaming;case"HTTP-POLLING":return M.BFB_http_polling;case"HTTP-STREAMING":return e.contains("HTTP-STREAMING")?M.BFB_none:M.BFB_http_streaming;case"WS":return i||n?e.contains("WS-STREAMING")?e.contains("WS-POLLING")?M.BFB_none:M.BFB_ws_polling:M.BFB_ws_streaming:M.BFB_none;case"WS-POLLING":return i||n?e.contains("WS-POLLING")?M.BFB_none:M.BFB_ws_polling:M.BFB_none;case"WS-STREAMING":return i||n?e.contains("WS-STREAMING")?M.BFB_none:M.BFB_ws_streaming:M.BFB_none}},resetCurrentRetryDelay:function(){this.delayCounter.reset(this.options.retryDelay)},notifyServerErrorIfCauseIsError:function(t){switch(t._hx_index){case 0:this.clientEventDispatcher.onServerError(t.code,t.msg);break;case 1:this.clientEventDispatcher.onServerError(61,t.error);break}},notifyServerError_CONERR:function(t,e){this.clientEventDispatcher.onServerError(t,e)},notifyServerError_END:function(t,e){0<t&&t<30||t>39?this.clientEventDispatcher.onServerError(39,e):this.clientEventDispatcher.onServerError(t,e)},notifyServerError_ERROR:function(t,e){this.clientEventDispatcher.onServerError(t,e)},notifyServerError_REQERR:function(t,e){t==11?this.clientEventDispatcher.onServerError(21,e):this.clientEventDispatcher.onServerError(t,e)},doCONOK:function(t,e,s,i,n){this.sessionId=t,this.details.setSessionId(t),this.requestLimit=e,s!=null?(this.keepaliveInterval=s,this.options.setKeepaliveInterval(s)):i!=null&&(this.idleTimeout=i,this.options.setIdleTimeout(i)),n!="*"&&!this.options.serverInstanceAddressIgnored&&(n=st.completeControlLink(n,this.getServerAddress()),this.serverInstanceAddress=n,this.details.setServerInstanceAddress(n))},doCONOK_CreateWS:function(t,e,s,i){this.doCONOK(t,e,s,null,i)},doCONOK_BindWS_Streaming:function(t,e,s,i){this.doCONOK(t,e,s,null,i)},doCONOK_BindWS_Polling:function(t,e,s,i){this.doCONOK(t,e,null,s,i)},doCONOK_CreateHTTP:function(t,e,s,i){this.doCONOK(t,e,null,null,i)},doCONOK_BindHTTP_Streaming:function(t,e,s,i){this.doCONOK(t,e,s,null,i)},doCONOK_BindHTTP_Polling:function(t,e,s,i){this.doCONOK(t,e,null,s,i)},doSERVNAME:function(t){this.details.setServerSocketName(t)},doCLIENTIP:function(t){this.details.setClientIp(t);var e=this.lastKnownClientIp;e!=null&&e!=t&&(x.isInfoEnabled()&&x.info("Client IP changed: "+e+" -> "+t),this.enableAllTransports()),this.lastKnownClientIp=t},doCONS:function(t){this.options.setRealMaxBandwidth(t)},doLOOP:function(t){this.options.setPollingInterval(t)},doPROG:function(t){if(t>this.rec_clientProg)throw new R("Assertion failure: prog <= rec_clientProg");this.rec_serverProg=t},doMSGDONE:function(t,e,s){this.onFreshData();var i=this.messageManagers.filter(function(r){return r.sequence==t?r.prog==e:!1});if(i.values.length-i.nRemoved>1)throw new R("Assertion failure: messages.length <= 1");for(var n=new X(i);n.hasNext();)n.next().evtMSGDONE(s)},doMSGFAIL:function(t,e,s,i){if(this.onFreshData(),s==39){var n=c.parseInt(i);if(n==null)throw new R("Assertion failure: count != null");for(var r=e-n+1,o=e+1;r<o;){var l=this.messageManagers.filter((function(D){return function(N){return N.sequence==t?N.prog==D[0]:!1}})([r++]));if(l.values.length-l.nRemoved>1)throw new R("Assertion failure: messages.length <= 1");for(var v=new X(l);v.hasNext();)v.next().evtMSGFAIL(s,i)}}else{var l=this.messageManagers.filter(function(F){return F.sequence==t?F.prog==e:!1});if(l.values.length-l.nRemoved>1)throw new R("Assertion failure: messages.length <= 1");for(var v=new X(l);v.hasNext();)v.next().evtMSGFAIL(s,i)}},doU:function(t,e,s){this.onFreshData();var i=this.subscriptionManagers._innerMap.h[t];i!=null?i.evtU(e,s):new wt(t,this).evtU(e,s)},doSUBOK:function(t,e,s){this.onFreshData();var i=this.subscriptionManagers._innerMap.h[t];i!=null?i.evtSUBOK(e,s):new wt(t,this).evtSUBOK(e,s)},doSUBCMD:function(t,e,s,i,n){this.onFreshData();var r=this.subscriptionManagers._innerMap.h[t];r!=null?r.evtSUBCMD(e,s,i,n):new wt(t,this).evtSUBCMD(e,s,i,n)},doUNSUB:function(t){this.onFreshData();var e=this.subscriptionManagers._innerMap.h[t];e?.evtUNSUB()},doEOS:function(t,e){this.onFreshData();var s=this.subscriptionManagers._innerMap.h[t];s!=null?s.evtEOS(e):new wt(t,this).evtEOS(e)},doCS:function(t,e){this.onFreshData();var s=this.subscriptionManagers._innerMap.h[t];s!=null?s.evtCS(e):new wt(t,this).evtCS(e)},doOV:function(t,e,s){this.onFreshData();var i=this.subscriptionManagers._innerMap.h[t];i!=null?i.evtOV(e,s):new wt(t,this).evtOV(e,s)},doCONF:function(t,e){this.onFreshData();var s=this.subscriptionManagers._innerMap.h[t];s!=null?s.evtCONF(e):new wt(t,this).evtCONF(e)},doREQOK:function(t){for(var e=this.subscriptionManagers,s=e.keys();s.hasNext();)e.get(s.next()).evtREQOK(t);this.subscriptionManagers._orderedKeys.compact();for(var i=new X(this.messageManagers);i.hasNext();)i.next().evtREQOK(t);this.messageManagers.compact()},doREQERR:function(t,e,s){for(var i=this.subscriptionManagers,n=i.keys();n.hasNext();)i.get(n.next()).evtREQERR(t,e,s);this.subscriptionManagers._orderedKeys.compact();for(var r=new X(this.messageManagers);r.hasNext();)r.next().evtREQERR(t,e,s);this.messageManagers.compact()},doSYNC:function(t){this.slw_refTime=L.now()/1e3,this.slw_avgDelayMs=-t},doSYNC_G:function(t){var e=this.diffTimeSync(t);return e>this.slw_hugeDelayMs&&e>this.slw_avgDelayMs*2?this.slw_avgDelayMs>this.slw_maxAvgDelayMs&&this.options.slowingEnabled?ft.SCR_bad:ft.SCR_not_good:(this.slw_avgDelayMs=this.slowAvg(e),this.slw_avgDelayMs>this.slw_maxAvgDelayMs&&this.options.slowingEnabled?ft.SCR_bad:(this.slw_avgDelayMs<60&&(this.slw_avgDelayMs=0),ft.SCR_good))},doSYNC_NG:function(t){var e=this.diffTimeSync(t);return e>this.slw_hugeDelayMs&&e>this.slw_avgDelayMs*2?(this.slw_avgDelayMs=this.slowAvg(e),this.slw_avgDelayMs>this.slw_maxAvgDelayMs&&this.options.slowingEnabled?ft.SCR_bad:(this.slw_avgDelayMs<60&&(this.slw_avgDelayMs=0),ft.SCR_good)):(this.slw_avgDelayMs=this.slowAvg(e),this.slw_avgDelayMs>this.slw_maxAvgDelayMs&&this.options.slowingEnabled?ft.SCR_bad:(this.slw_avgDelayMs<60&&(this.slw_avgDelayMs=0),ft.SCR_not_good))},diffTimeSync:function(t){return It.minus(L.now()/1e3,this.slw_refTime)-t},slowAvg:function(t){return this.slw_avgDelayMs*this.slw_m+t*(1-this.slw_m)},schedule_evtTransportTimeout:function(t){this.transportTimer=this.createTimer("transport.timeout",t,$(this,this.evtTransportTimeout))},schedule_evtRetryTimeout:function(t){this.retryTimer=this.createTimer("retry.timeout",t,$(this,this.evtRetryTimeout))},schedule_evtRecoveryTimeout:function(t){this.recoveryTimer=this.createTimer("recovery.timeout",t,$(this,this.evtRecoveryTimeout))},schedule_evtIdleTimeout:function(t){this.idleTimer=this.createTimer("idle.timeout",t,$(this,this.evtIdleTimeout))},schedule_evtPollingTimeout:function(t){this.pollingTimer=this.createTimer("polling.timeout",t,$(this,this.evtPollingTimeout))},schedule_evtCtrlTimeout:function(t){this.ctrlTimer=this.createTimer("ctrl.timeout",t,$(this,this.evtCtrlTimeout))},schedule_evtKeepaliveTimeout:function(t){this.keepaliveTimer=this.createTimer("keepalive.timeout",t,$(this,this.evtKeepaliveTimeout))},schedule_evtStalledTimeout:function(t){this.stalledTimer=this.createTimer("stalled.timeout",t,$(this,this.evtStalledTimeout))},schedule_evtReconnectTimeout:function(t){this.reconnectTimer=this.createTimer("reconnect.timeout",t,$(this,this.evtReconnectTimeout))},schedule_evtRhbTimeout:function(t){this.rhbTimer=this.createTimer("rhb.timeout",t,$(this,this.evtRhbTimeout))},createTimer:function(t,e,s){var i=this;return this.timerFactory(t,e,function(n){i.lock.synchronized(function(){n.isCanceled()||s()})})},cancel_evtTransportTimeout:function(){this.transportTimer!=null&&(this.transportTimer.cancel(),this.transportTimer=null)},cancel_evtRetryTimeout:function(){this.retryTimer!=null&&(this.retryTimer.cancel(),this.retryTimer=null)},cancel_evtKeepaliveTimeout:function(){this.keepaliveTimer!=null&&(this.keepaliveTimer.cancel(),this.keepaliveTimer=null)},cancel_evtStalledTimeout:function(){this.stalledTimer!=null&&(this.stalledTimer.cancel(),this.stalledTimer=null)},cancel_evtReconnectTimeout:function(){this.reconnectTimer!=null&&(this.reconnectTimer.cancel(),this.reconnectTimer=null)},cancel_evtRhbTimeout:function(){this.rhbTimer!=null&&(this.rhbTimer.cancel(),this.rhbTimer=null)},cancel_evtIdleTimeout:function(){this.idleTimer!=null&&(this.idleTimer.cancel(),this.idleTimer=null)},cancel_evtPollingTimeout:function(){this.pollingTimer!=null&&(this.pollingTimer.cancel(),this.pollingTimer=null)},cancel_evtCtrlTimeout:function(){this.ctrlTimer!=null&&(this.ctrlTimer.cancel(),this.ctrlTimer=null)},cancel_evtRecoveryTimeout:function(){this.recoveryTimer!=null&&(this.recoveryTimer.cancel(),this.recoveryTimer=null)},waitingInterval:function(t,e){var s=It.minus(L.now()/1e3,e),i=t;return s<i?i-s:0},exit_tr:function(){this.evtEndSession()},entry_m111:function(t,e){this.evtRetry(t,e),this.schedule_evtRetryTimeout(e)},entry_m112:function(t){var e=this.waitingInterval(this.delayCounter.get_currentRetryDelay(),this.connectTs);this.evtRetry(t,e),this.schedule_evtRetryTimeout(e)},entry_m113:function(t){var e=this.randomPause(this.options.firstRetryMaxDelay);this.evtRetry(t,e),this.schedule_evtRetryTimeout(e)},entry_m115:function(t){this.evtRetry(t),this.evtRetryTimeout()},entry_rec:function(t,e){x.isErrorEnabled()&&x.error("Recovering connection in "+t+" ms. Cause: "+ks(e)),this.evtStartRecovery(),this.schedule_evtRecoveryTimeout(t)},exit_w:function(){this.cancel_evtKeepaliveTimeout(),this.cancel_evtStalledTimeout(),this.cancel_evtReconnectTimeout(),this.cancel_evtRhbTimeout()},exit_ws:function(){this.cancel_evtTransportTimeout(),this.cancel_evtKeepaliveTimeout(),this.cancel_evtStalledTimeout(),this.cancel_evtReconnectTimeout(),this.cancel_evtRhbTimeout()},exit_wp:function(){this.cancel_evtTransportTimeout(),this.cancel_evtIdleTimeout(),this.cancel_evtPollingTimeout()},exit_hs:function(){this.cancel_evtTransportTimeout(),this.cancel_evtKeepaliveTimeout(),this.cancel_evtStalledTimeout(),this.cancel_evtReconnectTimeout(),this.cancel_evtRhbTimeout()},exit_hp:function(){this.cancel_evtIdleTimeout(),this.cancel_evtPollingTimeout(),this.cancel_evtRhbTimeout()},exit_ctrl:function(){this.cancel_evtCtrlTimeout(),this.evtDisposeCtrl()},exit_rec:function(){this.cancel_evtRecoveryTimeout(),this.cancel_evtTransportTimeout(),this.cancel_evtRetryTimeout()},exit_keepalive_unit:function(){this.cancel_evtKeepaliveTimeout(),this.cancel_evtStalledTimeout(),this.cancel_evtReconnectTimeout()},exit_w_to_m:function(){this.exit_w(),this.exit_tr()},exit_ws_to_m:function(){this.exit_ws(),this.exit_tr()},exit_wp_to_m:function(){this.exit_wp(),this.exit_tr()},exit_hs_to_m:function(){this.exit_ctrl(),this.exit_hs(),this.exit_tr()},exit_hs_to_rec:function(){this.exit_ctrl(),this.exit_hs()},exit_hp_to_m:function(){this.exit_ctrl(),this.exit_hp(),this.exit_tr()},exit_hp_to_rec:function(){this.exit_ctrl(),this.exit_hp()},exit_ctrl_to_m:function(){this.exit_ctrl(),this.exit_hs(),this.exit_hp(),this.exit_tr()},exit_rec_to_m:function(){this.exit_rec(),this.exit_tr()},randomPause:function(t){return this.randomGenerator(t)},generateFreshReqId:function(){return this.m_nextReqId+=1,this.m_nextReqId},generateFreshSubId:function(){return this.m_nextSubId+=1,this.m_nextSubId},genAbortSubscriptions:function(){for(var t=this.subscriptionManagers,e=t.keys();e.hasNext();)t.get(e.next()).evtExtAbort();this.subscriptionManagers._orderedKeys.compact()},genAckMessagesWS:function(){for(var t=new X(this.messageManagers.filter(function(e){return e.isPending()}));t.hasNext();)t.next().evtWSSent()},genAbortMessages:function(){for(var t=new X(this.messageManagers);t.hasNext();)t.next().evtAbort();this.messageManagers.compact()},resetSequenceMap:function(){this.sequenceMap.h=Object.create(null)},isSwitching:function(){return this.state.s_m==150?this.state.s_swt!=1302?this.state.s_swt==1303:!0:!1},encodeSwitch:function(t){var e=new tt;return this.swt_lastReqId=this.generateFreshReqId(),e.LS_reqId(this.swt_lastReqId),e.LS_op("force_rebind"),t&&e.LS_close_socket(!0),this.cause!=null&&(e.LS_cause(this.cause),this.cause=null),m.isInfoEnabled()&&m.info("Sending transport switch: "+c.string(e)),e.getEncodedString()},encodeConstrain:function(){var t=new tt;this.bw_lastReqId=this.generateFreshReqId(),t.LS_reqId(this.bw_lastReqId),t.LS_op("constrain");var e=f.sure(this.bw_requestedMaxBandwidth);switch(e._hx_index){case 0:t.LS_requested_max_bandwidth_Float(e.bw);break;case 1:t.LS_requested_max_bandwidth("unlimited");break}return m.isInfoEnabled()&&m.info("Sending bandwidth constrain: "+c.string(t)),t.getEncodedString()},getPendingControls:function(){var t=[];f.sure(this.switchRequest).isPending()&&t.push(f.sure(this.switchRequest)),f.sure(this.constrainRequest).isPending()&&t.push(f.sure(this.constrainRequest));for(var e=this.subscriptionManagers,s=e.keys();s.hasNext();){var i=e.get(s.next());i.isPending()&&t.push(i)}return t},sendControlWS:function(t){f.sure(this.ws).send(t.encodeWS())},sendMsgWS:function(t){f.sure(this.ws).send(t.encodeWS())},sendPengingControlsWS:function(t){this.sendBatchWS(this.prepareBatchWS("control",t,f.sure(this.requestLimit)))},sendPendingMessagesWS:function(){for(var t=[],e=new X(this.messageManagers);e.hasNext();){var s=e.next();s.isPending()&&t.push(s)}this.sendBatchWS(this.prepareBatchWS("msg",t,f.sure(this.requestLimit)))},sendBatchWS:function(t){for(var e=0;e<t.length;){var s=t[e++];f.sure(this.ws).send(s)}},sendHeartbeatWS:function(){m.isInfoEnabled()&&m.info("Heartbeat request"),f.sure(this.ws).send(`heartbeat\r
\r
`)},sendPendingControlsHTTP:function(t){this.sendBatchHTTP(this.prepareBatchHTTP(t,f.sure(this.requestLimit)),"control")},sendPendingMessagesHTTP:function(){for(var t=[],e=new X(this.messageManagers);e.hasNext();){var s=e.next();s.isPending()&&t.push(s)}this.sendBatchHTTP(this.prepareBatchHTTP(t,f.sure(this.requestLimit)),"msg")},sendHeartbeatHTTP:function(){m.isInfoEnabled()&&m.info("Heartbeat request"),this.sendBatchHTTP(`\r
`,"heartbeat")},sendBatchHTTP:function(t,e){var s=this;this.ctrl_connectTs=L.now()/1e3;var i=st.build(f.sure(this.serverInstanceAddress),"/lightstreamer/"+e+".txt?LS_protocol="+re+"&LS_session="+this.sessionId),n=this.getHeadersForRequestOtherThanCreate(),r=function(v,D){Ot(function(){s.lock.synchronized(function(){v.isDisposed()||s.evtCtrlMessage(D)})})},o=function(v,D){Ot(function(){s.lock.synchronized(function(){v.isDisposed()||s.evtCtrlError()})})},l=function(v){Ot(function(){s.lock.synchronized(function(){v.isDisposed()||s.evtCtrlDone()})})};this.ctrl_http=this.ctrlFactory(i,t,n,r,o,l)},prepareBatchWS:function(t,e,s){if(e.length<=0)throw new R("Assertion failure: pendings.length > 0");for(var i=[],n=0,r=e[0].encode(!0);n<e.length;){var o=new it;for(o.addSubRequest(t),o.addSubRequest(r),++n;n<e.length&&(r=e[n].encode(!0),o.addSubRequestOnlyIfBodyIsLessThan(r,s));)++n;i.push(o.getBody())}return i},prepareBatchHTTP:function(t,e){if(t.length<=0)throw new R("Assertion failure: pendings.length > 0");var s=new it,i=0,n=t[0].encode(!1);for(s.addSubRequest(n),i=1;i<t.length&&(n=t[i].encode(!1),s.addSubRequestOnlyIfBodyIsLessThan(n,e));)++i;return s.getBody()},getHeadersForRequestOtherThanCreate:function(){return this.options.httpExtraHeadersOnSessionCreationOnly?null:this.options.httpExtraHeaders},getServerAddress:function(){var t=this.details.serverAddress;return t??f.sure(this.defaultServerAddress)},relateSubManager:function(t){if(this.subscriptionManagers._innerMap.h[t.subId]!=null)throw new R("Assertion failure: subscriptionManagers[subManager.subId] == null");this.subscriptionManagers.set(t.subId,t)},unrelateSubManager:function(t){this.subscriptionManagers.remove(t.subId)},isRelatedWithSubManager:function(t){return P.has(this.subscriptionManagers,t)},relateMsgManager:function(t){this.messageManagers.values.push(new qt(t))},unrelateMsgManager:function(t){this.messageManagers.remove(t)},getAndSetNextMsgProg:function(t){var e=this.sequenceMap.h[t];return e==null&&(e=1),this.sequenceMap.h[t]=e+1,e},onPropertyChange:function(t){this.clientEventDispatcher.onPropertyChange(t)},traceEvent:function(t){C.isTraceEnabled()&&C.trace("event: "+t+" "+this.state.toString())},connect:function(){var t=this.details.getServerAddress();if(t==null)throw new R("Configure the server address before trying to connect");w.isInfoEnabled()&&w.info("Connection requested: details: "+c.string(this.details)+" options: "+c.string(this.options)+" env: "+c.string(Ft.instance)),this.defaultServerAddress=t,this.evtExtConnect()},disconnect:function(){w.isInfoEnabled()&&w.info("Disconnection requested"),this.evtExtDisconnect(ut.TC_api)},getStatus:function(){return this.m_status},sendMessage:function(t,e,s,i,n){if(!n&&(this.state.inDisconnected()||this.state.inRetryUnit())){if(w.isInfoEnabled()){var r=new J;r.h.text=t,r.h.sequence=e??"UNORDERED_MESSAGES",r.h.timeout=s==null?"null":""+s,r.h.enqueueWhileDisconnected=n==null?"null":""+n,w.isInfoEnabled()&&w.info("Message sending requested: "+(r==null?"null":J.stringify(r.h)))}if(nt.isWarnEnabled()&&nt.warn("Message "+(e??"UNORDERED_MESSAGES")+" "+t+" aborted"),i!=null){var o=new _e;o.addListener(i),o.onAbort(t,!1)}return}if(e!=null){if(!new at("^[a-zA-Z0-9_]*$","").match(e))throw new y("The given sequence name is not valid. Use only alphanumeric characters plus underscore or null");var l=new fe(t,e,s,i,n,this);w.isInfoEnabled()&&w.info("Message sending requested: "+c.string(l)),l.evtExtSendMessage()}else{var l=new fe(t,"UNORDERED_MESSAGES",s,i,n,this);w.isInfoEnabled()&&w.info("Message sending requested: "+c.string(l)),l.evtExtSendMessage()}},subscribeExt:function(t,e){if(e==null&&(e=!1),t.isActive())throw new R("Cannot subscribe to an active Subscription");if(t.fetchItems()==null&&t.getItemGroup()==null)throw new y("Specify property 'items' or 'itemGroup'");if(t.fetchFields()==null&&t.getFieldSchema()==null)throw new y("Specify property 'fields' or 'fieldSchema'");var s=new Qt(t,this);w.isInfoEnabled()&&w.info((e?"Internal subscription":"Subscription")+" requested: subId: "+s.subId+" "+c.string(t)),s.evtExtSubscribe()},unsubscribe:function(t){var e=t.fetch_subManager();if(e!=null){if(!this.isRelatedWithSubManager(e))throw new y("The Subscription is not subscribed to this Client");w.isInfoEnabled()&&w.info("Unsubscription requested: subId: "+e.subId+" "+c.string(t)),e.evtExtUnsubscribe()}},getSubscriptions:function(){for(var t=[],e=this.subscriptionManagers,s=e.keys();s.hasNext();){var i=e.get(s.next()),n=i instanceof Qt?i:null;if(n!=null){var r=n.m_subscription;r.isActive()&&!r.isInternal()&&t.push(r)}}return t},__class__:oe};var _t=p["com.lightstreamer.client.internal._ClientMachine.BestForCreatingEnum"]={__ename__:!0,__constructs__:null,BFC_ws:{_hx_name:"BFC_ws",_hx_index:0,__enum__:"com.lightstreamer.client.internal._ClientMachine.BestForCreatingEnum",toString:h},BFC_http:{_hx_name:"BFC_http",_hx_index:1,__enum__:"com.lightstreamer.client.internal._ClientMachine.BestForCreatingEnum",toString:h},BFC_none:{_hx_name:"BFC_none",_hx_index:2,__enum__:"com.lightstreamer.client.internal._ClientMachine.BestForCreatingEnum",toString:h}};_t.__constructs__=[_t.BFC_ws,_t.BFC_http,_t.BFC_none];var M=p["com.lightstreamer.client.internal._ClientMachine.BestForBindingEnum"]={__ename__:!0,__constructs__:null,BFB_none:{_hx_name:"BFB_none",_hx_index:0,__enum__:"com.lightstreamer.client.internal._ClientMachine.BestForBindingEnum",toString:h},BFB_ws_streaming:{_hx_name:"BFB_ws_streaming",_hx_index:1,__enum__:"com.lightstreamer.client.internal._ClientMachine.BestForBindingEnum",toString:h},BFB_ws_polling:{_hx_name:"BFB_ws_polling",_hx_index:2,__enum__:"com.lightstreamer.client.internal._ClientMachine.BestForBindingEnum",toString:h},BFB_http_streaming:{_hx_name:"BFB_http_streaming",_hx_index:3,__enum__:"com.lightstreamer.client.internal._ClientMachine.BestForBindingEnum",toString:h},BFB_http_polling:{_hx_name:"BFB_http_polling",_hx_index:4,__enum__:"com.lightstreamer.client.internal._ClientMachine.BestForBindingEnum",toString:h}};M.__constructs__=[M.BFB_none,M.BFB_ws_streaming,M.BFB_ws_polling,M.BFB_http_streaming,M.BFB_http_polling];var ft=p["com.lightstreamer.client.internal._ClientMachine.SyncCheckResult"]={__ename__:!0,__constructs__:null,SCR_good:{_hx_name:"SCR_good",_hx_index:0,__enum__:"com.lightstreamer.client.internal._ClientMachine.SyncCheckResult",toString:h},SCR_not_good:{_hx_name:"SCR_not_good",_hx_index:1,__enum__:"com.lightstreamer.client.internal._ClientMachine.SyncCheckResult",toString:h},SCR_bad:{_hx_name:"SCR_bad",_hx_index:2,__enum__:"com.lightstreamer.client.internal._ClientMachine.SyncCheckResult",toString:h}};ft.__constructs__=[ft.SCR_good,ft.SCR_not_good,ft.SCR_bad];var d=p["com.lightstreamer.client.internal._ClientMachine.RetryCause"]={__ename__:!0,__constructs__:null,standardError:(u=function(t,e){return{_hx_index:0,code:t,msg:e,__enum__:"com.lightstreamer.client.internal._ClientMachine.RetryCause",toString:h}},u._hx_name="standardError",u.__params__=["code","msg"],u),ws_unavailable:{_hx_name:"ws_unavailable",_hx_index:1,__enum__:"com.lightstreamer.client.internal._ClientMachine.RetryCause",toString:h},ws_error:{_hx_name:"ws_error",_hx_index:2,__enum__:"com.lightstreamer.client.internal._ClientMachine.RetryCause",toString:h},http_error:{_hx_name:"http_error",_hx_index:3,__enum__:"com.lightstreamer.client.internal._ClientMachine.RetryCause",toString:h},idle_timeout:{_hx_name:"idle_timeout",_hx_index:4,__enum__:"com.lightstreamer.client.internal._ClientMachine.RetryCause",toString:h},stalled_timeout:{_hx_name:"stalled_timeout",_hx_index:5,__enum__:"com.lightstreamer.client.internal._ClientMachine.RetryCause",toString:h},ws_timeout:{_hx_name:"ws_timeout",_hx_index:6,__enum__:"com.lightstreamer.client.internal._ClientMachine.RetryCause",toString:h},http_timeout:{_hx_name:"http_timeout",_hx_index:7,__enum__:"com.lightstreamer.client.internal._ClientMachine.RetryCause",toString:h},recovery_timeout:{_hx_name:"recovery_timeout",_hx_index:8,__enum__:"com.lightstreamer.client.internal._ClientMachine.RetryCause",toString:h},prog_mismatch:(u=function(t,e){return{_hx_index:9,expected:t,actual:e,__enum__:"com.lightstreamer.client.internal._ClientMachine.RetryCause",toString:h}},u._hx_name="prog_mismatch",u.__params__=["expected","actual"],u),page_frozen:{_hx_name:"page_frozen",_hx_index:10,__enum__:"com.lightstreamer.client.internal._ClientMachine.RetryCause",toString:h}};d.__constructs__=[d.standardError,d.ws_unavailable,d.ws_error,d.http_error,d.idle_timeout,d.stalled_timeout,d.ws_timeout,d.http_timeout,d.recovery_timeout,d.prog_mismatch,d.page_frozen];var ut=p["com.lightstreamer.client.internal._ClientMachine.TerminationCause"]={__ename__:!0,__constructs__:null,TC_standardError:(u=function(t,e){return{_hx_index:0,code:t,msg:e,__enum__:"com.lightstreamer.client.internal._ClientMachine.TerminationCause",toString:h}},u._hx_name="TC_standardError",u.__params__=["code","msg"],u),TC_otherError:(u=function(t){return{_hx_index:1,error:t,__enum__:"com.lightstreamer.client.internal._ClientMachine.TerminationCause",toString:h}},u._hx_name="TC_otherError",u.__params__=["error"],u),TC_api:{_hx_name:"TC_api",_hx_index:2,__enum__:"com.lightstreamer.client.internal._ClientMachine.TerminationCause",toString:h}};ut.__constructs__=[ut.TC_standardError,ut.TC_otherError,ut.TC_api];var Me=p["com.lightstreamer.client.internal._ClientMachine.RecoveryRetryCause"]={__ename__:!0,__constructs__:null,RRC_transport_timeout:{_hx_name:"RRC_transport_timeout",_hx_index:0,__enum__:"com.lightstreamer.client.internal._ClientMachine.RecoveryRetryCause",toString:h},RRC_transport_error:{_hx_name:"RRC_transport_error",_hx_index:1,__enum__:"com.lightstreamer.client.internal._ClientMachine.RecoveryRetryCause",toString:h}};Me.__constructs__=[Me.RRC_transport_timeout,Me.RRC_transport_error];function ks(t){switch(t._hx_index){case 0:return""+t.code+" - "+t.msg;case 1:return"Websocket transport not available";case 2:return"Websocket error";case 3:return"HTTP error";case 4:return"idleTimeout expired";case 5:return"stalledTimeout expired";case 6:return"Websocket connect timeout expired";case 7:return"HTTP connect timeout expired";case 8:return"sessionRecoveryTimeout expired";case 9:return"Recovery counter mismatch: expected "+t.expected+" but found "+t.actual;case 10:return"page frozen"}}var jt=function(){};jt.__name__=!0,jt.__isInterface__=!0,jt.prototype={__class__:jt};var Pe=function(t){this.client=t};Pe.__name__=!0,Pe.__interfaces__=[jt],Pe.prototype={isPending:function(){return this.client.state.s_m==150?this.client.state.s_swt==1302:!1},encode:function(t){return this.client.encodeSwitch(t)},encodeWS:function(){return`control\r
`+this.encode(!0)},__class__:Pe};var ke=function(t){this.client=t};ke.__name__=!0,ke.__interfaces__=[jt],ke.prototype={isPending:function(){return this.client.state.s_bw==1202},encode:function(t){return this.client.encodeConstrain()},encodeWS:function(){return`control\r
`+this.encode(!0)},__class__:ke};var ms=function(t,e,s){this.p=t,this.k=e,this.s=s};ms.__name__=!0,ms.prototype={toString:function(){return"<w_p="+this.p+" w_k="+this.k+" w_s="+this.s+">"},__class__:ms};var he=function(t){this.m=t};he.__name__=!0,he.prototype={toString:function(){var t="<ws_m="+this.m;return this.p!=null&&(t+=" ws_p="+this.p),this.k!=null&&(t+=" ws_k="+this.k),this.s!=null&&(t+=" ws_s="+this.s),t+=">",t},__class__:he};var le=function(t){this.m=t};le.__name__=!0,le.prototype={toString:function(){var t="<wp_m="+this.m;return this.p!=null&&(t+=" wp_p="+this.p),this.c!=null&&(t+=" wp_c="+this.c),this.s!=null&&(t+=" wp_s="+this.s),t+=">",t},__class__:le};var ue=function(t){this.m=t};ue.__name__=!0,ue.prototype={toString:function(){var t="<hs_m="+this.m;return this.p!=null&&(t+=" hs_p="+this.p),this.k!=null&&(t+=" hs_k="+this.k),t+=">",t},__class__:ue};var ce=function(t){this.m=t};ce.__name__=!0,ce.prototype={toString:function(){return"<hp_m="+this.m+">"},__class__:ce};var vs=function(){this.s_m=100,this.s_du=20,this.s_nr=1400};vs.__name__=!0,vs.prototype={goto_m_from_w:function(t){this.clear_w(),this.goto_m_from_session(t)},goto_m_from_ws:function(t){this.clear_ws(),this.goto_m_from_session(t)},goto_rec_from_w:function(){this.clear_w(),this.goto_rec()},goto_rec_from_ws:function(){this.clear_ws(),this.goto_rec()},goto_m_from_wp:function(t){this.clear_wp(),this.goto_m_from_session(t)},goto_rec_from_wp:function(){this.clear_wp(),this.goto_rec()},goto_m_from_hs:function(t){this.clear_hs(),this.s_ctrl=null,this.s_h=null,this.goto_m_from_session(t)},goto_m_from_rec:function(t){this.s_tr=null,this.goto_m_from_session(t)},goto_rec_from_hs:function(){this.clear_hs(),this.s_ctrl=null,this.s_h=null,this.goto_rec()},goto_m_from_hp:function(t){this.clear_hp(),this.s_ctrl=null,this.s_h=null,this.goto_m_from_session(t)},goto_rec_from_hp:function(){this.clear_hp(),this.s_ctrl=null,this.s_h=null,this.goto_rec()},goto_rec:function(){this.s_tr=260,this.s_rec=1e3,this.traceState()},goto_m_from_session:function(t){this.s_tr=null,this.s_swt=null,this.s_bw=null,this.s_m=t,this.traceState()},goto_m_from_ctrl:function(t){this.clear_hs(),this.clear_hp(),this.s_ctrl=null,this.s_h=null,this.goto_m_from_session(t)},goto_200_from_rec:function(){this.s_rec=null,this.s_tr=200,this.traceState()},clear_w:function(){this.s_w=null,this.s_rhb=null,this.s_slw=null},clear_ws:function(){this.s_ws=null,this.s_rhb=null,this.s_slw=null},clear_wp:function(){this.s_wp=null},clear_hs:function(){this.s_hs=null,this.s_rhb=null,this.s_slw=null},clear_hp:function(){this.s_hp=null,this.s_rhb=null},isSwitching:function(){return this.s_m==150?this.s_swt!=1302?this.s_swt==1303:!0:!1},inPushing:function(){return this.inStreaming()?!0:this.inPolling()},inStreaming:function(){var t,e=this.s_w;if((e!=null?e.p:null)!=300){var e=this.s_ws;t=(e!=null?e.p:null)==510}else t=!0;if(t)return!0;var t=this.s_hs;return(t!=null?t.p:null)==810},inPolling:function(){var t,e;if(this.s_tr==220||this.s_tr==230)e=!0;else{var s=this.s_wp;e=(s!=null?s.p:null)==611}if(e)t=!0;else{var e=this.s_hp;t=(e!=null?e.m:null)==901}return t?!0:this.s_rec==1001},inRetryUnit:function(){switch(this.s_m){case 110:case 111:case 112:case 113:case 114:case 115:case 116:return!0;default:return!1}},inDisconnected:function(){return this.s_m==100},toString:function(){var t="<m="+this.s_m;return t+=" du="+this.s_du,this.s_tr!=null&&(t+=" tr="+this.s_tr),this.s_w!=null&&(t+=" "+c.string(this.s_w)),this.s_ws!=null&&(t+=" "+c.string(this.s_ws)),this.s_wp!=null&&(t+=" "+c.string(this.s_wp)),this.s_hs!=null&&(t+=" "+c.string(this.s_hs)),this.s_hp!=null&&(t+=" "+c.string(this.s_hp)),this.s_rec!=null&&(t+=" rec="+this.s_rec),this.s_h!=null&&(t+=" h="+this.s_h),this.s_ctrl!=null&&(t+=" ctrl="+this.s_ctrl),this.s_swt!=null&&(t+=" swt="+this.s_swt),this.s_bw!=null&&(t+=" bw="+this.s_bw),this.s_rhb!=null&&(t+=" rhb="+this.s_rhb),this.s_slw!=null&&(t+=" slw="+this.s_slw),t+=" nr="+this.s_nr,t+=">",t},traceState:function(){C.isTraceEnabled()&&C.trace("goto: "+this.toString())},__class__:vs};var _e=function(){Y.call(this)};_e.__name__=!0,_e.__super__=Y,_e.prototype=T(Y.prototype,{onAbort:function(t,e){this.dispatchToAll(function(s){s.onAbort!=null&&s.onAbort(t,e)})},onDeny:function(t,e,s){this.dispatchToAll(function(i){i.onDeny!=null&&i.onDeny(t,e,s)})},onDiscarded:function(t){this.dispatchToAll(function(e){e.onDiscarded!=null&&e.onDiscarded(t)})},onError:function(t){this.dispatchToAll(function(e){e.onError!=null&&e.onError(t)})},onProcessed:function(t,e){this.dispatchToAll(function(s){s.onProcessed!=null&&s.onProcessed(t,e)})},__class__:_e});var fe=function(t,e,s,i,n,r){this.eventDispatcher=new _e,this.txt=t,this.sequence=e,e!="UNORDERED_MESSAGES"||i!=null?this.prog=r.getAndSetNextMsgProg(e):this.prog=-1,this.maxWait=s,this.delegate=i,i!=null&&this.eventDispatcher.addListener(i),this.enqueueWhileDisconnected=n,this.client=r,i!=null?this.s_m=10:e!="UNORDERED_MESSAGES"?this.s_m=20:this.s_m=30,r.relateMsgManager(this)};fe.__name__=!0,fe.__interfaces__=[jt],fe.prototype={finalize:function(){this.client.unrelateMsgManager(this)},evtExtSendMessage:function(){switch(this.traceEvent("sendMessage"),this.s_m){case 10:this.goto(11),this.client.evtSendMessage(this);break;case 20:this.goto(21),this.client.evtSendMessage(this);break;case 30:this.goto(31),this.client.evtSendMessage(this);break}},evtMSGFAIL:function(t,e){switch(this.traceEvent("MSGFAIL"),this.s_m){case 10:this.finalize(),this.goto(13);break;case 11:this.doMSGFAIL(t,e),this.finalize(),this.goto(14);break;case 12:this.doMSGFAIL(t,e),this.finalize(),this.goto(14);break}},evtMSGDONE:function(t){switch(this.traceEvent("MSGDONE"),this.s_m){case 10:this.finalize(),this.goto(13);break;case 11:this.doMSGDONE(t),this.finalize(),this.goto(13);break;case 12:this.doMSGDONE(t),this.finalize(),this.goto(13);break}},evtREQOK:function(t){switch(this.traceEvent("REQOK"),this.s_m){case 11:t==this.lastReqId&&this.goto(12);break;case 21:t==this.lastReqId&&(this.finalize(),this.goto(22));break;case 31:t==this.lastReqId&&(this.finalize(),this.goto(33));break}},evtREQERR:function(t,e,s){switch(this.traceEvent("REQERR"),this.s_m){case 11:t==this.lastReqId&&(this.doREQERR(e,s),this.finalize(),this.goto(14));break;case 21:t==this.lastReqId&&(this.finalize(),this.goto(23));break;case 31:t==this.lastReqId&&(this.finalize(),this.goto(34));break}},evtAbort:function(){switch(this.traceEvent("abort"),this.s_m){case 11:this.doAbort(),this.finalize(),this.goto(15);break;case 12:this.doAbort(),this.finalize(),this.goto(15);break;case 21:nt.isWarnEnabled()&&nt.warn("Message "+this.sequence+":"+this.prog+" aborted"),this.finalize(),this.goto(24);break;case 31:nt.isWarnEnabled()&&nt.warn("Message "+this.sequence+":"+this.prog+" aborted"),this.finalize(),this.goto(35);break}},evtWSSent:function(){this.traceEvent("ws.sent"),this.s_m==31&&(this.finalize(),this.goto(32))},isPending:function(){return this.s_m==11||this.s_m==21?!0:this.s_m==31},encode:function(t){return this.encodeMsg(t)},encodeWS:function(){return`msg\r
`+this.encode(!0)},doMSGDONE:function(t){this.fireOnProcessed(t)},doMSGFAIL:function(t,e){t==38||t==39?this.fireOnDiscarded():t<=0?this.fireOnDeny(t,e):t!=32&&t!=33&&this.fireOnError()},doREQERR:function(t,e){t!=32&&t!=33&&this.fireOnError()},doAbort:function(){this.fireOnAbort()},encodeMsg:function(t){var e=this.sequence!="UNORDERED_MESSAGES",s=this.delegate!=null,i=new tt;return this.lastReqId=this.client.generateFreshReqId(),i.LS_reqId(this.lastReqId),i.LS_message(this.txt),e&&s?(i.LS_sequence(this.sequence),i.LS_msg_prog(this.prog),this.maxWait>=0&&i.LS_max_wait(this.maxWait)):!e&&s?i.LS_msg_prog(this.prog):e&&!s?(i.LS_outcome(!1),i.LS_sequence(this.sequence),i.LS_msg_prog(this.prog),this.maxWait>=0&&i.LS_max_wait(this.maxWait)):!e&&!s&&(i.LS_outcome(!1),t&&i.LS_ack(!1)),m.isInfoEnabled()&&m.info("Sending message: "+c.string(i)),i.getEncodedString()},fireOnProcessed:function(t){nt.isInfoEnabled()&&nt.info("Message "+this.sequence+":"+this.prog+" processed"),this.eventDispatcher.onProcessed(this.txt,t)},fireOnDiscarded:function(){nt.isWarnEnabled()&&nt.warn("Message "+this.sequence+":"+this.prog+" discarded"),this.eventDispatcher.onDiscarded(this.txt)},fireOnDeny:function(t,e){nt.isWarnEnabled()&&nt.warn("Message "+this.sequence+":"+this.prog+" denied: "+t+" - "+e),this.eventDispatcher.onDeny(this.txt,t,e)},fireOnError:function(){nt.isWarnEnabled()&&nt.warn("Message "+this.sequence+":"+this.prog+" failed"),this.eventDispatcher.onError(this.txt)},fireOnAbort:function(){nt.isWarnEnabled()&&nt.warn("Message "+this.sequence+":"+this.prog+" aborted"),this.eventDispatcher.onAbort(this.txt,!1)},traceEvent:function(t){C.isTraceEnabled()&&C.trace("msg#"+t+"("+this.sequence+":"+this.prog+") in "+this.s_m)},goto:function(t){this.s_m=t,C.isTraceEnabled()&&C.trace("msg#goto("+this.sequence+":"+this.prog+") "+this.s_m)},toString:function(){var t=I._new();return I.set(t,"text",this.txt),I.set(t,"sequence",this.sequence),I.set(t,"prog",this.prog),I.set(t,"timeout",this.maxWait),I.set(t,"enqueueWhileDisconnected",this.enqueueWhileDisconnected),J.stringify(t.h)},__class__:fe};var ot=function(t,e,s){this.items=new q,this.s_m=1,this.lock=e.lock,this.client=e,this.subscription=t,this.m_subId=s};ot.__name__=!0,ot.prototype={finalize:function(){},evtAbort:function(){this.traceEvent("abort"),this.s_m==1?(this.doAbort(),this.goto(1)):this.s_m==2&&(this.doAbort(),this.goto(1),this.genDisposeItems())},evtOnSUB:function(t,e,s,i,n){this.traceEvent("onSUB"),this.s_m==1&&(this.doSUB(t,e),this.goto(2))},evtOnCONF:function(t){this.traceEvent("onCONF"),this.s_m==2&&(this.doCONF(t),this.goto(2))},evtOnCS:function(t){this.traceEvent("onCS"),this.s_m==2&&(this.doCS(t),this.goto(2))},evtOnEOS:function(t){this.traceEvent("onEOS"),this.s_m==2&&(this.doEOS(t),this.goto(2))},evtUpdate:function(t,e){this.traceEvent("update"),this.s_m==2&&(this.doUpdate(t,e),this.goto(2))},evtUnsubscribe:function(){this.traceEvent("unsubscribe"),this.s_m==1?(this.finalize(),this.goto(3)):this.s_m==2&&(this.finalize(),this.goto(3),this.genDisposeItems())},evtOnUNSUB:function(){this.traceEvent("onUNSUB"),this.s_m==2&&(this.finalize(),this.goto(3),this.genDisposeItems())},evtDispose:function(){this.traceEvent("dispose"),(this.s_m==1||this.s_m==2)&&(this.finalize(),this.goto(3),this.genDisposeItems())},evtSetRequestedMaxFrequency:function(t){},getValue:function(t,e){var s=this.items.h[t];return s!=null?s.getValue(e):null},getCommandValue:function(t,e,s){throw new R("Unsupported operation")},createItem:function(t){throw new R("Abstract method")},doSUB:function(t,e){var s=this.subscription.fetchItems(),i=this.subscription.fetchFields();if(!(s==null||t==s.length))throw new R("Assertion failure: items != null ? nItems == items.length : true");if(!(i==null||e==i.length))throw new R("Assertion failure: fields != null ? nFields == fields.length : true")},doUpdate:function(t,e){this.selectItem(t).evtUpdate(e)},doEOS:function(t){this.selectItem(t).evtOnEOS()},doCS:function(t){this.selectItem(t).evtOnCS()},doCONF:function(t){this.realMaxFrequency=t,this.subscription.fireOnRealMaxFrequency(t,this.m_subId)},doAbort:function(){this.realMaxFrequency=null},genDisposeItems:function(){for(var t=this.items.copy(),e=t.keys();e.hasNext();)t.get(e.next()).evtDispose(this)},selectItem:function(t){var e=this.items.h[t];return e==null&&(e=this.createItem(t),this.items.h[t]=e),e},unrelate:function(t){this.items.remove(t)},traceEvent:function(t){C.isTraceEnabled()&&C.trace("sub#mod#"+t+"("+this.m_subId+") in "+this.s_m)},goto:function(t){this.s_m=t,C.isTraceEnabled()&&C.trace("sub#mod#goto("+this.m_subId+") "+this.s_m)},__class__:ot};var Rt=function(t,e,s){ot.call(this,t,e,s)};Rt.__name__=!0,Rt.__super__=ot,Rt.prototype=T(ot.prototype,{evtOnSUB:function(t,e,s,i,n){this.traceEvent("onSUB"),this.s_m==1&&(this.doSUBCMD(t,e,s,i),this.goto(2))},getCommandValue:function(t,e,s){var i=this.items.h[t];return i!=null?i.getCommandValue(e,s):null},doSUBCMD:function(t,e,s,i){var n=this.subscription.fetchItems(),r=this.subscription.fetchFields();if(!(n==null||t==n.length))throw new R("Assertion failure: items != null ? nItems == items.length : true");if(!(r==null||e==r.length))throw new R("Assertion failure: fields != null ? nFields == fields.length : true");if(!(r==null||s-1==r.indexOf("command")))throw new R('Assertion failure: fields != null ? cmdIdx - 1 == fields.indexOf("command") : true');if(!(r==null||i-1==r.indexOf("key")))throw new R('Assertion failure: fields != null ? keyIdx - 1 == fields.indexOf("key") : true')},__class__:Rt});var Fe=function(t,e,s){Rt.call(this,t,e,s)};Fe.__name__=!0,Fe.__super__=Rt,Fe.prototype=T(Rt.prototype,{createItem:function(t){return new Ue(t,this.subscription,this.client,this.m_subId)},__class__:Fe});var Ae=function(t,e,s){Rt.call(this,t,e,s)};Ae.__name__=!0,Ae.__super__=Rt,Ae.prototype=T(Rt.prototype,{evtOnSUB:function(t,e,s,i,n){this.traceEvent("onSUB"),this.s_m==1&&(this.doSUBCMD2Level(t,e,s,i,n),this.goto(2))},evtSetRequestedMaxFrequency:function(t){switch(this.traceEvent("setRequestedMaxFrequency"),this.s_m){case 1:case 2:this.doSetRequestedMaxFrequency(t),this.goto(this.s_m),this.genSetRequestedMaxFrequency();break}},evtOnRealMaxFrequency2LevelAdded:function(t){this.traceEvent("onRealMaxFrequency2LevelAdded"),this.s_m==2&&(this.doAggregateFrequenciesWhenFreqIsAdded(t),this.goto(2))},evtOnRealMaxFrequency2LevelRemoved:function(){this.traceEvent("onRealMaxFrequency2LevelRemoved"),this.s_m==2&&(this.doAggregateFrequenciesWhenFreqIsRemoved(),this.goto(2))},evtOnCONF:function(t){this.traceEvent("onCONF"),this.s_m==2&&(this.doCONF2Level(t),this.doAggregateFrequenciesWhenFreqIsAdded(t),this.goto(2))},createItem:function(t){return new ee(t,this.subscription,this,this.client,this.m_subId)},doSUBCMD2Level:function(t,e,s,i,n){var r=this.subscription.fetchItems(),o=this.subscription.fetchFields();if(!(r==null||t==r.length))throw new R("Assertion failure: items != null ? nItems == items.length : true");if(!(o==null||e==o.length))throw new R("Assertion failure: fields != null ? nFields == fields.length : true");if(!(o==null||s-1==o.indexOf("command")))throw new R('Assertion failure: fields != null ? cmdIdx - 1 == fields.indexOf("command") : true');if(!(o==null||i-1==o.indexOf("key")))throw new R('Assertion failure: fields != null ? keyIdx - 1 == fields.indexOf("key") : true');this.requestedMaxFrequency=n},doSetRequestedMaxFrequency:function(t){this.requestedMaxFrequency=t},genSetRequestedMaxFrequency:function(){for(var t=this.items,e=t.keys();e.hasNext();)B.__cast(t.get(e.next()),ee).evtSetRequestedMaxFrequency()},doCONF2Level:function(t){this.realMaxFrequency=t},maxFreq:function(t,e){var s;if(t==null)s=e;else switch(t._hx_index){case 0:var i=t.freq;if(e==null)s=t;else switch(e._hx_index){case 0:s=Dt.RFreqLimited(Math.max(i,e.freq));break;case 1:s=e;break}break;case 1:s=t;break}return s},doAggregateFrequenciesWhenFreqIsAdded:function(t){var e=this.maxFreq(this.aggregateRealMaxFrequency,t),s=this.aggregateRealMaxFrequency;this.aggregateRealMaxFrequency=e,ti(s,e)||this.subscription.fireOnRealMaxFrequency(e,this.m_subId)},doAggregateFrequenciesWhenFreqIsRemoved:function(){for(var t=this.realMaxFrequency,e=!1,s=this.items,i=s.keys();i.hasNext();){for(var n=B.__cast(s.get(i.next()),ee).keys.h,r=Object.keys(n),o=r.length,l=0;l<o;)if(t=this.maxFreq(t,B.__cast(n[r[l++]],ve).realMaxFrequency),t==Dt.RFreqUnlimited){e=!0;break}if(e)break}var v=this.aggregateRealMaxFrequency;this.aggregateRealMaxFrequency=t,ti(v,t)||this.subscription.fireOnRealMaxFrequency(t,this.m_subId)},__class__:Ae});var qe=function(t,e,s){ot.call(this,t,e,s)};qe.__name__=!0,qe.__super__=ot,qe.prototype=T(ot.prototype,{createItem:function(t){return new He(t,this.subscription,this.client,this.m_subId)},__class__:qe});var Be=function(t,e,s){ot.call(this,t,e,s)};Be.__name__=!0,Be.__super__=ot,Be.prototype=T(ot.prototype,{createItem:function(t){return new Ke(t,this.subscription,this.client,this.m_subId)},__class__:Be});var We=function(t,e,s){ot.call(this,t,e,s)};We.__name__=!0,We.__super__=ot,We.prototype=T(ot.prototype,{createItem:function(t){return new Ve(t,this.subscription,this.client,this.m_subId)},__class__:We});var ps=function(t,e,s){this.subId=t,this.itemIdx=e,this.values=s};ps.__name__=!0,ps.prototype={__class__:ps};function k(t){return f.sure(c.parseInt(t))}function Js(t){return f.sure(parseFloat(t))}function gi(t){for(var e=Fs(t,",")+1,s=Fs(t,",",e)+1,i=Fs(t,",",s)+1,n=k(t.substring(e,s-1)),r=k(t.substring(s,i-1)),o=new q,l=i-1,v=1;l<t.length;){var D=t.indexOf("|",l+1);D==-1&&(D=t.length);var N=t.substring(l+1,D);if(N=="")o.h[v]=vt.unchanged,++v;else if(N=="#")o.h[v]=vt.changed(null),++v;else if(N=="$")o.h[v]=vt.changed(""),++v;else if(N.charAt(0)=="^")if(N.charAt(1)=="P"){var F=yt(N.substring(2));try{var rt=Kt._new(F);o.h[v]=vt.jsonPatch(rt),++v}catch(Ie){var V=g.caught(Ie);throw x.isErrorEnabled()&&x.error("Invalid JSON patch "+F+": "+V.get_message()+`
`+V.details()),new R("The JSON Patch for the field "+v+" is not well-formed")}}else if(N.charAt(1)=="T"){var gt=yt(N.substring(2));o.h[v]=vt.diffPatch(gt),++v}else for(var Vt=k(N.substring(1)),bt=0;bt<Vt;)++bt,o.h[v]=vt.unchanged,++v;else{var ct=vt.changed(yt(N));o.h[v]=ct,++v}l=D}return new ps(n,r,o)}function Fs(t,e,s){var i=t.indexOf(e,s);if(i==-1)throw new R("string not found");return i}function yt(t){for(var e=Pt.ofString(t,de.UTF8),s=0,i=0;s<e.length;)e.b[s]==37?(e.b[i++]=($s(e.b[s+1])<<4)+$s(e.b[s+2]),s+=3):e.b[i++]=e.b[s++];var n=e.sub(0,i).b.bufferValue;return ki.decode(n)}function $s(t){var e=0;return e=t-97+10,e<=9&&(e=t-65+10,e<=9&&(e=t-48)),e}var Pt=function(t){this.length=t.byteLength,this.b=new Uint8Array(t),this.b.bufferValue=t,t.hxBytes=this,t.bytes=this.b};Pt.__name__=!0,Pt.ofString=function(t,e){if(e==de.RawNative){for(var s=new Uint8Array(t.length<<1),i=0,n=t.length;i<n;){var l=i++,r=t.charCodeAt(l);s[l<<1]=r&255,s[l<<1|1]=r>>8}return new Pt(s.buffer)}for(var o=[],l=0;l<t.length;){var r=t.charCodeAt(l++);55296<=r&&r<=56319&&(r=r-55232<<10|t.charCodeAt(l++)&1023),r<=127?o.push(r):r<=2047?(o.push(192|r>>6),o.push(128|r&63)):r<=65535?(o.push(224|r>>12),o.push(128|r>>6&63),o.push(128|r&63)):(o.push(240|r>>18),o.push(128|r>>12&63),o.push(128|r>>6&63),o.push(128|r&63))}return new Pt(new Uint8Array(o).buffer)},Pt.prototype={sub:function(t,e){if(t<0||e<0||t+e>this.length)throw g.thrown(Te.OutsideBounds);return new Pt(this.b.buffer.slice(t+this.b.byteOffset,t+this.b.byteOffset+e))},__class__:Pt};var de=p["haxe.io.Encoding"]={__ename__:!0,__constructs__:null,UTF8:{_hx_name:"UTF8",_hx_index:0,__enum__:"haxe.io.Encoding",toString:h},RawNative:{_hx_name:"RawNative",_hx_index:1,__enum__:"haxe.io.Encoding",toString:h}};de.__constructs__=[de.UTF8,de.RawNative];var it=function(){this.body=""};it.__name__=!0,it.isEmpty=function(t){return t.length==0},it.lengthOfBytes=function(t){return Pt.ofString(t,de.UTF8).length},it.prototype={getByteSize:function(){return it.lengthOfBytes(this.body)},getBody:function(){return this.body},addSubRequest:function(t){it.isEmpty(this.body)?this.body=t:this.body+=`\r
`+t},addSubRequestOnlyIfBodyIsLessThan:function(t,e){return it.isEmpty(this.body)&&it.lengthOfBytes(t)<=e?(this.body=t,!0):it.lengthOfBytes(this.body)+it.EOL_LEN+it.lengthOfBytes(t)<=e?(this.body+=`\r
`+t,!0):!1},__class__:it};var gs=function(){this.attempt=1,this._currentRetryDelay=0};gs.__name__=!0,gs.prototype={get_currentRetryDelay:function(){return this._currentRetryDelay},increase:function(){this.attempt>10?this._currentRetryDelay<6e4&&(this._currentRetryDelay*2<6e4?this._currentRetryDelay*=2:this._currentRetryDelay=6e4):this.attempt+=1},reset:function(t){this.attempt=1,this._currentRetryDelay=t},__class__:gs};var te=function(){};te.__name__=!0,te.__isInterface__=!0,te.__interfaces__=[jt],te.prototype={__class__:te};var Ss=function(t){this.subId=t,this.s_m=1};Ss.__name__=!0,Ss.prototype={toString:function(){var t="<m="+this.s_m;return this.s_s!=null&&(t+=" s="+this.s_s),this.s_c!=null&&(t+=" c="+this.s_c),t+=">",t},traceState:function(){C.isTraceEnabled()&&C.trace("sub#goto("+this.subId+") "+this.toString())},__class__:Ss};var Qt=function(t,e){this.lock=e.lock,this.subId=e.generateFreshSubId();var s;switch(t.fetch_mode()){case"COMMAND":s=Qt.is2LevelCommand(t)?new Ae(t,e,this.subId):new Fe(t,e,this.subId);break;case"DISTINCT":s=new qe(t,e,this.subId);break;case"MERGE":s=new Be(t,e,this.subId);break;case"RAW":s=new We(t,e,this.subId);break}this.m_strategy=s,this.state=new Ss(this.subId),this.m_client=e,this.m_subscription=t,this.m_client.relateSubManager(this),this.m_subscription.relate(this)};Qt.__name__=!0,Qt.__interfaces__=[te],Qt.is2LevelCommand=function(t){return t.fetch_mode()=="COMMAND"?t.getCommandSecondLevelFields()==null?t.getCommandSecondLevelFieldSchema()!=null:!0:!1},Qt.prototype={finalize:function(){this.m_strategy.evtDispose(),this.m_client.unrelateSubManager(this),this.m_subscription.unrelate(this)},evtExtSubscribe:function(){this.traceEvent("subscribe"),this.state.s_m==1&&(this.doSetActive(),this.doSubscribe(),this.state.s_m=2,this.state.traceState(),this.genSendControl())},evtExtUnsubscribe:function(){this.traceEvent("unsubscribe"),this.state.s_m==2?(this.doSetInactive(),this.finalize(),this.state.s_m=30,this.state.traceState()):this.state.s_m==3?(this.doUnsubscribe(),this.doSetInactive(),this.state.s_m=5,this.state.traceState(),this.genSendControl()):this.state.s_s==10&&(this.doUnsubscribe(),this.m_subscription.setInactive(),this.notifyOnUnsubscription(),this.state.s_m=5,this.state.s_s=null,this.state.s_c=null,this.state.traceState(),this.genSendControl())},evtExtAbort:function(){this.traceEvent("abort"),this.state.s_m==2?(this.state.s_m=2,this.state.traceState()):this.state.s_m==3?(this.doAbort(),this.doSetActive(),this.state.s_m=2,this.state.traceState()):this.state.s_s==10?(this.doAbort(),this.doSetActive(),this.notifyOnUnsubscription(),this.state.s_s=null,this.state.s_c=null,this.state.s_m=2,this.state.traceState()):this.state.s_m==5&&(this.finalize(),this.state.s_m=32,this.state.traceState())},evtREQERR:function(t,e,s){this.traceEvent("REQERR"),this.state.s_m==2&&t==this.m_lastAddReqId?(this.doSetInactive(),this.notifyOnSubscriptionError(e,s),this.finalize(),this.state.s_m=30,this.state.traceState()):this.state.s_m==5&&t==this.m_lastDeleteReqId?(this.finalize(),this.state.s_m=32,this.state.traceState()):this.state.s_c==22&&t==this.m_lastReconfReqId&&(Lt.extEquals(this.m_reqMaxFrequency,this.m_subscription.fetch_requestedMaxFrequency())?(this.state.s_c=21,this.state.traceState()):(this.state.s_c=20,this.state.traceState(),this.evtCheckFrequency()))},evtREQOK:function(t){this.traceEvent("REQOK"),this.state.s_m==2&&t==this.m_lastAddReqId?(this.state.s_m=3,this.state.traceState()):this.state.s_m==5&&t==this.m_lastDeleteReqId?(this.finalize(),this.state.s_m=32,this.state.traceState()):this.state.s_c==22&&t==this.m_lastReconfReqId&&(this.doREQOKConfigure(),this.state.s_c=20,this.state.traceState(),this.evtCheckFrequency())},checkItems:function(t,e){return t!=null?t==e:!0},checkFields:function(t,e){return t!=null?t==e:!0},checkItemsAndFields:function(t,e,s,i){return this.checkItems(t,s)?this.checkFields(e,i):!1},evtSUBOK:function(t,e){if(this.traceEvent("SUBOK"),this.state.s_m==2||this.state.s_m==3){var i=this.m_subscription.fetch_items(),s=i!=null?i.length:null,i=this.m_subscription.fetch_fields(),n=i!=null?i.length:null;this.checkItemsAndFields(s,n,t,e)?(this.doSUBOK(t,e),this.notifyOnSubscription(),this.state.s_m=4,this.state.s_s=10,this.state.s_c=20,this.state.traceState(),this.evtCheckFrequency()):(this.doUnsubscribe(),this.doSetInactive(),this.notifyOnSubscriptionError_CountMismatch(s,n,t,e),this.state.s_m=5,this.state.traceState(),this.genSendControl())}},evtSUBCMD:function(t,e,s,i){if(this.traceEvent("SUBCMD"),this.state.s_m==2||this.state.s_m==3){var r=this.m_subscription.fetch_items(),n=r!=null?r.length:null,r=this.m_subscription.fetch_fields(),o=r!=null?r.length:null;this.checkItemsAndFields(n,o,t,e)?(this.doSUBCMD(t,e,i,s),this.notifyOnSubscription(),this.state.s_m=4,this.state.s_s=10,this.state.s_c=20,this.state.traceState(),this.evtCheckFrequency()):(this.doUnsubscribe(),this.doSetInactive(),this.notifyOnSubscriptionError_CountMismatch(n,o,t,e),this.state.s_m=5,this.state.traceState(),this.genSendControl())}},evtUNSUB:function(){this.traceEvent("UNSUB"),this.state.s_s==10?(this.doUNSUB(),this.doSetInactive(),this.notifyOnUnsubscription(),this.finalize(),this.state.s_m=31,this.state.s_s=null,this.state.s_c=null,this.state.traceState()):this.state.s_m==5&&(this.finalize(),this.state.s_m=32,this.state.traceState())},evtU:function(t,e){this.traceEvent("U"),this.state.s_s==10&&(this.doU(t,e),this.state.s_s=10,this.state.traceState())},evtEOS:function(t){this.traceEvent("EOS"),this.state.s_s==10&&(this.doEOS(t),this.state.s_s=10,this.state.traceState())},evtCS:function(t){this.traceEvent("CS"),this.state.s_s==10&&(this.doCS(t),this.state.s_s=10,this.state.traceState())},evtOV:function(t,e){this.traceEvent("OV"),this.state.s_s==10&&(this.doOV(t,e),this.state.s_s=10,this.state.traceState())},evtCONF:function(t){this.traceEvent("CONF"),this.state.s_s==10&&(this.doCONF(t),this.state.s_s=10,this.state.traceState())},evtCheckFrequency:function(){this.traceEvent("check.frequency"),this.state.s_c==20&&(Lt.extEquals(this.m_subscription.fetch_requestedMaxFrequency(),this.m_currentMaxFrequency)?(this.state.s_c=21,this.state.traceState()):(this.doConfigure(),this.state.s_c=22,this.state.traceState(),this.genSendControl()))},evtExtConfigure:function(){this.traceEvent("configure"),this.state.s_c==21&&(this.state.s_c=20,this.state.traceState(),this.evtCheckFrequency())},isPending:function(){return this.state.s_m==2||this.state.s_m==5?!0:this.state.s_c==22},encode:function(t){if(this.state.s_m==2)return this.encodeAdd(t);if(this.state.s_m==5)return this.encodeDelete(t);if(this.state.s_c==22)return this.encodeReconf(t);throw new R("Can't encode request")},encodeWS:function(){return`control\r
`+this.encode(!0)},getValue:function(t,e){return this.m_strategy.getValue(t,e)},getCommandValue:function(t,e,s){return this.m_strategy.getCommandValue(t,e,s)},encodeAdd:function(t){var e=new tt;this.m_lastAddReqId=this.m_client.generateFreshReqId(),e.LS_reqId(this.m_lastAddReqId),e.LS_op("add"),e.LS_subId(this.subId),e.LS_mode(this.m_subscription.fetch_mode());var s=this.m_subscription.getItemGroup(),i=this.m_subscription.fetchItems();s!=null?e.LS_group(s):i!=null&&e.LS_group(i.join(" "));var n=this.m_subscription.getFieldSchema(),r=this.m_subscription.fetchFields();n!=null?e.LS_schema(n):r!=null&&e.LS_schema(r.join(" "));var o=this.m_subscription.getDataAdapter();o!=null&&e.LS_data_adapter(o);var l=this.m_subscription.getSelector();l!=null&&e.LS_selector(l);var v=this.m_subscription.fetch_requestedSnapshot();if(v!=null)switch(v._hx_index){case 0:e.LS_snapshot(!0);break;case 1:e.LS_snapshot(!1);break;case 2:e.LS_snapshot_Int(v.len);break}var D=this.m_currentMaxFrequency;if(D!=null)switch(D._hx_index){case 0:e.LS_requested_max_frequency_Float(D.max);break;case 1:e.LS_requested_max_frequency("unlimited");break;case 2:e.LS_requested_max_frequency("unfiltered");break}var N=this.m_subscription.fetch_requestedBufferSize();if(N!=null)switch(N._hx_index){case 0:e.LS_requested_buffer_size_Int(N.size);break;case 1:e.LS_requested_buffer_size("unlimited");break}return t&&e.LS_ack(!1),m.isInfoEnabled()&&m.info("Sending Subscription add: "+c.string(e)),e.getEncodedString()},encodeDelete:function(t){var e=new tt;return this.m_lastDeleteReqId=this.m_client.generateFreshReqId(),e.LS_reqId(this.m_lastDeleteReqId),e.LS_subId(this.subId),e.LS_op("delete"),t&&e.LS_ack(!1),m.isInfoEnabled()&&m.info("Sending Subscription delete: "+c.string(e)),e.getEncodedString()},encodeReconf:function(t){var e=new tt;this.m_lastReconfReqId=this.m_client.generateFreshReqId(),e.LS_reqId(this.m_lastReconfReqId),e.LS_subId(this.subId),e.LS_op("reconf");var s=this.m_reqMaxFrequency;if(s!=null)switch(s._hx_index){case 0:e.LS_requested_max_frequency_Float(s.max);break;case 1:e.LS_requested_max_frequency("unlimited");break;case 2:e.LS_requested_max_frequency("unfiltered");break}return m.isInfoEnabled()&&m.info("Sending Subscription configuration: "+c.string(e)),e.getEncodedString()},doSetActive:function(){this.m_subscription.setActive()},doSetInactive:function(){this.m_subscription.setInactive()},doSubscribe:function(){this.m_currentMaxFrequency=this.m_subscription.fetch_requestedMaxFrequency()},doUnsubscribe:function(){this.m_strategy.evtUnsubscribe(),this.m_subscription.unrelate(this)},doAbort:function(){this.m_lastAddReqId=null,this.m_lastDeleteReqId=null,this.m_lastReconfReqId=null,this.m_reqMaxFrequency=null,this.m_currentMaxFrequency=this.m_subscription.fetch_requestedMaxFrequency(),this.m_strategy.evtAbort()},genSendControl:function(){this.m_client.evtSendControl(this)},notifyOnSubscription:function(){this.m_subscription.fireOnSubscription(this.subId)},notifyOnUnsubscription:function(){this.m_subscription.fireOnUnsubscription(this.subId)},notifyOnSubscriptionError:function(t,e){this.m_subscription.fireOnSubscriptionError(this.subId,t,e)},notifyOnSubscriptionError_CountMismatch:function(t,e,s,i){this.checkItems(t,s)?this.m_subscription.fireOnSubscriptionError(this.subId,61,"Expected "+e+" fields but got "+i):this.m_subscription.fireOnSubscriptionError(this.subId,61,"Expected "+t+" items but got "+s)},doConfigure:function(){this.m_reqMaxFrequency=this.m_subscription.fetch_requestedMaxFrequency(),this.m_strategy.evtSetRequestedMaxFrequency(this.m_reqMaxFrequency)},doREQOKConfigure:function(){this.m_currentMaxFrequency=this.m_reqMaxFrequency},doSUBOK:function(t,e){this.m_subscription.setSubscribed(this.subId,t,e),this.m_strategy.evtOnSUB(t,e,null,null,null)},doSUBCMD:function(t,e,s,i){this.m_subscription.setSubscribedCMD(this.subId,t,e,s,i),this.m_strategy.evtOnSUB(t,e,s,i,this.m_currentMaxFrequency)},doUNSUB:function(){this.m_strategy.evtOnUNSUB()},doU:function(t,e){if(t>f.sure(this.m_subscription.fetch_nItems()))throw new R("Assertion failure: itemIdx <= m_subscription.fetch_nItems().sure()");this.m_strategy.evtUpdate(t,e)},doEOS:function(t){this.m_strategy.evtOnEOS(t),this.m_subscription.fireOnEndOfSnapshot(t,this.subId)},doCS:function(t){this.m_strategy.evtOnCS(t),this.m_subscription.fireOnClearSnapshot(t,this.subId)},doOV:function(t,e){this.m_subscription.fireOnLostUpdates(t,e,this.subId)},doCONF:function(t){this.m_strategy.evtOnCONF(t)},traceEvent:function(t){C.isTraceEnabled()&&C.trace("sub#"+t+"("+this.subId+") in "+c.string(this.state))},__class__:Qt};var wt=function(t,e){this.s_m=1,this.subId=t,this.lock=e.lock,this.m_client=e,e.relateSubManager(this)};wt.__name__=!0,wt.__interfaces__=[te],wt.prototype={finalize:function(){this.m_client.unrelateSubManager(this)},evtExtAbort:function(){this.traceEvent("abort"),this.s_m==2&&(this.finalize(),this.goto(3))},evtREQERR:function(t,e,s){this.traceEvent("REQERR"),this.s_m==2&&t==this.m_lastDeleteReqId&&(this.finalize(),this.goto(3))},evtREQOK:function(t){this.traceEvent("REQOK"),this.s_m==2&&t==this.m_lastDeleteReqId&&(this.finalize(),this.goto(3))},evtSUBOK:function(t,e){this.traceEvent("SUBOK"),this.s_m==1&&(this.goto(2),this.genSendControl())},evtSUBCMD:function(t,e,s,i){this.traceEvent("SUBCMD"),this.s_m==1&&(this.goto(2),this.genSendControl())},evtUNSUB:function(){this.traceEvent("UNSUB"),this.s_m==2&&(this.finalize(),this.goto(3))},evtU:function(t,e){this.traceEvent("U"),this.s_m==1&&(this.goto(2),this.genSendControl())},evtEOS:function(t){this.traceEvent("EOS"),this.s_m==1&&(this.goto(2),this.genSendControl())},evtCS:function(t){this.traceEvent("CS"),this.s_m==1&&(this.goto(2),this.genSendControl())},evtOV:function(t,e){this.traceEvent("OV"),this.s_m==1&&(this.goto(2),this.genSendControl())},evtCONF:function(t){this.traceEvent("CONF"),this.s_m==1&&(this.goto(2),this.genSendControl())},isPending:function(){return this.s_m==2},encode:function(t){if(this.isPending())return this.encodeDelete(t);throw new R("Can't encode unsubscription request")},encodeWS:function(){return`control\r
`+this.encode(!0)},genSendControl:function(){this.m_client.evtSendControl(this)},encodeDelete:function(t){var e=new tt;return this.m_lastDeleteReqId=this.m_client.generateFreshReqId(),e.LS_reqId(this.m_lastDeleteReqId),e.LS_subId(this.subId),e.LS_op("delete"),t&&e.LS_ack(!1),e.LS_cause("zombie"),m.isInfoEnabled()&&m.info("Sending Subscription delete: "+c.string(e)),e.getEncodedString()},traceEvent:function(t){C.isTraceEnabled()&&C.trace("zsub#"+t+"("+this.subId+") in "+this.s_m)},goto:function(t){this.s_m=t,C.isTraceEnabled()&&C.trace("zsub#goto("+this.subId+") "+this.s_m)},__class__:wt};var Jt=function(){};Jt.__name__=!0,Jt.__interfaces__=[_i],Jt.prototype={__class__:Jt};var ht=function(t,e,s,i){this.m_subId=i,this.itemIdx=t,this.subscription=e,this.client=s,this.lock=s.lock};ht.__name__=!0,ht.prototype={finalize:function(){},evtUpdate:function(t){this.fatalError()},evtOnEOS:function(){this.fatalError()},evtOnCS:function(){this.fatalError()},evtDispose:function(t){this.fatalError()},getValue:function(t){return this.currValues!=null?j.toString(this.currValues.h[t]):null},getCommandValue:function(t,e){throw new R("Unsupported operation")},fatalError:function(){throw new R("Unsupported operation")},doFirstUpdate:function(t){this.doUpdate(t,!1)},doUpdate0:function(t){this.doUpdate(t,!1)},doFirstSnapshot:function(t){this.doUpdate(t,!0)},doSnapshot:function(t){this.doUpdate(t,!0)},doUpdate:function(t,e){var s=this.currValues;this.currValues=Zs(s,t);var i=ys(s,this.currValues),n=Si(s,t),r=new kt(this.itemIdx,this.subscription,this.currValues,i,e,n);this.subscription.fireOnItemUpdate(r,this.m_subId)},__class__:ht};var xt=function(t,e,s,i){this.keys=new J,ht.call(this,t,e,s,i),this.s_m=e.hasSnapshot()?3:1};xt.__name__=!0,xt.__super__=ht,xt.prototype=T(ht.prototype,{finalize:function(){},unrelate:function(t){var e=this.keys;Object.prototype.hasOwnProperty.call(e.h,t)&&delete e.h[t]},evtUpdate:function(t){switch(this.traceEvent("update"),this.s_m){case 1:this.doFirstUpdate(t),this.goto(2);break;case 2:this.doUpdate0(t),this.goto(2);break;case 3:this.doFirstSnapshot(t),this.goto(4);break;case 4:this.doSnapshot(t),this.goto(4);break}},evtOnEOS:function(){switch(this.traceEvent("onEOS"),this.s_m){case 3:this.goto(1);break;case 4:this.goto(2);break}},evtOnCS:function(){throw new R("Unsupported method")},evtDispose:function(t){switch(this.traceEvent("dispose"),this.s_m){case 1:case 2:case 3:case 4:this.finalize(),this.goto(5),this.genDisposeKeys(),t.unrelate(this.itemIdx);break}},getCommandValue:function(t,e){var s=this.keys.h[t];return s!=null?s.getCommandValue(e):null},createKey:function(t){throw new R("Abstract method")},doUpdate:function(t,e){this.currValues=Zs(this.currValues,t),this.selectKey().evtUpdate(this.currValues,e)},genDisposeKeys:function(){for(var t=J.createCopy(this.keys.h).h,e=Object.keys(t),s=e.length,i=0;i<s;)t[e[i++]].evtDispose()},selectKey:function(){var t=this.currValues,s=this.subscription.getKeyPosition(),e=j.toString(t.h[s]),s=this.keys.h[e];return s==null&&(s=this.createKey(e),this.keys.h[e]=s),s},goto:function(t){this.s_m=t,C.isTraceEnabled()&&C.trace("sub#itm#goto("+this.m_subId+":"+this.itemIdx+") in "+this.s_m)},traceEvent:function(t){C.isTraceEnabled()&&C.trace("sub#itm#"+t+"("+this.m_subId+":"+this.itemIdx+") in "+this.s_m)},__class__:xt});var Ue=function(t,e,s,i){xt.call(this,t,e,s,i)};Ue.__name__=!0,Ue.__super__=xt,Ue.prototype=T(xt.prototype,{evtOnCS:function(){switch(this.traceEvent("onCS"),this.s_m){case 1:case 2:case 3:case 4:this.goto(this.s_m),this.genDisposeKeys();break}},createKey:function(t){return new Ge(t,this)},__class__:Ue});var ee=function(t,e,s,i,n){xt.call(this,t,e,i,n),this.strategy=s};ee.__name__=!0,ee.__super__=xt,ee.prototype=T(xt.prototype,{evtOnCS:function(){switch(this.traceEvent("onCS"),this.s_m){case 1:case 2:case 3:case 4:this.goto(this.s_m),this.genDisposeKeys(),this.genOnRealMaxFrequency2LevelRemoved();break}},evtSetRequestedMaxFrequency:function(){switch(this.traceEvent("setRequestedMaxFrequency"),this.s_m){case 1:case 2:case 3:case 4:this.goto(this.s_m),this.genSetRequestedMaxFrequency();break}},createKey:function(t){return new ve(t,this)},genSetRequestedMaxFrequency:function(){for(var t=this.keys.h,e=Object.keys(t),s=e.length,i=0;i<s;)t[e[i++]].evtSetRequestedMaxFrequency()},genOnRealMaxFrequency2LevelRemoved:function(){this.strategy.evtOnRealMaxFrequency2LevelRemoved()},__class__:ee});var He=function(t,e,s,i){ht.call(this,t,e,s,i),this.s_m=e.hasSnapshot()?3:1};He.__name__=!0,He.__super__=ht,He.prototype=T(ht.prototype,{evtUpdate:function(t){switch(this.traceEvent("update"),this.s_m){case 1:this.doFirstUpdate(t),this.goto(2);break;case 2:this.doUpdate0(t),this.goto(2);break;case 3:this.doFirstSnapshot(t),this.goto(4);break;case 4:this.doSnapshot(t),this.goto(4);break}},evtOnEOS:function(){switch(this.traceEvent("onEOS"),this.s_m){case 3:this.goto(1);break;case 4:this.goto(2);break}},evtOnCS:function(){},evtDispose:function(t){switch(this.traceEvent("dispose"),this.s_m){case 1:case 2:case 3:case 4:this.finalize(),this.goto(5),t.unrelate(this.itemIdx);break}},goto:function(t){this.s_m=t,C.isTraceEnabled()&&C.trace("sub#itm#goto("+this.m_subId+":"+this.itemIdx+") "+this.s_m)},traceEvent:function(t){C.isTraceEnabled()&&C.trace("sub#itm#"+t+"("+this.m_subId+":"+this.itemIdx+") in "+this.s_m)},__class__:He});var me=function(){};me.__name__=!0,me.__isInterface__=!0,me.prototype={__class__:me};var Ke=function(t,e,s,i){this.s_m=1,ht.call(this,t,e,s,i)};Ke.__name__=!0,Ke.__super__=ht,Ke.prototype=T(ht.prototype,{evtUpdate:function(t){switch(this.traceEvent("update"),this.s_m){case 1:this.subscription.hasSnapshot()?(this.doSnapshot(t),this.goto(2)):(this.doFirstUpdate(t),this.goto(3));break;case 2:this.doUpdate0(t),this.goto(3);break;case 3:this.doUpdate0(t),this.goto(3);break}},evtDispose:function(t){switch(this.traceEvent("dispose"),this.s_m){case 1:case 2:case 3:this.finalize(),this.goto(4),t.unrelate(this.itemIdx);break}},goto:function(t){this.s_m=t,C.isTraceEnabled()&&C.trace("sub#itm#goto("+this.m_subId+":"+this.itemIdx+") "+this.s_m)},traceEvent:function(t){C.isTraceEnabled()&&C.trace("sub#itm#"+t+"("+this.m_subId+":"+this.itemIdx+") in "+this.s_m)},__class__:Ke});var Ve=function(t,e,s,i){this.s_m=1,ht.call(this,t,e,s,i)};Ve.__name__=!0,Ve.__super__=ht,Ve.prototype=T(ht.prototype,{evtUpdate:function(t){switch(this.traceEvent("update"),this.s_m){case 1:this.doFirstUpdate(t),this.goto(2);break;case 2:this.doUpdate0(t),this.goto(2);break}},evtDispose:function(t){switch(this.traceEvent("dispose"),this.s_m){case 1:case 2:this.finalize(),this.goto(3),t.unrelate(this.itemIdx);break}},goto:function(t){this.s_m=t,C.isTraceEnabled()&&C.trace("sub#itm#goto("+this.m_subId+":"+this.itemIdx+") "+this.s_m)},traceEvent:function(t){C.isTraceEnabled()&&C.trace("sub#itm#"+t+"("+this.m_subId+":"+this.itemIdx+") in "+this.s_m)},__class__:Ve});var dt=function(t,e,s,i,n,r){var o=e.fetch_items(),l=e.fetch_fields(),v=e.fetch_fields2();this.m_itemIdx=t,this.m_items=Ye(o),this.m_nFields=f.sure(e.fetch_nFields()),this.m_fields=Ye(l),this.m_fields2=Ye(v),this.m_newValues=s.copy(),this.m_changedFields=i.copy(),this.m_isSnapshot=n,this.m_jsonPatches=r};dt.__name__=!0,dt.__super__=Jt,dt.prototype=T(Jt.prototype,{getItemName:function(){return this.m_items!=null?this.m_items.h[this.m_itemIdx]:null},getItemPos:function(){return this.m_itemIdx},isSnapshot:function(){return this.m_isSnapshot},getValue:function(t){return typeof t=="number"&&(t|0)===t?this.getValuePos(t):this.getValueName(c.string(t))},isValueChanged:function(t){return typeof t=="number"&&(t|0)===t?this.isValueChangedPos(t):this.isValueChangedName(c.string(t))},_getValueAsJSONPatchIfAvailable:function(t){if(typeof t=="number"&&(t|0)===t)return this.m_jsonPatches.h[t];var e=this.getFieldIdxFromName(c.string(t));return e!=null?this.m_jsonPatches.h[e]:null},getValueAsJSONPatchIfAvailable:function(t){return this._getValueAsJSONPatchIfAvailable(t)},forEachChangedField:function(t){for(var e=this.m_changedFields.iterator();e.current<e.array.length;){var s=e.array[e.current++];try{t(this.getFieldNameFromIdx(s),s,j.toString(this.m_newValues.h[s]))}catch(n){var i=g.caught(n);w.isErrorEnabled()&&w.error(`An exception was thrown while executing the Function passed to the forEachChangedField method
`+i.details())}}},forEachField:function(t){for(var e=this.m_newValues,s=e.keys();s.hasNext();){var i=s.next(),n=e.get(i);try{t(this.getFieldNameFromIdx(i),i,j.toString(n))}catch(o){var r=g.caught(o);w.isErrorEnabled()&&w.error(`An exception was thrown while executing the Function passed to the forEachField method
`+r.details())}}},getValuePos:function(t){return j.toString(this.m_newValues.h[t])},getValueName:function(t){if(this.m_fields==null&&this.m_fields2==null)throw new R(Hs);var e=this.getFieldIdxFromName(t);if(e==null)throw new y(Ks);return j.toString(this.m_newValues.h[e])},isValueChangedPos:function(t){return this.m_changedFields.contains(t)},isValueChangedName:function(t){if(this.m_fields==null&&this.m_fields2==null)throw new R(Hs);var e=this.getFieldIdxFromName(t);if(e==null)throw new y(Ks);return this.m_changedFields.contains(e)},getFieldNameFromIdx:function(t){return t<=this.m_nFields?this.m_fields!=null?this.m_fields.h[t]:null:this.m_fields2!=null?this.m_fields2.h[t-this.m_nFields]:null},getFieldIdxFromName:function(t){var e,s,i,n=this.m_fields;if(n!=null?(s=As(f.sure(n),t),i=s!=null):i=!1,i)return s;var i;return e=this.m_fields2,e!=null?(s=As(f.sure(e),t),i=s!=null):i=!1,i?this.m_nFields+f.sure(s):null},toString:function(){var t="";t="[";for(var e=this.m_newValues,s=e.keys();s.hasNext();){var i=s.next(),n=e.get(i),r=this.getFieldNameFromIdx(i),o=r??(i==null?"null":""+i),l=c.string(n);i>1&&(t+=","),t+=o==null?"null":""+o,t+=":",t+=l==null?"null":""+l}return t+="]",t},__class__:dt});var kt=function(t,e,s,i,n,r){var o=e.fetch_items(),l=e.fetch_fields();this.m_itemIdx=t,this.m_items=Ye(o),this.m_nFields=f.sure(e.fetch_nFields()),this.m_fields=Ye(l),l!=null&&l.length!=this.m_nFields&&G.isErrorEnabled()&&G.error("Expected "+this.m_nFields+" field names but got "+l.length+": "+c.string(l)),this.m_newValues=s.copy(),this.m_changedFields=i.copy(),this.m_isSnapshot=n,this.m_jsonPatches=r};kt.__name__=!0,kt.__super__=Jt,kt.prototype=T(Jt.prototype,{getItemName:function(){return this.m_items!=null?this.m_items.h[this.m_itemIdx]:null},getItemPos:function(){return this.m_itemIdx},isSnapshot:function(){return this.m_isSnapshot},getValue:function(t){return typeof t=="number"&&(t|0)===t?this.getValuePos(t):this.getValueName(c.string(t))},isValueChanged:function(t){return typeof t=="number"&&(t|0)===t?this.isValueChangedPos(t):this.isValueChangedName(c.string(t))},_getValueAsJSONPatchIfAvailable:function(t){if(typeof t=="number"&&(t|0)===t)return this.m_jsonPatches.h[t];var e=this.getFieldIdxFromName(c.string(t));return this.m_jsonPatches.h[e]},getValueAsJSONPatchIfAvailable:function(t){return this._getValueAsJSONPatchIfAvailable(t)},forEachChangedField:function(t){for(var e=this.m_changedFields.iterator();e.current<e.array.length;){var s=e.array[e.current++];try{t(this.m_fields!=null?this.m_fields.h[s]:null,s,j.toString(this.m_newValues.h[s]))}catch(n){var i=g.caught(n);w.isErrorEnabled()&&w.error(`An exception was thrown while executing the Function passed to the forEachChangedField method
`+i.details())}}},forEachField:function(t){for(var e=this.m_newValues,s=e.keys();s.hasNext();){var i=s.next(),n=e.get(i);try{t(this.m_fields!=null?this.m_fields.h[i]:null,i,j.toString(n))}catch(o){var r=g.caught(o);w.isErrorEnabled()&&w.error(`An exception was thrown while executing the Function passed to the forEachField method
`+r.details())}}},getValuePos:function(t){if(!(1<=t&&t<=this.m_nFields))throw new y(si);return j.toString(this.m_newValues.h[t])},getValueName:function(t){var e=this.getFieldIdxFromName(t);return j.toString(this.m_newValues.h[e])},isValueChangedPos:function(t){if(!(1<=t&&t<=this.m_nFields))throw new y(si);return this.m_changedFields.contains(t)},isValueChangedName:function(t){var e=this.getFieldIdxFromName(t);return this.m_changedFields.contains(e)},getFieldNameOrNullFromIdx:function(t){return this.m_fields!=null?this.m_fields.h[t]:null},getFieldIdxFromName:function(t){if(this.m_fields==null)throw new R(Hs);var e=As(this.m_fields,t);if(e==null)throw new y(Ks);return e},toString:function(){var t="";t="[";for(var e=this.m_newValues,s=e.keys();s.hasNext();){var i=s.next(),n=e.get(i),r=this.getFieldNameOrNullFromIdx(i),o=r??(i==null?"null":""+i),l=c.string(n);i>1&&(t+=","),t+=o==null?"null":""+o,t+=":",t+=l==null?"null":""+l}return t+="]",t},__class__:kt});var Ge=function(t,e){this.s_m=1,this.keyName=t,this.item=e,this.lock=e.lock};Ge.__name__=!0,Ge.__interfaces__=[me],Ge.prototype={finalize:function(){this.currKeyValues=null,this.item.unrelate(this.keyName)},evtUpdate:function(t,e){switch(this.traceEvent("update"),this.s_m){case 1:this.isDelete(t)?(this.doLightDelete(t,e),this.finalize(),this.goto(3)):(this.doFirstUpdate(t,e),this.goto(2));break;case 2:this.isDelete(t)?(this.doDelete(t,e),this.finalize(),this.goto(3)):(this.doUpdate(t,e),this.goto(2));break}},evtDispose:function(){switch(this.traceEvent("dispose"),this.s_m){case 1:case 2:this.finalize(),this.goto(3);break}},evtSetRequestedMaxFrequency:function(){},getCommandValue:function(t){return this.currKeyValues!=null?j.toString(this.currKeyValues.h[t]):null},doFirstUpdate:function(t,e){var s=f.sure(this.item.subscription.fetch_nFields()),i=this.item.subscription.getCommandPosition();this.currKeyValues=t,this.currKeyValues.h[i]=Z.StringVal("ADD");var n=new Q(new et(1,s+1));this.fireOnItemUpdate(new kt(this.item.itemIdx,this.item.subscription,this.currKeyValues,n,e,new q))},doUpdate:function(t,e){var s=this.item.subscription.getCommandPosition(),i=this.currKeyValues;this.currKeyValues=t,this.currKeyValues.h[s]=Z.StringVal("UPDATE");var n=ys(i,this.currKeyValues);this.fireOnItemUpdate(new kt(this.item.itemIdx,this.item.subscription,this.currKeyValues,n,e,new q))},doLightDelete:function(t,e){this.currKeyValues=null;var s=new Q(t.keys()),i=new kt(this.item.itemIdx,this.item.subscription,this.nullify(t),s,e,new q);this.item.unrelate(this.keyName),this.fireOnItemUpdate(i)},doDelete:function(t,e){this.currKeyValues=null;var s=new Q(t.keys()).subtracting([this.item.subscription.getKeyPosition()]),i=new kt(this.item.itemIdx,this.item.subscription,this.nullify(t),s,e,new q);this.item.unrelate(this.keyName),this.fireOnItemUpdate(i)},nullify:function(t){for(var e=new q,s=t,i=s.keys();i.hasNext();){var n=i.next(),r=s.get(n),o=n==this.item.subscription.getCommandPosition()||n==this.item.subscription.getKeyPosition();e.h[n]=o?r:null}return e},isDelete:function(t){var e=this.item.subscription.getCommandPosition();return j.toString(t.h[e])=="DELETE"},fireOnItemUpdate:function(t){this.item.subscription.fireOnItemUpdate(t,this.item.m_subId)},goto:function(t){this.s_m=t,this.traceEvent("goto")},traceEvent:function(t){if(C.isTraceEnabled()){var e=this.item.m_subId,s=this.item.itemIdx;C.isTraceEnabled()&&C.trace("sub#key#"+t+"("+e+":"+s+":"+this.keyName+") in "+this.s_m)}},__class__:Ge};var ve=function(t,e){this.s_m=1,this.keyName=t,this.item=e,this.lock=e.lock};ve.__name__=!0,ve.__interfaces__=[me],ve.prototype={finalize:function(){this.currKeyValues=null,this.currKey2Values=null,this.item.unrelate(this.keyName)},evtUpdate:function(t,e){switch(this.traceEvent("update"),this.s_m){case 1:if(this.isDelete(t))this.doLightDelete(t,e),this.finalize(),this.goto(11),this.genOnRealMaxFrequency2LevelRemoved();else{var s=this.create2LevelSubscription();s!=null?(this.doFirstUpdate(t,e),this.subscription2Level=s,this.goto(4),this.item.strategy.client.subscribeExt(s,!0)):(this.doFirstUpdate(t,e),this.notify2LevelIllegalArgument(),this.goto(3))}break;case 3:this.isDelete(t)?(this.doDelete1LevelOnly(t,e),this.finalize(),this.goto(11),this.genOnRealMaxFrequency2LevelRemoved()):(this.doUpdate(t,e),this.goto(3));break;case 4:this.isDelete(t)?(this.doDelete(t,e),this.finalize(),this.goto(11),this.genOnRealMaxFrequency2LevelRemoved()):(this.doUpdate(t,e),this.goto(4));break;case 5:this.isDelete(t)?(this.doDeleteExt(t,e),this.finalize(),this.goto(11),this.genOnRealMaxFrequency2LevelRemoved()):(this.doUpdate1Level(t,e),this.goto(5));break}},evtDispose:function(){switch(this.traceEvent("dispose"),this.s_m){case 1:case 2:case 3:this.finalize(),this.goto(10);break;case 4:case 5:this.doUnsubscribe(),this.finalize(),this.goto(12);break}},evtOnSubscriptionError2Level:function(t,e){this.traceEvent("onSubscriptionError2Level"),this.s_m==4&&(this.notify2LevelSubscriptionError(t,e),this.goto(3))},evtUpdate2Level:function(t){switch(this.traceEvent("update2Level"),this.s_m){case 4:this.doUpdate2Level(t),this.goto(5);break;case 5:this.doUpdate2Level(t),this.goto(5);break}},evtOnUnsubscription2Level:function(){switch(this.traceEvent("onUnsubscription2Level"),this.s_m){case 4:case 5:this.doUnsetRealMaxFrequency(),this.goto(this.s_m),this.genOnRealMaxFrequency2LevelRemoved();break}},evtOnItemLostUpdates2Level:function(t){switch(this.traceEvent("onItemLostUpdates2Level"),this.s_m){case 4:case 5:this.goto(this.s_m),this.notify2LevelLostUpdates(t);break}},evtOnRealMaxFrequency2Level:function(t){switch(this.traceEvent("onRealMaxFrequency2Level"),this.s_m){case 4:case 5:this.doSetRealMaxFrequency(t),this.goto(this.s_m),this.genOnRealMaxFrequency2LevelAdded();break}},evtSetRequestedMaxFrequency:function(){switch(this.traceEvent("setRequestedMaxFrequency"),this.s_m){case 4:case 5:this.doChangeRequestedMaxFrequency(),this.goto(this.s_m);break}},getCommandValue:function(t){var e=this.currKeyValues;if(e!=null&&e.h[t]!=null)return j.toString(e.h[t]);var e=this.currKey2Values,s=this.item.subscription.fetch_nFields();return e!=null&&s!=null?e.h[t-s]:null},doFirstUpdate:function(t,e){var s=this.item.subscription.getCommandPosition();this.currKeyValues=t,this.currKeyValues.h[s]=Z.StringVal("ADD");var i=ys(null,this.currKeyValues);this.fireOnItemUpdate(new dt(this.item.itemIdx,this.item.subscription,this.currKeyValues,i,e,new q))},doUpdate:function(t,e){var s=this.item.subscription.getCommandPosition(),i=this.currKeyValues;this.currKeyValues=t,this.currKeyValues.h[s]=Z.StringVal("UPDATE");var n=ys(i,this.currKeyValues);this.fireOnItemUpdate(new dt(this.item.itemIdx,this.item.subscription,this.currKeyValues,n,e,new q))},doUpdate2Level:function(t){var e=this.item.subscription.getCommandPosition(),s=f.sure(this.item.subscription.fetch_nFields()),i=f.sure(this.currKeyValues).copy();this.currKeyValues.h[e]=Z.StringVal("UPDATE"),this.currKey2Values=yi(t);for(var n=f.sure(this.currKeyValues).copy(),N=this.currKey2Values,F=N.keys();F.hasNext();){var r=F.next(),o=N.get(r);n.h[r+s]=o==null?null:Z.StringVal(o)}var l=new Q;j.toString(i.h[e])!=j.toString(this.currKeyValues.h[e])&&l.insert(e);for(var N=wi(t),F=N.keys();F.hasNext();){var r=F.next();N.get(r),l.insert(r+s)}for(var v=t.isSnapshot(),D=new q,N=this.currKey2Values,F=N.keys();F.hasNext();){var r=F.next();N.get(r);var rt=t.getValueAsJSONPatchIfAvailable(r);rt!=null&&(D.h[r+s]=rt)}this.fireOnItemUpdate(new dt(this.item.itemIdx,this.item.subscription,n,l,v,D))},doUpdate1Level:function(t,e){var s=this.item.subscription.getCommandPosition(),i=f.sure(this.item.subscription.fetch_nFields()),n=f.sure(this.currKeyValues);this.currKeyValues=t,this.currKeyValues.h[s]=Z.StringVal("UPDATE");for(var r=f.sure(this.currKeyValues).copy(),o=f.sure(this.currKey2Values),l=o.keys();l.hasNext();){var v=l.next(),D=o.get(v);r.h[v+i]=D==null?null:Z.StringVal(D)}for(var N=new Q,F=1,rt=i+1;F<rt;){var V=F++;j.toString(n.h[V])!=j.toString(r.h[V])&&N.insert(V)}this.fireOnItemUpdate(new dt(this.item.itemIdx,this.item.subscription,r,N,e,new q))},doDelete:function(t,e){var s=f.sure(this.item.subscription.fetch_nFields()),i=this.item.subscription.getKeyPosition(),n=this.item.subscription.getCommandPosition();this.currKeyValues=null;for(var r=new Q(new et(1,s+1)).subtracting([i]),o=new q,l=1,v=s+1;l<v;)o.h[l++]=null;o.h[i]=Z.StringVal(this.keyName),o.h[n]=Z.StringVal("DELETE");var D=new dt(this.item.itemIdx,this.item.subscription,o,r,e,new q);this.item.unrelate(this.keyName);var N=f.sure(this.subscription2Level);N.removeListener(f.sure(this.listener2Level)),f.sure(this.listener2Level).disable(),this.subscription2Level=null,this.listener2Level=null,this.item.strategy.client.unsubscribe(N),this.fireOnItemUpdate(D)},doDeleteExt:function(t,e){var s=f.sure(this.item.subscription.fetch_nFields()),i=this.item.subscription.getKeyPosition(),n=this.item.subscription.getCommandPosition(),r=s+P.count(f.sure(this.currKey2Values));this.currKeyValues=null,this.currKey2Values=null;for(var o=new Q(new et(1,r+1)).subtracting([i]),l=new q,v=1,D=r+1;v<D;)l.h[v++]=null;l.h[i]=Z.StringVal(this.keyName),l.h[n]=Z.StringVal("DELETE");var N=new dt(this.item.itemIdx,this.item.subscription,l,o,e,new q);this.item.unrelate(this.keyName);var F=f.sure(this.subscription2Level);F.removeListener(f.sure(this.listener2Level)),f.sure(this.listener2Level).disable(),this.subscription2Level=null,this.listener2Level=null,this.item.strategy.client.unsubscribe(F),this.fireOnItemUpdate(N)},doLightDelete:function(t,e){var s=f.sure(this.item.subscription.fetch_nFields()),i=this.item.subscription.getKeyPosition(),n=this.item.subscription.getCommandPosition();this.currKeyValues=null;for(var r=new Q(new et(1,s+1)),o=new q,l=1,v=s+1;l<v;)o.h[l++]=null;o.h[i]=t.h[i],o.h[n]=t.h[n],this.fireOnItemUpdate(new dt(this.item.itemIdx,this.item.subscription,o,r,e,new q))},doDelete1LevelOnly:function(t,e){var s=f.sure(this.item.subscription.fetch_nFields()),i=this.item.subscription.getKeyPosition(),n=this.item.subscription.getCommandPosition();this.currKeyValues=null;for(var r=new Q(new et(1,s+1)).subtracting([i]),o=new q,l=1,v=s+1;l<v;)o.h[l++]=null;o.h[i]=t.h[i],o.h[n]=t.h[n],this.fireOnItemUpdate(new dt(this.item.itemIdx,this.item.subscription,o,r,e,new q))},doChangeRequestedMaxFrequency:function(){f.sure(this.subscription2Level).setRequestedMaxFrequency(Lt.toString(this.item.strategy.requestedMaxFrequency))},doSetRealMaxFrequency:function(t){this.realMaxFrequency=t},doUnsetRealMaxFrequency:function(){this.realMaxFrequency=null},genOnRealMaxFrequency2LevelAdded:function(){this.item.strategy.evtOnRealMaxFrequency2LevelAdded(this.realMaxFrequency)},genOnRealMaxFrequency2LevelRemoved:function(){this.item.strategy.evtOnRealMaxFrequency2LevelRemoved()},doUnsubscribe:function(){if(this.subscription2Level==null)throw new R("Assertion failure: subscription2Level != null");if(this.listener2Level==null)throw new R("Assertion failure: listener2Level != null");var t=this.subscription2Level;t.removeListener(this.listener2Level),this.listener2Level.disable(),this.subscription2Level=null,this.listener2Level=null,this.item.strategy.client.unsubscribe(t)},notify2LevelIllegalArgument:function(){this.listener2Level=null,this.subscription2Level=null,this.item.subscription.fireOnSubscriptionError2Level(this.keyName,14,"The received key value is not a valid name for an Item",this.item.m_subId,this.item.itemIdx)},notify2LevelSubscriptionError:function(t,e){this.listener2Level=null,this.subscription2Level=null,this.item.subscription.fireOnSubscriptionError2Level(this.keyName,t,e,this.item.m_subId,this.item.itemIdx)},notify2LevelLostUpdates:function(t){this.item.subscription.fireOnLostUpdates2Level(this.keyName,t,this.item.m_subId,this.item.itemIdx)},fireOnItemUpdate:function(t){this.item.subscription.fireOnItemUpdate(t,this.item.m_subId)},create2LevelSubscription:function(){this.listener2Level=new ze(this);var t=this.item.subscription,e=new ds("MERGE",null,null),s=[this.keyName];if(!Ut.allValidNames(s))return null;e.setItems(s.slice());var i=t.getCommandSecondLevelFields();return i!=null?e.setFields(i):e.setFieldSchema(t.getCommandSecondLevelFieldSchema()),e.setDataAdapter(t.getCommandSecondLevelDataAdapter()),e.setRequestedSnapshot(we.toString(Ct.SnpYes)),e.setRequestedMaxFrequency(Lt.toString(this.item.strategy.requestedMaxFrequency)),e.addListener(f.sure(this.listener2Level)),e.setInternal(),e},isDelete:function(t){var e=this.item.subscription.getCommandPosition();return j.toString(t.h[e])=="DELETE"},goto:function(t){this.s_m=t,this.traceEvent("goto")},traceEvent:function(t){if(C.isTraceEnabled()){var e=this.item.m_subId,s=this.item.itemIdx;C.isTraceEnabled()&&C.trace("sub#key#"+t+"("+e+":"+s+":"+this.keyName+") in "+this.s_m)}},__class__:ve};var ze=function(t){this.m_disabled=!1,this.key=t};ze.__name__=!0,ze.__interfaces__=[fi],ze.prototype={disable:function(){var t=this;this.key.lock.synchronized(function(){return t.m_disabled=!0})},synchronized:function(t){var e=this;this.key.lock.synchronized(function(){e.m_disabled||t()})},onSubscriptionError:function(t,e){var s=this;this.synchronized(function(){s.key.evtOnSubscriptionError2Level(t,e)})},onItemUpdate:function(t){var e=this;this.synchronized(function(){e.key.evtUpdate2Level(t)})},onItemLostUpdates:function(t,e,s){var i=this;this.synchronized(function(){i.key.evtOnItemLostUpdates2Level(s)})},onRealMaxFrequency:function(t){var e=this;this.synchronized(function(){var s=e.key,i;if(t==null)i=null;else{var n;if(t==null){n=parseFloat(t);var r=n;i=isNaN(r)?null:Dt.RFreqLimited(r)}else if(t=="unlimited")i=Dt.RFreqUnlimited;else{n=parseFloat(t);var r=n;i=isNaN(r)?null:Dt.RFreqLimited(r)}}s.evtOnRealMaxFrequency2Level(i)})},onUnsubscription:function(){var t=this;this.synchronized(function(){t.key.evtOnUnsubscription2Level()})},onClearSnapshot:function(t,e){},onCommandSecondLevelItemLostUpdates:function(t,e){},onCommandSecondLevelSubscriptionError:function(t,e,s){},onEndOfSnapshot:function(t,e){},onListenEnd:function(t){},onListenStart:function(t){},onSubscription:function(){},__class__:ze};var Z=p["com.lightstreamer.client.internal.update.CurrFieldVal"]={__ename__:!0,__constructs__:null,StringVal:(u=function(t){return{_hx_index:0,string:t,__enum__:"com.lightstreamer.client.internal.update.CurrFieldVal",toString:h}},u._hx_name="StringVal",u.__params__=["string"],u),JsonVal:(u=function(t){return{_hx_index:1,json:t,__enum__:"com.lightstreamer.client.internal.update.CurrFieldVal",toString:h}},u._hx_name="JsonVal",u.__params__=["json"],u)};Z.__constructs__=[Z.StringVal,Z.JsonVal];var j=function(){};j.__name__=!0,j.toString=function(t){if(t==null)return null;switch(t._hx_index){case 0:return t.string;case 1:return Kt.toString(t.json)}};function Zs(t,e){if(t!=null){for(var s=new q,i=e,n=i.keys();n.hasNext();){var r=n.next(),o=i.get(r);switch(o._hx_index){case 0:s.h[r]=t.h[r];break;case 1:var l=o.val;l==null?s.h[r]=null:s.h[r]=Z.StringVal(l);break;case 2:var v=o.patch,D=t.h[r];if(D==null)throw new R("Cannot apply the JSON patch to the field "+r+" because the field is null");switch(D._hx_index){case 0:var N=D.string,F=null;try{F=Kt._new(N)}catch(_s){var rt=g.caught(_s);throw x.isErrorEnabled()&&x.error(""+rt.get_message()+`
`+rt.details()),new R("Cannot convert the field "+r+" to JSON")}try{var V=Z.JsonVal(Kt.apply(f.sure(F),v));s.h[r]=V}catch(_s){var gt=g.caught(_s);throw x.isErrorEnabled()&&x.error(""+gt.get_message()+`
`+gt.details()),new R("Cannot apply the JSON Patch to the field "+r)}break;case 1:var Vt=D.json;try{var bt=Z.JsonVal(Kt.apply(Vt,v));s.h[r]=bt}catch(_s){var ct=g.caught(_s);throw x.isErrorEnabled()&&x.error(""+ct.get_message()+`
`+ct.details()),new R("Cannot apply the JSON Patch to the field "+r)}break}break;case 3:var Ie=o.patch,cs=t.h[r];if(cs==null)throw new R("Cannot apply the TLCP-diff to the field "+r+" because the field is null");switch(cs._hx_index){case 0:var Ai=Z.StringVal(new ie(cs.string,Ie).decode());s.h[r]=Ai;break;case 1:throw new R("Cannot apply the TLCP-diff to the field "+r+" because the field is JSON")}break}}return s}else{for(var s=new q,i=e,n=i.keys();n.hasNext();){var r=n.next(),o=i.get(r);switch(o._hx_index){case 0:throw new R("Cannot set the field "+r+" because the first update is UNCHANGED");case 1:var l=o.val;l==null?s.h[r]=null:s.h[r]=Z.StringVal(l);break;case 2:throw new R("Cannot set the field "+r+" because the first update is a JSONPatch");case 3:throw new R("Cannot set the field "+r+" because the first update is a TLCP-diff")}}return s}}function ys(t,e){if(t!=null){for(var s=new Q,i=e,n=i.keys();n.hasNext();){var r=n.next();i.get(r),j.toString(t.h[r])!=j.toString(e.h[r])&&s.insert(r)}return s}else{for(var s=new Q,i=e,n=i.keys();n.hasNext();){var r=n.next();i.get(r),s.insert(r)}return s}}function Si(t,e){if(t!=null){for(var s=new q,i=e,n=i.keys();n.hasNext();){var r=n.next(),o=i.get(r);switch(o._hx_index){case 0:var l=t.h[r];if(l!=null&&(l!=null&&l._hx_index==1)){var v=Kt._new("[]");s.h[r]=v}break;case 2:s.h[r]=o.patch;break}}return s}else return new q}function Ye(t){if(t!=null){for(var e=new q,s=0;s<t.length;){var i=t[s++];e.h[s-1+1]=i}return e}return null}function As(t,e){for(var s=1,i=P.count(t)+1;s<i;){var n=s++;if(t.h[n]==e)return n}return null}function yi(t){var e=new q;return t.forEachField(function(s,i,n){e.h[i]=n}),e}function wi(t){var e=new q;return t.forEachChangedField(function(s,i,n){e.h[i]=n}),e}var qs=function(){};qs.__name__=!0,qs.prototype={submit:function(t){Ot(t)},schedule:function(t,e){return new je(Vs(t,e))},stop:function(){},__class__:qs};var je=function(t){this.handle=t};je.__name__=!0,je.prototype={isCanceled:function(){return this.handle==null},cancel:function(){this.handle!=null&&(Fi(this.handle),this.handle=null)},__class__:je};var Ft=function(){this.hasMicroTasks=typeof a.queueMicrotask<"u",this.hasWorkers=typeof Worker<"u"};Ft.__name__=!0,Ft.prototype={toString:function(){return"{ hasWorkers: "+c.string(this.hasWorkers)+", hasMicroTasks: "+c.string(this.hasMicroTasks)+" }"},__class__:Ft};var Qe=function(){};Qe.__name__=!0,Qe.__isInterface__=!0,Qe.prototype={__class__:Qe};var Je=function(t,e,s,i,n,r,o){this.isCanceled=!1,this.reader=new Es;var l=this;if(H.isDebugEnabled()&&H.debug("HTTP sending: "+t+" "+e+" headers("+(s==null?"null":J.stringify(s.h))+")"),this.xhr=new XMLHttpRequest,this.xhr.open("POST",t),this.xhr.withCredentials=i,s!=null)for(var v=s.h,D=Object.keys(v),N=D.length,F=0;F<N;){var rt=D[F++];this.xhr.setRequestHeader(rt,v[rt])}this.xhr.setRequestHeader("Content-Type","text/plain; charset=utf-8"),this.xhr.send(e),this.xhr.onreadystatechange=function(){if(!l.isCanceled){var V=l.xhr.readyState;if(V==2){var gt=l.xhr.status;gt==0||gt>=200&&gt<300||(H.isDebugEnabled()&&H.debug("HTTP event: error(HTTP code "+gt+")"),r(l,"Unexpected HTTP code: "+gt),l.xhr.abort())}else if(V>2){for(var Vt=V==3?l.reader.extractNewData(l.xhr.responseText,!1):l.reader.extractNewData(l.xhr.responseText,!0),bt=0;bt<Vt.length;){var ct=Vt[bt];if(++bt,l.isCanceled)return;ct!=""&&(H.isDebugEnabled()&&H.debug("HTTP event: text("+ct+")"),n(l,ct))}V==4&&(H.isDebugEnabled()&&H.debug("HTTP event: complete"),o(l))}}},this.xhr.onerror=function(){l.isCanceled||(H.isDebugEnabled()&&H.debug("HTTP event: error(Network error)"),r(l,"Network error"))}};Je.__name__=!0,Je.__interfaces__=[Qe],Je.prototype={dispose:function(){H.isDebugEnabled()&&H.debug("HTTP disposing"),this.isCanceled=!0,this.xhr.abort()},isDisposed:function(){return this.isCanceled},__class__:Je};var I={};I._new=function(){return new J},I.set=function(t,e,s){s!=null&&(t.h[e]=s==null?"null":c.string(s))};var At=function(){this.values=[],this.nRemoved=0};At.__name__=!0,At.prototype={get_length:function(){return this.values.length-this.nRemoved},compact:function(){this.nRemoved>this.values.length/2&&(this.nRemoved=0,this.values=this.copy().values)},push:function(t){this.values.push(new qt(t))},remove:function(t){for(var e=0,s=this.values.length;e<s;){var i=e++;if(this.values[i].item==t&&this.values[i].isValid){this.nRemoved++,this.values[i].isValid=!1;break}}},filter:function(t){for(var e=new At,s=new X(this);s.hasNext();){var i=s.next();t(i)&&e.values.push(new qt(i))}return e},map:function(t){for(var e=new At,s=new X(this);s.hasNext();){var i=t(s.next());e.values.push(new qt(i))}return e},exists:function(t){return P.exists(this,t)},find:function(t){return P.find(this,t)},contains:function(t){return P.has(this,t)},iterator:function(){return new X(this)},copy:function(){for(var t=new At,e=new X(this);e.hasNext();){var s=e.next();t.values.push(new qt(s))}return t},toString:function(){for(var t=0,e=this.values.length-this.nRemoved,s="[",i=new X(this);i.hasNext();)s+=c.string(i.next())+(t!=e-1?", ":""),++t;return s+"]"},__class__:At};var qt=function(t){this.isValid=!0,this.item=t};qt.__name__=!0,qt.prototype={__class__:qt};var X=function(t){this.a=t,this.index=0};X.__name__=!0,X.prototype={hasNext:function(){for(var t=this.index,e=this.a.values.length;t<e;)if(this.a.values[t++].isValid)return!0;return!1},next:function(){for(var t=this.index,e=this.a.values.length;t<e;){var s=t++;if(this.a.values[s].isValid)return this.index=s+1,this.a.values[s].item}throw new g("No such element")},__class__:X};var R=function(t,e,s){g.call(this,t,e,s),this.__skipStack++};R.__name__=!0,R.__super__=g,R.prototype=T(g.prototype,{__class__:R});var Bt={};Bt.fromHaxeMap=function(t){return Bt.fromMapToDynamicAccess(t)},Bt.toHaxeMap=function(t){return Bt.toHaxe(t)},Bt.fromMapToDynamicAccess=function(t){for(var e={},s=t.h,i=Object.keys(s),n=i.length,r=0;r<n;){var o=i[r++];e[o]=s[o]}return e},Bt.toHaxe=function(t){for(var e=new J,s=W.fields(t),i=0;i<s.length;){var n=s[i++];e.h[n]=t[n]}return e},Bt.toDynamicAccess=function(t){return W.copy(t)};var mt={};mt.fromHaxeArray=function(t){return t.slice()},mt.toHaxeArray=function(t){return mt.copy(t,t)},mt._new=function(t){return t.slice()},mt.toHaxe=function(t){return mt.copy(t,t)},mt.copy=function(t,e){for(var s=[],i=0,n=e.length;i<n;)s[i]=e[i],++i;return s};var f=function(){};f.__name__=!0,f.sure=function(t){if(t==null)throw g.thrown("null pointer in .sure() call");return t},f.or=function(t,e){return t??e};var se=function(){};se.__name__=!0,se.__isInterface__=!0,se.prototype={__class__:se};var pe=function(){this._innerMap=new q,this._orderedKeys=new At};pe.__name__=!0,pe.__interfaces__=[se],pe.prototype={compact:function(){this._orderedKeys.compact()},set:function(t,e){this._innerMap.h.hasOwnProperty(t)||this._orderedKeys.values.push(new qt(t)),this._innerMap.h[t]=e},get:function(t){return this._innerMap.h[t]},exists:function(t){return this._innerMap.h.hasOwnProperty(t)},remove:function(t){var e=this._innerMap.remove(t);return e&&this._orderedKeys.remove(t),e},keys:function(){return new X(this._orderedKeys)},iterator:function(){return new ws(this)},keyValueIterator:function(){return new Is(this)},copy:function(){var t=new pe;return t._orderedKeys=this._orderedKeys.copy(),t._innerMap=this._innerMap.copy(),t},get_length:function(){var t=this._orderedKeys;return t.values.length-t.nRemoved},keysCopy:function(){return this._orderedKeys.copy()},clear:function(){this._orderedKeys=new At,this._innerMap=new q},toString:function(){for(var t=0,e=this._orderedKeys,s=e.values.length-e.nRemoved,i="[",n=new X(this._orderedKeys);n.hasNext();){var r=n.next();i+=r+" => "+c.string(this._innerMap.h[r])+(t!=s-1?", ":""),++t}return i+"]"},__class__:pe};var ws=function(t){this.map=t,this.it=new X(t._orderedKeys)};ws.__name__=!0,ws.prototype={hasNext:function(){return this.it.hasNext()},next:function(){var t=this.map,e=this.it.next();return t._innerMap.h[e]},__class__:ws};var $e=function(){};$e.__name__=!0,$e.__isInterface__=!0,$e.prototype={__class__:$e};var Ze=function(){};Ze.__name__=!0,Ze.__isInterface__=!0,Ze.prototype={__class__:Ze};var Xe=p["com.lightstreamer.internal.ReachabilityStatus"]={__ename__:!0,__constructs__:null,RSReachable:{_hx_name:"RSReachable",_hx_index:0,__enum__:"com.lightstreamer.internal.ReachabilityStatus",toString:h},RSNotReachable:{_hx_name:"RSNotReachable",_hx_index:1,__enum__:"com.lightstreamer.internal.ReachabilityStatus",toString:h}};Xe.__constructs__=[Xe.RSReachable,Xe.RSNotReachable];var ts=function(){};ts.__name__=!0,ts.__isInterface__=!0,ts.prototype={__class__:ts};var es=p["com.lightstreamer.internal.PageState"]={__ename__:!0,__constructs__:null,Frozen:{_hx_name:"Frozen",_hx_index:0,__enum__:"com.lightstreamer.internal.PageState",toString:h},Resumed:{_hx_name:"Resumed",_hx_index:1,__enum__:"com.lightstreamer.internal.PageState",toString:h}};es.__constructs__=[es.Frozen,es.Resumed];var ss=function(){};ss.__name__=!0,ss.__isInterface__=!0,ss.prototype={__class__:ss};var is=function(t){this.connectionOptions=t.connectionOptions};is.__name__=!0,is.__interfaces__=[ss],is.prototype={createWsClient:function(t,e,s,i,n){return new ls(t,s,i,n)},createHttpClient:function(t,e,s,i,n,r){return new Je(t,e,s,this.connectionOptions.isCookieHandlingRequired(),i,n,r)},createCtrlClient:function(t,e,s,i,n,r){return this.createHttpClient(t,e,s,i,n,r)},createReachabilityManager:function(t){return new ns},createTimer:function(t,e,s){return new as(t,e,s)},randomMillis:function(t){return c.random(t)},createPageLifecycleFactory:function(t){return new Yt(t)},__class__:is};var ns=function(){};ns.__name__=!0,ns.__interfaces__=[ts],ns.prototype={startListening:function(t){E.get_supported()&&(window.ononline=function(){t(Xe.RSReachable)},window.onoffline=function(){t(Xe.RSNotReachable)})},stopListening:function(){E.get_supported()&&(window.ononline=null,window.onoffline=null)},__class__:ns};var bs=function(t,e){this.key=t,this.val=e};bs.__name__=!0,bs.prototype={toEncodedPair:function(){var e=this.key,t=encodeURIComponent(e)+"=",e=this.val;return t+encodeURIComponent(e)},toString:function(){return this.key+"="+this.val},__class__:bs};var tt=function(){this.params=[]};tt.__name__=!0,tt.prototype={LS_reqId:function(t){this.addParamAny("LS_reqId",t)},LS_message:function(t){this.addParamString("LS_message",t)},LS_sequence:function(t){this.addParamString("LS_sequence",t)},LS_msg_prog:function(t){this.addParamAny("LS_msg_prog",t)},LS_max_wait:function(t){this.addParamAny("LS_max_wait",t)},LS_outcome:function(t){this.addParamBool("LS_outcome",t)},LS_ack:function(t){this.addParamBool("LS_ack",t)},LS_op:function(t){this.addParamString("LS_op",t)},LS_subId:function(t){this.addParamAny("LS_subId",t)},LS_mode:function(t){this.addParamString("LS_mode",t)},LS_group:function(t){this.addParamString("LS_group",t)},LS_schema:function(t){this.addParamString("LS_schema",t)},LS_data_adapter:function(t){this.addParamString("LS_data_adapter",t)},LS_requested_max_frequency:function(t){this.addParamString("LS_requested_max_frequency",t)},LS_requested_max_frequency_Float:function(t){this.addParamAny("LS_requested_max_frequency",t)},LS_requested_buffer_size:function(t){this.addParamString("LS_requested_buffer_size",t)},LS_requested_buffer_size_Int:function(t){this.addParamAny("LS_requested_buffer_size",t)},LS_cause:function(t){this.addParamString("LS_cause",t)},LS_keepalive_millis:function(t){this.addParamAny("LS_keepalive_millis",t)},LS_inactivity_millis:function(t){this.addParamAny("LS_inactivity_millis",t)},LS_requested_max_bandwidth:function(t){this.addParamString("LS_requested_max_bandwidth",t)},LS_requested_max_bandwidth_Float:function(t){this.addParamAny("LS_requested_max_bandwidth",t)},LS_adapter_set:function(t){this.addParamString("LS_adapter_set",t)},LS_user:function(t){this.addParamString("LS_user",t)},LS_password:function(t){this.addParamString("LS_password",t)},LS_cid:function(t){this.addParamString("LS_cid",t)},LS_old_session:function(t){this.addParamString("LS_old_session",t)},LS_session:function(t){this.addParamString("LS_session",t)},LS_send_sync:function(t){this.addParamBool("LS_send_sync",t)},LS_polling:function(t){this.addParamBool("LS_polling",t)},LS_polling_millis:function(t){this.addParamAny("LS_polling_millis",t)},LS_idle_millis:function(t){this.addParamAny("LS_idle_millis",t)},LS_content_length:function(t){this.addParamAny("LS_content_length",t)},LS_ttl_millis:function(t){this.addParamString("LS_ttl_millis",t)},LS_recovery_from:function(t){this.addParamAny("LS_recovery_from",t)},LS_close_socket:function(t){this.addParamBool("LS_close_socket",t)},LS_selector:function(t){this.addParamString("LS_selector",t)},LS_snapshot:function(t){this.addParamBool("LS_snapshot",t)},LS_snapshot_Int:function(t){this.addParamAny("LS_snapshot",t)},addParamString:function(t,e){this.params.push(new bs(t,e))},addParamAny:function(t,e){this.addParamString(t,""+(e==null?"null":c.string(e)))},addParamBool:function(t,e){this.addParamString(t,e?"true":"false")},getEncodedString:function(){for(var t=this.params,e=new Array(t.length),s=0,i=t.length;s<i;){var n=s++;e[n]=t[n].toEncodedPair()}return e.join("&")},toString:function(){return this.params.join(" ")},__class__:tt};var Q=function(t){if(this.values=[],t!=null)for(;t.hasNext();)this.insert(t.next())};Q.__name__=!0,Q.prototype={count:function(){return this.values.length},insert:function(t){this.values.indexOf(t)==-1&&this.values.push(t)},contains:function(t){return this.values.indexOf(t)!=-1},remove:function(t){L.remove(this.values,t)},removeAll:function(){this.values.splice(0,this.values.length)},copy:function(){return new Q(this.iterator())},union:function(t){for(var e=new Q,i=0,s=this.values;i<s.length;)e.insert(s[i++]);for(var i=0;i<t.length;)e.insert(t[i++]);return e},subtracting:function(t){for(var e=new Q,s=0,i=this.values;s<i.length;){var n=i[s];++s,t.indexOf(n)==-1&&e.insert(n)}return e},iterator:function(){return new Re(this.values)},toArray:function(){return this.values},__class__:Q};var Es=function(){this.progress=0};Es.__name__=!0,Es.prototype={extractNewData:function(t,e){var s;if(e)s=t.length;else{if(s=t.lastIndexOf(`\r
`),s<0)return[];s+=2}if(s<=this.progress)return[];var i=t.substring(this.progress,s);return this.progress=s,i.split(`\r
`)},streamProgress:function(t){return this.extractNewData(t,!1)},streamComplete:function(t){return this.extractNewData(t,!0)},__class__:Es};var rs={};rs._new=function(t){return t},rs.toMillis=function(t){return t},rs.toLong=function(t){return t};var It={};It._new=function(t){return t},It.now=function(){return L.now()/1e3},It.plus=function(t,e){return t*1e3+e},It.minus=function(t,e){return(t-e)*1e3},It.toFloat=function(t){return t};var as=function(t,e,s){var i=this;this.task=new je(Vs(function(){s(i)},e))};as.__name__=!0,as.__interfaces__=[Ze],as.prototype={cancel:function(){this.task.cancel()},isCanceled:function(){return this.task.handle==null},__class__:as};var Xs=Xi;function bi(){var t=ii.shift();if(t==null){C.isErrorEnabled()&&C.error("Timer callback not found");return}try{t()}catch(s){var e=g.caught(s);C.isErrorEnabled()&&C.error(`Timer callback failed
`+e.details())}}var vt=p["com.lightstreamer.internal.FieldValue"]={__ename__:!0,__constructs__:null,unchanged:{_hx_name:"unchanged",_hx_index:0,__enum__:"com.lightstreamer.internal.FieldValue",toString:h},changed:(u=function(t){return{_hx_index:1,val:t,__enum__:"com.lightstreamer.internal.FieldValue",toString:h}},u._hx_name="changed",u.__params__=["val"],u),jsonPatch:(u=function(t){return{_hx_index:2,patch:t,__enum__:"com.lightstreamer.internal.FieldValue",toString:h}},u._hx_name="jsonPatch",u.__params__=["patch"],u),diffPatch:(u=function(t){return{_hx_index:3,patch:t,__enum__:"com.lightstreamer.internal.FieldValue",toString:h}},u._hx_name="diffPatch",u.__params__=["patch"],u)};vt.__constructs__=[vt.unchanged,vt.changed,vt.jsonPatch,vt.diffPatch];var U={};U._new=function(t){return t},U.fromIntGt0=function(t){if(t<=0)throw new y("value must be greater than zero");return t},U.fromIntGtEq0=function(t){if(t<0)throw new y("value must be greater than or equal to zero");return t},U.gti=function(t,e){return t>e},U.gt=function(t,e){return t>e},U.lt=function(t,e){return t<e},U.plus=function(t,e){return t+e},U.minus=function(t,e){return t-e},U.toInt=function(t){return t};var Bs={};Bs._new=function(t){return t},Bs.fromIntGt0=function(t){if(t<=0)throw new y("value must be greater than zero");return t};var $t={};$t.fromString=function(t){if(t==null)return null;switch(t){case"HTTP":return"HTTP";case"HTTP-POLLING":return"HTTP-POLLING";case"HTTP-STREAMING":return"HTTP-STREAMING";case"WS":return"WS";case"WS-POLLING":return"WS-POLLING";case"WS-STREAMING":return"WS-STREAMING";default:throw new y("The given value is not valid. Use one of: HTTP-STREAMING, HTTP-POLLING, WS-STREAMING, WS-POLLING, WS, HTTP or null")}};var ge=p["com.lightstreamer.internal.RequestedMaxBandwidth"]={__ename__:!0,__constructs__:null,BWLimited:(u=function(t){return{_hx_index:0,bw:t,__enum__:"com.lightstreamer.internal.RequestedMaxBandwidth",toString:h}},u._hx_name="BWLimited",u.__params__=["bw"],u),BWUnlimited:{_hx_name:"BWUnlimited",_hx_index:1,__enum__:"com.lightstreamer.internal.RequestedMaxBandwidth",toString:h}};ge.__constructs__=[ge.BWLimited,ge.BWUnlimited];var Se=function(){};Se.__name__=!0,Se.fromString=function(t){var e;if(t.toLowerCase()=="unlimited")return ge.BWUnlimited;if(e=parseFloat(t),!isNaN(e)&&e>0)return ge.BWLimited(e);throw new y('The given value is a not valid value for RequestedMaxBandwidth. Use a positive number or the string "unlimited"')},Se.toString=function(t){switch(t._hx_index){case 0:var e=t.bw;return e==null?"null":""+e;case 1:return"unlimited"}};var os=p["com.lightstreamer.internal.RequestedBufferSize"]={__ename__:!0,__constructs__:null,BSLimited:(u=function(t){return{_hx_index:0,size:t,__enum__:"com.lightstreamer.internal.RequestedBufferSize",toString:h}},u._hx_name="BSLimited",u.__params__=["size"],u),BSUnlimited:{_hx_name:"BSUnlimited",_hx_index:1,__enum__:"com.lightstreamer.internal.RequestedBufferSize",toString:h}};os.__constructs__=[os.BSLimited,os.BSUnlimited];var ye=function(){};ye.__name__=!0,ye.fromString=function(t){if(t==null)return null;var e;if(t.toLowerCase()=="unlimited")return os.BSUnlimited;if(e=c.parseInt(t),e!=null&&e>0)return os.BSLimited(e);throw new y("The given value is not valid for this setting; use null, 'unlimited' or a positive integer instead")},ye.toString=function(t){if(t==null)return null;switch(t._hx_index){case 0:var e=t.size;return e==null?"null":""+e;case 1:return"unlimited"}},ye.extEquals=function(t,e){return t==null?e==null:e==null?!1:_.enumEq(t,e)};var Ct=p["com.lightstreamer.internal.RequestedSnapshot"]={__ename__:!0,__constructs__:null,SnpYes:{_hx_name:"SnpYes",_hx_index:0,__enum__:"com.lightstreamer.internal.RequestedSnapshot",toString:h},SnpNo:{_hx_name:"SnpNo",_hx_index:1,__enum__:"com.lightstreamer.internal.RequestedSnapshot",toString:h},SnpLength:(u=function(t){return{_hx_index:2,len:t,__enum__:"com.lightstreamer.internal.RequestedSnapshot",toString:h}},u._hx_name="SnpLength",u.__params__=["len"],u)};Ct.__constructs__=[Ct.SnpYes,Ct.SnpNo,Ct.SnpLength];var we=function(){};we.__name__=!0,we.fromString=function(t){if(t==null)return null;var e;switch(t.toLowerCase()){case"no":return Ct.SnpNo;case"yes":return Ct.SnpYes;default:if(e=c.parseInt(t),e!=null&&e>0)return Ct.SnpLength(e);throw new y("The given value is not valid for this setting; use null, 'yes', 'no' or a positive number instead")}},we.toString=function(t){if(t==null)return null;switch(t._hx_index){case 0:return"yes";case 1:return"no";case 2:var e=t.len;return e==null?"null":""+e}};var Wt=p["com.lightstreamer.internal.RequestedMaxFrequency"]={__ename__:!0,__constructs__:null,FreqLimited:(u=function(t){return{_hx_index:0,max:t,__enum__:"com.lightstreamer.internal.RequestedMaxFrequency",toString:h}},u._hx_name="FreqLimited",u.__params__=["max"],u),FreqUnlimited:{_hx_name:"FreqUnlimited",_hx_index:1,__enum__:"com.lightstreamer.internal.RequestedMaxFrequency",toString:h},FreqUnfiltered:{_hx_name:"FreqUnfiltered",_hx_index:2,__enum__:"com.lightstreamer.internal.RequestedMaxFrequency",toString:h}};Wt.__constructs__=[Wt.FreqLimited,Wt.FreqUnlimited,Wt.FreqUnfiltered];var Lt=function(){};Lt.__name__=!0,Lt.fromString=function(t){if(t==null)return null;var e;switch(t.toLowerCase()){case"unfiltered":return Wt.FreqUnfiltered;case"unlimited":return Wt.FreqUnlimited;default:if(e=parseFloat(t),!isNaN(e)&&e>0)return Wt.FreqLimited(e);throw new y("The given value is not valid for this setting; use null, 'unlimited', 'unfiltered' or a positive number instead")}},Lt.toString=function(t){if(t==null)return null;switch(t._hx_index){case 0:var e=t.max;return e==null?"null":""+e;case 1:return"unlimited";case 2:return"unfiltered"}},Lt.extEquals=function(t,e){return t==null?e==null:e==null?!1:_.enumEq(t,e)};var Dt=p["com.lightstreamer.internal.RealMaxFrequency"]={__ename__:!0,__constructs__:null,RFreqLimited:(u=function(t){return{_hx_index:0,freq:t,__enum__:"com.lightstreamer.internal.RealMaxFrequency",toString:h}},u._hx_name="RFreqLimited",u.__params__=["freq"],u),RFreqUnlimited:{_hx_name:"RFreqUnlimited",_hx_index:1,__enum__:"com.lightstreamer.internal.RealMaxFrequency",toString:h}};Dt.__constructs__=[Dt.RFreqLimited,Dt.RFreqUnlimited];var Zt=p["com.lightstreamer.internal.RealMaxBandwidth"]={__ename__:!0,__constructs__:null,BWLimited:(u=function(t){return{_hx_index:0,bw:t,__enum__:"com.lightstreamer.internal.RealMaxBandwidth",toString:h}},u._hx_name="BWLimited",u.__params__=["bw"],u),BWUnlimited:{_hx_name:"BWUnlimited",_hx_index:1,__enum__:"com.lightstreamer.internal.RealMaxBandwidth",toString:h},BWUnmanaged:{_hx_name:"BWUnmanaged",_hx_index:2,__enum__:"com.lightstreamer.internal.RealMaxBandwidth",toString:h}};Zt.__constructs__=[Zt.BWLimited,Zt.BWUnlimited,Zt.BWUnmanaged];var hs=function(){};hs.__name__=!0,hs.toString=function(t){if(t==null)return null;switch(t._hx_index){case 0:var e=t.bw;return e==null?"null":""+e;case 1:return"unlimited";case 2:return"unmanaged"}},hs.eq=function(t,e){return t==null?e==null:e==null?!1:_.enumEq(t,e)};var be={};be.fromString=function(t){switch(t){case"COMMAND":return"COMMAND";case"DISTINCT":return"DISTINCT";case"MERGE":return"MERGE";case"RAW":return"RAW";default:throw new y("The given value is not a valid subscription mode. Admitted values are MERGE, DISTINCT, RAW, COMMAND")}};var Ut={};Ut._new=function(t){return t},Ut.getPos=function(t,e){var s=t.indexOf(e);return s!=-1?s+1:-1},Ut.allValidNames=function(t){return!P.exists(t,function(e){return new at("^$| |^\\d+$","").match(e)})},Ut.fromArray=function(t){if(t==null)return null;if(t.length==0)throw new y("Item List is empty");if(Ut.allValidNames(t))return t;throw new y("Item List is invalid")};var Ht={};Ht._new=function(t){return t},Ht.getPos=function(t,e){var s=t.indexOf(e);return s!=-1?s+1:-1},Ht.hasKeyField=function(t){return t.indexOf("key")!=-1},Ht.hasCommandField=function(t){return t.indexOf("command")!=-1},Ht.fromArray=function(t){if(t==null)return null;if(t.length==0)throw new y("Field List is empty");if(P.exists(t,function(e){return new at("^$| ","").match(e)}))throw new y("Field List is invalid");return t};var Xt={};Xt._new=function(t){return t},Xt.fromString=function(t){if(t==null)return null;if(t=="")throw new y("The value is empty");return t};function Ei(t){if(t==null)return"null";switch(t._hx_index){case 0:return""+t.freq;case 1:return"unlimited"}}function ti(t,e){return t==null?e==null:e==null?!1:_.enumEq(t,e)}var st=function(t,e){var s=t.indexOf("://");s!=-1?(this._protocol=t.substring(0,s)+":",t=t.substring(s+3)):this._protocol="";var i=t.indexOf("/");i!=-1?(this._pathname=t.substring(i),t=t.substring(0,i)):this._pathname="/";var n=this.extractPortStart(t);n!=-1?(this._port=t.substring(n),this._hostname=t.substring(0,n-1)):(this._port="",this._hostname=t),e!=null&&this.set_pathname(e)};st.__name__=!0,st.build=function(t,e){if(e!=null){var s=b.endsWith(t,"/"),i=b.startsWith(e,"/");s?i?t+=e.substring(1):t+=e:i?t+=e:t+="/"+e}return t},st.completeControlLink=function(t,e){var s=new st(e),i=new st(t);return i.get_protocol()==""&&i.set_protocol(s.get_protocol()),i.get_port()==""&&i.set_port(s.get_port()),i.get_href()},st.prototype={get_protocol:function(){return this._protocol},set_protocol:function(t){return t!=""&&!b.endsWith(t,":")&&(t+=":"),this._protocol=t,this._protocol},get_hostname:function(){return this._hostname},set_hostname:function(t){return this._hostname=t,this._hostname},get_port:function(){return this._port},set_port:function(t){return this._port=t,this._port},get_pathname:function(){return this._pathname},set_pathname:function(t){return b.startsWith(t,"/")||(t="/"+t),this._pathname=t,this._pathname},get_href:function(){var t=this._hostname;return this._protocol!=""&&(t=this._protocol+"//"+t),this._port!=""&&(t+=":"+this._port),this.get_pathname()!=""&&(t+=this._pathname),t},toString:function(){return this.get_href()},extractPortStart:function(t){var e=t.indexOf(":");return e<=-1?-1:t.indexOf("]")>-1?(e=t.indexOf("]:"),e<=-1?-1:e+2):e!=t.lastIndexOf(":")?-1:e+1},__class__:st};var ls=function(t,e,s,i){this.isCanceled=!1;var n=this;b.startsWith(t,"https://")?t=b.replace(t,"https://","wss://"):b.startsWith(t,"http://")&&(t=b.replace(t,"http://","ws://")),H.isDebugEnabled()&&H.debug("WS connecting: "+t),this.ws=new WebSocket(t,Oi),this.ws.onopen=function(){n.isCanceled||(H.isDebugEnabled()&&H.debug("WS event: open"),e(n))},this.ws.onmessage=function(r){if(!n.isCanceled)for(var o=0,l=r.data.split(`\r
`);o<l.length;){var v=l[o];if(++o,n.isCanceled)return;v!=""&&(H.isDebugEnabled()&&H.debug("WS event: text("+v+")"),s(n,v))}},this.ws.onerror=function(){n.isCanceled||(H.isDebugEnabled()&&H.debug("WS event: error(Network error)"),i(n,"Network error"),n.ws.close())},this.ws.onclose=function(r){if(!n.isCanceled){var o="unexpected disconnection: "+r.code+" - "+r.reason;H.isDebugEnabled()&&H.debug("WS event: error("+o+")"),i(n,o),n.ws.close()}}};ls.__name__=!0,ls.__interfaces__=[$e],ls.prototype={send:function(t){H.isDebugEnabled()&&H.debug("WS sending: "+t),this.ws.send(t)},dispose:function(){H.isDebugEnabled()&&H.debug("WS disposing"),this.isCanceled=!0,this.ws.close()},isDisposed:function(){return this.isCanceled},__class__:ls};var ie=function(t,e){this.buf=new K,this.basePos=0,this.diffPos=0,this.diff=e,this.base=t};ie.__name__=!0,ie.apply=function(t,e){return new ie(t,e).decode()},ie.prototype={decode:function(){try{for(;this.diffPos!=this.diff.length&&(this.applyCopy(),!(this.diffPos==this.diff.length||(this.applyAdd(),this.diffPos==this.diff.length)));)this.applyDel();return this.buf.b}catch(t){throw new g("Bad TLCP-diff",g.caught(t))}},applyCopy:function(){var t=this.decodeVarint();t>0&&(this.appendToBuf(this.base,this.basePos,t),this.basePos+=t)},applyAdd:function(){var t=this.decodeVarint();t>0&&(this.appendToBuf(this.diff,this.diffPos,t),this.diffPos+=t)},applyDel:function(){var t=this.decodeVarint();t>0&&(this.basePos+=t)},decodeVarint:function(){for(var t=0;;){var e=this.charAt(this.diff,this.diffPos);if(this.diffPos+=1,e>=97&&e<123)return t*26+(e-97);if(e>=65&&e<91)t=t*26+(e-65);else throw new g("The code point "+e+" is not in the range A-Z")}},appendToBuf:function(t,e,s){if(e+s<=t.length)this.buf.b+=s==null?L.substr(t,e,null):L.substr(t,e,s);else throw new g("Index out of range: startIndex="+e+" count="+s+" length="+t.length)},charAt:function(t,e){if(e<t.length)return L.cca(t.charAt(e),0);throw new g("Index out of range: pos="+e+" length="+t.length)},__class__:ie};var Kt={};Kt._new=function(t){return JSON.parse(t)},Kt.apply=function(t,e){return Ti.apply_patch(t,e)},Kt.toString=function(t){return JSON.stringify(t)};var Ti=tn(),lt=Gt.LSConsoleLogLevel=function(){};lt.__name__=!0,lt.prototype={__class__:lt};var Ts=Gt.LSConsoleLoggerProvider=function(t){this.level=t};Ts.__name__=!0,Ts.__interfaces__=[ci],Ts.prototype={getLogger:function(t){return new us(this.level,t)},__class__:Ts};var us=function(t,e){this.level=t,this.category=e,this.traceEnabled=t<=lt.TRACE,this.debugEnabled=t<=lt.DEBUG,this.infoEnabled=t<=lt.INFO,this.warnEnabled=t<=lt.WARN,this.errorEnabled=t<=lt.ERROR,this.fatalEnabled=t<=lt.FATAL};us.__name__=!0,us.__super__=Tt,us.prototype=T(Tt.prototype,{printLog:function(t){a.console.log(t)},format:function(t,e){var s=L.dateStr(new Date);return""+s+"|"+t+"|"+this.category+"|"+e},logFatal:function(t){a.console.log(t)},logError:function(t){a.console.log(t)},logWarn:function(t){a.console.log(t)},logInfo:function(t){a.console.log(t)},logDebug:function(t){a.console.log(t)},logTrace:function(t){a.console.log(t)},fatal:function(t,e){if(this.fatalEnabled){var s=this.format("FATAL",t);if(a.console.log(s),e!=null){var s=g.caught(e).details();a.console.log(s)}}},error:function(t,e){if(this.errorEnabled){var s=this.format("ERROR",t);if(a.console.log(s),e!=null){var s=g.caught(e).details();a.console.log(s)}}},warn:function(t,e){if(this.warnEnabled){var s=this.format("WARN ",t);if(a.console.log(s),e!=null){var s=g.caught(e).details();a.console.log(s)}}},info:function(t,e){if(this.infoEnabled){var s=this.format("INFO ",t);if(a.console.log(s),e!=null){var s=g.caught(e).details();a.console.log(s)}}},debug:function(t,e){if(this.debugEnabled){var s=this.format("DEBUG",t);if(a.console.log(s),e!=null){var s=g.caught(e).details();a.console.log(s)}}},trace:function(t,e){if(this.traceEnabled){var s=this.format("TRACE",t);if(a.console.log(s),e!=null){var s=g.caught(e).details();a.console.log(s)}}},isFatalEnabled:function(){return this.fatalEnabled},isErrorEnabled:function(){return this.errorEnabled},isWarnEnabled:function(){return this.warnEnabled},isInfoEnabled:function(){return this.infoEnabled},isDebugEnabled:function(){return this.debugEnabled},isTraceEnabled:function(){return this.traceEnabled},__class__:us});var Nt=p["haxe.StackItem"]={__ename__:!0,__constructs__:null,CFunction:{_hx_name:"CFunction",_hx_index:0,__enum__:"haxe.StackItem",toString:h},Module:(u=function(t){return{_hx_index:1,m:t,__enum__:"haxe.StackItem",toString:h}},u._hx_name="Module",u.__params__=["m"],u),FilePos:(u=function(t,e,s,i){return{_hx_index:2,s:t,file:e,line:s,column:i,__enum__:"haxe.StackItem",toString:h}},u._hx_name="FilePos",u.__params__=["s","file","line","column"],u),Method:(u=function(t,e){return{_hx_index:3,classname:t,method:e,__enum__:"haxe.StackItem",toString:h}},u._hx_name="Method",u.__params__=["classname","method"],u),LocalFunction:(u=function(t){return{_hx_index:4,v:t,__enum__:"haxe.StackItem",toString:h}},u._hx_name="LocalFunction",u.__params__=["v"],u)};Nt.__constructs__=[Nt.CFunction,Nt.Module,Nt.FilePos,Nt.Method,Nt.LocalFunction];var pt={};pt.toString=function(t){for(var e=new K,s=0,i=t;s<i.length;){var n=i[s++];e.b+=`
Called from `,pt.itemToString(e,n)}return e.b},pt.subtract=function(t,e){for(var s=-1,i=-1;++i<t.length;){for(var n=0,r=e.length;n<r;)if(pt.equalItems(t[i],e[n++])){if(s<0&&(s=i),++i,i>=t.length)break}else s=-1;if(s>=0)break}return s>=0?t.slice(0,s):t},pt.equalItems=function(t,e){if(t==null)return e==null;switch(t._hx_index){case 0:return e==null?!1:e._hx_index==0;case 1:return e==null?!1:e._hx_index==1?t.m==e.m:!1;case 2:return e==null?!1:e._hx_index==2&&t.file==e.file&&t.line==e.line&&t.column==e.column?pt.equalItems(t.s,e.s):!1;case 3:return e==null?!1:e._hx_index==3&&t.classname==e.classname?t.method==e.method:!1;case 4:return e==null?!1:e._hx_index==4?t.v==e.v:!1}},pt.itemToString=function(t,e){switch(e._hx_index){case 0:t.b+="a C function";break;case 1:var r=e.m;t.b=(t.b+="module ")+(r==null?"null":""+r);break;case 2:var r=e.s,n=e.file,s=e.line,i=e.column;r!=null&&(pt.itemToString(t,r),t.b+=" ("),t.b=(t.b+=n==null?"null":""+n)+" line ",t.b+=s==null?"null":""+s,i!=null&&(t.b=(t.b+=" column ")+(i==null?"null":""+i)),r!=null&&(t.b+=")");break;case 3:var r=e.classname,n=e.method;t.b=(t.b+=c.string(r??"<unknown>"))+".",t.b+=n==null?"null":""+n;break;case 4:var r=e.v;t.b=(t.b+="local function #")+(r==null?"null":""+r);break}};var ne=function(){};ne.__name__=!0,ne.toHaxe=function(t,e){if(e==null&&(e=0),t==null)return[];if(typeof t=="string"){var s=t.split(`
`);s[0]=="Error"&&s.shift();for(var i=[],n=0,r=s.length;n<r;){var o=n++;if(!(e>o)){var l=s[o],v=l.match(/^    at ([$A-Za-z0-9_. ]+) \(([^)]+):([0-9]+):([0-9]+)\)$/);if(v!=null){var D=v[1].split(".");D[0]=="$hxClasses"&&D.shift();var N=D.pop(),F=v[2],rt=c.parseInt(v[3]),V=c.parseInt(v[4]);i.push(Nt.FilePos(N=="Anonymous function"?Nt.LocalFunction():N=="Global code"?null:Nt.Method(D.join("."),N),F,rt,V))}else i.push(Nt.Module(b.trim(l)))}}return i}else return e>0&&Array.isArray(t)?t.slice(e):t},ne.normalize=function(t,e){if(e==null&&(e=0),Array.isArray(t)&&e>0)return t.slice(e);if(typeof t=="string"){switch(t.substring(0,6)){case`Error
`:case"Error:":++e;break}return ne.skipLines(t,e)}else return t},ne.skipLines=function(t,e,s){for(s==null&&(s=0);;)if(e>0){if(s=t.indexOf(`
`,s),s<0)return"";e=--e,s+=1;continue}else return t.substring(s)};var Ee=function(t,e,s){g.call(this,String(t),e,s),this.value=t,this.__skipStack++};Ee.__name__=!0,Ee.__super__=g,Ee.prototype=T(g.prototype,{__class__:Ee});var q=function(){this.h={}};q.__name__=!0,q.__interfaces__=[se],q.prototype={get:function(t){return this.h[t]},remove:function(t){return this.h.hasOwnProperty(t)?(delete this.h[t],!0):!1},keys:function(){var t=[];for(var e in this.h)this.h.hasOwnProperty(e)&&t.push(+e);return new Re(t)},iterator:function(){return{ref:this.h,it:this.keys(),hasNext:function(){return this.it.hasNext()},next:function(){var t=this.it.next();return this.ref[t]}}},copy:function(){for(var t=new q,e=this.keys();e.hasNext();){var s=e.next();t.h[s]=this.h[s]}return t},__class__:q};var J=function(){this.h=Object.create(null)};J.__name__=!0,J.__interfaces__=[se],J.createCopy=function(t){var e=new J;for(var s in t)e.h[s]=t[s];return e},J.stringify=function(t){var e="[",s=!0;for(var i in t)s?s=!1:e+=",",e+=i+" => "+c.string(t[i]);return e+"]"},J.prototype={get:function(t){return this.h[t]},keys:function(){return new Rs(this.h)},iterator:function(){return new xs(this.h)},__class__:J};var Rs=function(t){this.h=t,this.keys=Object.keys(t),this.length=this.keys.length,this.current=0};Rs.__name__=!0,Rs.prototype={hasNext:function(){return this.current<this.length},next:function(){return this.keys[this.current++]},__class__:Rs};var xs=function(t){this.h=t,this.keys=Object.keys(t),this.length=this.keys.length,this.current=0};xs.__name__=!0,xs.prototype={hasNext:function(){return this.current<this.length},next:function(){return this.h[this.keys[this.current++]]},__class__:xs};var Te=p["haxe.io.Error"]={__ename__:!0,__constructs__:null,Blocked:{_hx_name:"Blocked",_hx_index:0,__enum__:"haxe.io.Error",toString:h},Overflow:{_hx_name:"Overflow",_hx_index:1,__enum__:"haxe.io.Error",toString:h},OutsideBounds:{_hx_name:"OutsideBounds",_hx_index:2,__enum__:"haxe.io.Error",toString:h},Custom:(u=function(t){return{_hx_index:3,e:t,__enum__:"haxe.io.Error",toString:h}},u._hx_name="Custom",u.__params__=["e"],u)};Te.__constructs__=[Te.Blocked,Te.Overflow,Te.OutsideBounds,Te.Custom];var Re=function(t){this.current=0,this.array=t};Re.__name__=!0,Re.prototype={hasNext:function(){return this.current<this.array.length},next:function(){return this.array[this.current++]},__class__:Re};var Is=function(t){this.map=t,this.keys=t.keys()};Is.__name__=!0,Is.prototype={hasNext:function(){return this.keys.hasNext()},next:function(){var t=this.keys.next();return{value:this.map.get(t),key:t}},__class__:Is};var Cs=function(t,e,s){g.call(this,t,s),this.pos=e,this.__skipStack++};Cs.__name__=!0,Cs.__super__=g,Cs.prototype=T(g.prototype,{__class__:Cs});var Ws=function(){};Ws.__name__=!0,Ws.sliceImpl=function(t,e){var s=new Uint8Array(this,t,e==null?null:e-t),i=new Uint8Array(s.byteLength);return i.set(s),i.buffer};function xe(t){return t instanceof Array?new Re(t):t.iterator()}function $(t,e){if(e==null)return null;e.__id__==null&&(e.__id__=a.$haxeUID++);var s;return t.hx__closures__==null?t.hx__closures__={}:s=t.hx__closures__[e.__id__],s==null&&(s=e.bind(t),t.hx__closures__[e.__id__]=s),s}a.$haxeUID|=0,typeof performance<"u"&&typeof performance.now=="function"&&(L.now=performance.now.bind(performance)),Object.defineProperty(String.prototype,"__class__",{value:String,enumerable:!1,writable:!0}),String.__name__=!0,Array.__name__=!0,Date.prototype.__class__=Date,Date.__name__="Date";var Ri={},xi={},Ii=Number,Ci=Boolean,Li={},Di={};B.__toStr={}.toString,ArrayBuffer.prototype.slice==null&&(ArrayBuffer.prototype.slice=Ws.sliceImpl);var Ni=(function(t){var e,s;if(E.get_supported()){var i=a.location;if((i!=null?i.protocol:null)!="http:"){var i=a.location;s=(i!=null?i.protocol:null)!="https:"}else s=!1}else s=!0;return e=s?null:O.fromString(a.location.protocol+"//"+a.location.hostname+(a.location.port!=""?":"+a.location.port:"")+"/"),e})(),re="TLCP-2.5.0",Oi=re+".lightstreamer.com",Mi="9.2.3 build 20250225",Us="pcYgxn8m8 feOojyA1V681i3g2.pz482hB5DM9o",Pi="javascript_client",ei="";zt.LIB_NAME=Pi,zt.LIB_VERSION=Mi,A.lock=new ae,A.logInstances=new J,A.emptyLogger=new Ne;var H=A.getLogger("lightstreamer.stream"),m=A.getLogger("lightstreamer.protocol"),C=A.getLogger("lightstreamer.internal"),x=A.getLogger("lightstreamer.session"),w=A.getLogger("lightstreamer.actions"),Ls=A.getLogger("lightstreamer.reachability"),G=A.getLogger("lightstreamer.subscriptions"),nt=A.getLogger("lightstreamer.messages");A.getLogger("lightstreamer.cookies");var Ds=A.getLogger("lightstreamer.page");oe.frz_globalPageLifecycle=Yt.newLoggingInstance();var ki=new TextDecoder;it.EOL_LEN=it.lengthOfBytes(`\r
`);var Hs="The Subscription was initiated using a Field Schema: the field names are not available",si="The field position is out of bounds",Ks="The field name is unknown";Ft.instance=new Ft;var Vs=Ft.instance.hasWorkers?Xs.setTimeout:a.setTimeout,Fi=Ft.instance.hasWorkers?Xs.clearTimeout:a.clearTimeout,Ot=Ft.instance.hasMicroTasks?a.queueMicrotask:function(t){ii.push(t),Vs(bi,0)},ii=[];U.ZERO=0,$t.WS="WS",$t.WS_STREAMING="WS-STREAMING",$t.WS_POLLING="WS-POLLING",$t.HTTP="HTTP",$t.HTTP_STREAMING="HTTP-STREAMING",$t.HTTP_POLLING="HTTP-POLLING",be.Merge="MERGE",be.Distinct="DISTINCT",be.Command="COMMAND",be.Raw="RAW",ie.VARINT_RADIX=26,lt.TRACE=0,lt.DEBUG=10,lt.INFO=20,lt.WARN=30,lt.ERROR=40,lt.FATAL=50})(typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:void 0);var Ms=Gt.LSLightstreamerClient,en=Gt.LSSubscription,Ce=Gt.LSConsoleLogLevel,di=function(a){this.delegate=a};di.prototype={setContentLength:function(a){this.delegate.setContentLength(a)},getContentLength:function(){return this.delegate.getContentLength()},setIdleTimeout:function(a){this.delegate.setIdleTimeout(a)},getIdleTimeout:function(){return this.delegate.getIdleTimeout()},setKeepaliveInterval:function(a){this.delegate.setKeepaliveInterval(a)},getKeepaliveInterval:function(){return this.delegate.getKeepaliveInterval()},setRequestedMaxBandwidth:function(a){this.delegate.setRequestedMaxBandwidth(a)},getRequestedMaxBandwidth:function(){return this.delegate.getRequestedMaxBandwidth()},getRealMaxBandwidth:function(){return this.delegate.getRealMaxBandwidth()},setPollingInterval:function(a){this.delegate.setPollingInterval(a)},getPollingInterval:function(){return this.delegate.getPollingInterval()},setReconnectTimeout:function(a){this.delegate.setReconnectTimeout(a)},getReconnectTimeout:function(){return this.delegate.getReconnectTimeout()},setStalledTimeout:function(a){this.delegate.setStalledTimeout(a)},getStalledTimeout:function(){return this.delegate.getStalledTimeout()},setRetryDelay:function(a){this.delegate.setRetryDelay(a)},getRetryDelay:function(){return this.delegate.getRetryDelay()},setFirstRetryMaxDelay:function(a){this.delegate.setFirstRetryMaxDelay(a)},getFirstRetryMaxDelay:function(){return this.delegate.getFirstRetryMaxDelay()},setSlowingEnabled:function(a){this.delegate.setSlowingEnabled(a)},isSlowingEnabled:function(){return this.delegate.isSlowingEnabled()},setForcedTransport:function(a){this.delegate.setForcedTransport(a)},getForcedTransport:function(){return this.delegate.getForcedTransport()},setServerInstanceAddressIgnored:function(a){this.delegate.setServerInstanceAddressIgnored(a)},isServerInstanceAddressIgnored:function(){return this.delegate.isServerInstanceAddressIgnored()},setCookieHandlingRequired:function(a){this.delegate.setCookieHandlingRequired(a)},isCookieHandlingRequired:function(){return this.delegate.isCookieHandlingRequired()},setReverseHeartbeatInterval:function(a){this.delegate.setReverseHeartbeatInterval(a)},getReverseHeartbeatInterval:function(){return this.delegate.getReverseHeartbeatInterval()},setHttpExtraHeaders:function(a){this.delegate.setHttpExtraHeaders(a)},getHttpExtraHeaders:function(){return this.delegate.getHttpExtraHeaders()},setHttpExtraHeadersOnSessionCreationOnly:function(a){this.delegate.setHttpExtraHeadersOnSessionCreationOnly(a)},isHttpExtraHeadersOnSessionCreationOnly:function(){return this.delegate.isHttpExtraHeadersOnSessionCreationOnly()},setSessionRecoveryTimeout:function(a){this.delegate.setSessionRecoveryTimeout(a)},getSessionRecoveryTimeout:function(){return this.delegate.getSessionRecoveryTimeout()}};var mi=function(a){this.delegate=a};mi.prototype={setServerAddress:function(a){this.delegate.setServerAddress(a)},getServerAddress:function(){return this.delegate.getServerAddress()},setAdapterSet:function(a){this.delegate.setAdapterSet(a)},getAdapterSet:function(){return this.delegate.getAdapterSet()},setUser:function(a){this.delegate.setUser(a)},getUser:function(){return this.delegate.getUser()},setPassword:function(a){this.delegate.setPassword(a)},getServerInstanceAddress:function(){return this.delegate.getServerInstanceAddress()},getServerSocketName:function(){return this.delegate.getServerSocketName()},getSessionId:function(){return this.delegate.getSessionId()},getClientIp:function(){return this.delegate.getClientIp()}};var fs=function(a,h){this.delegate=new Ms(a,h),this.connectionOptions=new di(this.delegate.connectionOptions),this.connectionDetails=new mi(this.delegate.connectionDetails)};fs.setLoggerProvider=function(a){Ms.setLoggerProvider(a)};fs.LIB_NAME=Ms.LIB_NAME;fs.LIB_VERSION=Ms.LIB_VERSION;fs.prototype={connect:function(){this.delegate.connect()},disconnect:function(){this.delegate.disconnect()},getStatus:function(){return this.delegate.getStatus()},sendMessage:function(a,h,p,u,T){this.delegate.sendMessage(a,h,p,u,T)},getSubscriptions:function(){return this.delegate.getSubscriptionWrappers()},subscribe:function(a){this.delegate.subscribe(a.delegate)},unsubscribe:function(a){this.delegate.unsubscribe(a.delegate)},addListener:function(a){this.delegate.addListener(a)},removeListener:function(a){this.delegate.removeListener(a)},getListeners:function(){return this.delegate.getListeners()}};var Ys=function(a,h,p){this.delegate=new en(a,h,p,this)};Ys.prototype={isActive:function(){return this.delegate.isActive()},isSubscribed:function(){return this.delegate.isSubscribed()},setItems:function(a){this.delegate.setItems(a)},getItems:function(){return this.delegate.getItems()},setItemGroup:function(a){this.delegate.setItemGroup(a)},getItemGroup:function(){return this.delegate.getItemGroup()},setFields:function(a){this.delegate.setFields(a)},getFields:function(){return this.delegate.getFields()},setFieldSchema:function(a){this.delegate.setFieldSchema(a)},getFieldSchema:function(){return this.delegate.getFieldSchema()},getMode:function(){return this.delegate.getMode()},setDataAdapter:function(a){this.delegate.setDataAdapter(a)},getDataAdapter:function(){return this.delegate.getDataAdapter()},setSelector:function(a){this.delegate.setSelector(a)},getSelector:function(){return this.delegate.getSelector()},setRequestedMaxFrequency:function(a){this.delegate.setRequestedMaxFrequency(a)},getRequestedMaxFrequency:function(){return this.delegate.getRequestedMaxFrequency()},setRequestedBufferSize:function(a){this.delegate.setRequestedBufferSize(a)},getRequestedBufferSize:function(){return this.delegate.getRequestedBufferSize()},setRequestedSnapshot:function(a){this.delegate.setRequestedSnapshot(a)},getRequestedSnapshot:function(){return this.delegate.getRequestedSnapshot()},setCommandSecondLevelFields:function(a){this.delegate.setCommandSecondLevelFields(a)},getCommandSecondLevelFields:function(){return this.delegate.getCommandSecondLevelFields()},setCommandSecondLevelFieldSchema:function(a){this.delegate.setCommandSecondLevelFieldSchema(a)},getCommandSecondLevelFieldSchema:function(){return this.delegate.getCommandSecondLevelFieldSchema()},setCommandSecondLevelDataAdapter:function(a){this.delegate.setCommandSecondLevelDataAdapter(a)},getCommandSecondLevelDataAdapter:function(){return this.delegate.getCommandSecondLevelDataAdapter()},getValue:function(a,h){return this.delegate.getValue(a,h)},getCommandValue:function(a,h,p){return this.delegate.getCommandValue(a,h,p)},getKeyPosition:function(){return this.delegate.getKeyPosition()},getCommandPosition:function(){return this.delegate.getCommandPosition()},addListener:function(a){this.delegate.addListener(a)},removeListener:function(a){this.delegate.removeListener(a)},getListeners:function(){return this.delegate.getListeners()}};Ce.TRACE;Ce.DEBUG;Ce.INFO;Ce.WARN;Ce.ERROR;Ce.FATAL;const zs=document.getElementById("status"),sn=document.getElementById("liquid-urine"),nn=document.getElementById("percentage-urine"),rn=document.getElementById("liquid-waste"),an=document.getElementById("percentage-waste"),oi=document.getElementById("debug"),Mt=a=>{console.log(`[UPA] ${a}`),oi&&(oi.textContent=a)},Ps=new fs("https://push.lightstreamer.com","ISSLIVE"),js=new Ys("MERGE",["NODE3000005"],["Value","TimeStamp","Status.Class","CalibratedData"]);js.setRequestedSnapshot("yes");const Qs=new Ys("MERGE",["NODE3000008"],["Value","TimeStamp","Status.Class","CalibratedData"]);Qs.setRequestedSnapshot("yes");const vi=a=>{let h=null;try{h=a.getValue("Value")}catch{}if(h==null)try{h=a.getValue("CalibratedData")}catch{}if(h==null)try{h=a.getValue(1)}catch{}return h},pi=(a,h,p,u)=>{if(a==null)return;const T=a.toString().replace(/%/g,"").trim(),at=Number.parseFloat(T);if(Mt(`${u} raw=${a} parsed=${at}`),Number.isNaN(at))return;const L=Math.max(0,Math.min(100,at));h.style.height=`${L}%`,p.textContent=`${L.toFixed(1)}%`},on=a=>{Mt(`Status: ${a}`);const h=a.startsWith("CONNECTED");zs.textContent=h?"CONNECTED":"SEARCHING FOR SIGNAL",zs.classList.toggle("status-connected",h),zs.classList.toggle("status-searching",!h)};Ps.addListener({onStatusChange:a=>on(a),onServerError:(a,h)=>Mt(`Server error ${a}: ${h}`)});js.addListener({onItemUpdate:a=>{const h=vi(a);pi(h,sn,nn,"URINE")},onSubscription:()=>Mt("Urine subscription active"),onSubscriptionError:(a,h)=>Mt(`Urine sub error ${a}: ${h}`),onUnsubscription:()=>Mt("Urine unsubscribed")});Qs.addListener({onItemUpdate:a=>{const h=vi(a);pi(h,rn,an,"WASTE")},onSubscription:()=>Mt("Waste subscription active"),onSubscriptionError:(a,h)=>Mt(`Waste sub error ${a}: ${h}`),onUnsubscription:()=>Mt("Waste unsubscribed")});Ps.subscribe(js);Ps.subscribe(Qs);Ps.connect();Mt("Connecting...");
